# FreeBSD -- jail_attach(2) relies on the caller to change the cwd
# Problem Description:

When a process, such as jexec(8) or killall(1), calls jail_attach(2) to
enter a jail, the jailed root can attach to it using ptrace(2) before
the current working directory is changed.

# Impact:

A process with superuser privileges running inside a jail could change
the root directory outside of the jail, thereby gaining full read and
writing access to all files and directories in the system.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.2
    - **Fixed:** 12.2_4
    - **Introduced:** 11.4
    - **Fixed:** 11.4_8

## Details
 - **published**: 2021-02-25T00:00:00Z
 - **modified**: 2021-02-25T00:00:00Z
 - **discovery**: 2021-02-24T00:00:00Z
 - **vid**: [bba850fd-770e-11eb-b87a-901b0ef719ab](https://vuxml.freebsd.org/freebsd/bba850fd-770e-11eb-b87a-901b0ef719ab.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-25582](https://api.osv.dev/v1/vulns/CVE-2020-25582)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-21:05.jail_chdir.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-21:05.jail_chdir.asc)
