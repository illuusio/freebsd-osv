# OpenSSH -- OpenSSH 6.2 through 8.7 failed to correctly initialise supplemental groups when executing an AuthorizedKeysCommand or AuthorizedPrincipalsCommand
OpenBSD Project reports:

> sshd(8) from OpenSSH 6.2 through 8.7 failed to correctly initialise
> supplemental groups when executing an AuthorizedKeysCommand or
> AuthorizedPrincipalsCommand, where a AuthorizedKeysCommandUser or
> AuthorizedPrincipalsCommandUser directive has been set to run the
> command as a different user. Instead these commands would inherit the
> groups that sshd(8) was started with.
>
> Depending on system configuration, inherited groups may allow
> AuthorizedKeysCommand/AuthorizedPrincipalsCommand helper programs to
> gain unintended privilege.
>
> Neither AuthorizedKeysCommand nor AuthorizedPrincipalsCommand are
> enabled by default in sshd_config(5).


## Affected packages
 - **openssh-portable**
    - **Introduced:** 6.2.p1,1
    - **Fixed:** 8.7.p1_2,1
 - **openssh-portable-hpn**
    - **Introduced:** 6.2.p1,1
    - **Fixed:** 8.7.p1_2,1
 - **openssh-portable-gssapi**
    - **Introduced:** 6.2.p1,1
    - **Fixed:** 8.7.p1_2,1

## Details
 - **published**: 2021-10-12T00:00:00Z
 - **modified**: 2021-10-12T00:00:00Z
 - **discovery**: 2021-09-26T00:00:00Z
 - **vid**: [2a1b931f-2b86-11ec-8acd-c80aa9043978](https://vuxml.freebsd.org/freebsd/2a1b931f-2b86-11ec-8acd-c80aa9043978.html)

## References
 - REPORT: [https://www.openssh.com/txt/release-8.8](https://www.openssh.com/txt/release-8.8)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2021-41617](https://api.osv.dev/v1/vulns/CVE-2021-41617)
 - WEB: [https://www.openssh.com/txt/release-8.8](https://www.openssh.com/txt/release-8.8)
