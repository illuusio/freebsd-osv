# RabbitMQ-C -- integer overflow leads to heap corruption
alanxz reports:

> When parsing a frame header, validate that the frame_size is less than
> or equal to INT32_MAX. Given frame_max is limited between 0 and
> INT32_MAX in amqp_login and friends, this does not change the API.
> This prevents a potential buffer overflow when a malicious client
> sends a frame_size that is close to UINT32_MAX, in which causes an
> overflow when computing state-\>target_size resulting in a small value
> there. A buffer is then allocated with the small amount, then memcopy
> copies the frame_size writing to memory beyond the end of the buffer.


## Affected packages
 - **rabbitmq-c**
    - **Fixed:** 0.10.0
 - **rabbitmq-c-devel**
    - **Fixed:** 0.10.0

## Details
 - **published**: 2021-06-25T00:00:00Z
 - **modified**: 2021-06-25T00:00:00Z
 - **discovery**: 2019-10-29T00:00:00Z
 - **vid**: [7c555ce3-658d-4589-83dd-4b6a31c5d610](https://vuxml.freebsd.org/freebsd/7c555ce3-658d-4589-83dd-4b6a31c5d610.html)

## References
 - REPORT: [https://github.com/alanxz/rabbitmq-c/commit/fc85be7123050b91b054e45b91c78d3241a5047a](https://github.com/alanxz/rabbitmq-c/commit/fc85be7123050b91b054e45b91c78d3241a5047a)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2019-18609](https://api.osv.dev/v1/vulns/CVE-2019-18609)
 - ADVISORY: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18609](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18609)
