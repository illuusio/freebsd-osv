# FreeBSD -- Uninitialized kernel stack leaks in several file systems
# Problem Description:

Several file systems were not properly initializing the d_off field of
the dirent structures returned by VOP_READDIR. In particular, tmpfs(5),
smbfs(5), autofs(5) and mqueuefs(5) were failing to do so. As a result,
eight uninitialized kernel stack bytes may be leaked to userspace by
these file systems. This problem is not present in FreeBSD 11.

Additionally, msdosfs(5) was failing to zero-fill a pair of padding
fields in the dirent structure, resulting in a leak of three
uninitialized bytes.

# Impact:

Kernel stack disclosures may leak sensitive information which could be
used to compromise the security of the system.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.2
    - **Fixed:** 12.2_3
    - **Introduced:** 12.1
    - **Fixed:** 12.1_13
    - **Introduced:** 11.4
    - **Fixed:** 11.4_7

## Details
 - **published**: 2021-01-29T00:00:00Z
 - **modified**: 2021-01-29T00:00:00Z
 - **discovery**: 2021-01-29T00:00:00Z
 - **vid**: [a9c6e9be-61fb-11eb-b87a-901b0ef719ab](https://vuxml.freebsd.org/freebsd/a9c6e9be-61fb-11eb-b87a-901b0ef719ab.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-25578](https://api.osv.dev/v1/vulns/CVE-2020-25578)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-25579](https://api.osv.dev/v1/vulns/CVE-2020-25579)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-21:01.fsdisclosure.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-21:01.fsdisclosure.asc)
