# Grafana -- Snapshot authentication bypass
Grafana Labs reports:

> Unauthenticated and authenticated users are able to view the snapshot
> with the lowest database key by accessing the literal paths:
>
> - `/dashboard/snapshot/:key`, or
> - `/api/snapshots/:key`
>
> If the snapshot \"public_mode\" configuration setting is set to true
> (vs default of false), unauthenticated users are able to delete the
> snapshot with the lowest database key by accessing the literal path:
>
> - `/api/snapshots-delete/:deleteKey`
>
> Regardless of the snapshot \"public_mode\" setting, authenticated
> users are able to delete the snapshot with the lowest database key by
> accessing the literal paths:
>
> - `/api/snapshots/:key`, or
> - `/api/snapshots-delete/:deleteKey`
>
> The combination of deletion and viewing enables a complete walk
> through all snapshot data while resulting in complete snapshot data
> loss.


## Affected packages
 - **grafana8**
    - **Introduced:** 8.0.0
    - **Fixed:** 8.1.6
    - **Introduced:** 2.0.1
    - **Fixed:** 7.5.11
 - **grafana7**
    - **Introduced:** 8.0.0
    - **Fixed:** 8.1.6
    - **Introduced:** 2.0.1
    - **Fixed:** 7.5.11
 - **grafana6**
    - **Introduced:** 8.0.0
    - **Fixed:** 8.1.6
    - **Introduced:** 2.0.1
    - **Fixed:** 7.5.11
 - **grafana**
    - **Introduced:** 8.0.0
    - **Fixed:** 8.1.6
    - **Introduced:** 2.0.1
    - **Fixed:** 7.5.11

## Details
 - **published**: 2021-10-06T00:00:00Z
 - **modified**: 2021-10-06T00:00:00Z
 - **discovery**: 2021-09-15T00:00:00Z
 - **vid**: [757ee63b-269a-11ec-a616-6c3be5272acd](https://vuxml.freebsd.org/freebsd/757ee63b-269a-11ec-a616-6c3be5272acd.html)

## References
 - REPORT: [https://grafana.com/blog/2021/10/05/grafana-7.5.11-and-8.1.6-released-with-critical-security-fix/](https://grafana.com/blog/2021/10/05/grafana-7.5.11-and-8.1.6-released-with-critical-security-fix/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2021-39226](https://api.osv.dev/v1/vulns/CVE-2021-39226)
