# cyrus-imapd -- multiple-minute daemon hang via input that is mishandled during hash-table interaction
Cyrus IMAP 3.4.2 Release Notes states:

> Fixed CVE-2021-33582: Certain user inputs are used as hash table keys
> during processing. A poorly chosen string hashing algorithm meant that
> the user could control which bucket their data was stored in, allowing
> a malicious user to direct many inputs to a single bucket. Each
> subsequent insertion to the same bucket requires a strcmp of every
> other entry in it. At tens of thousands of entries, each new insertion
> could keep the CPU busy in a strcmp loop for minutes. The string
> hashing algorithm has been replaced with a better one, and now also
> uses a random seed per hash table, so malicious inputs cannot be
> precomputed.


## Affected packages
 - **cyrus-imapd34**
    - **Fixed:** 3.4.2
 - **cyrus-imapd32**
    - **Fixed:** 3.2.8
 - **cyrus-imapd30**
    - **Fixed:** 3.0.16
 - **cyrus-imapd25**
    - **Introduced:** 0,1
 - **cyrus-imapd24**
    - **Introduced:** 0,1
 - **cyrus-imapd23**
    - **Introduced:** 0,1

## Details
 - **published**: 2021-09-01T00:00:00Z
 - **modified**: 2021-09-01T00:00:00Z
 - **discovery**: 2021-05-26T00:00:00Z
 - **vid**: [3d915d96-0b1f-11ec-8d9f-080027415d17](https://vuxml.freebsd.org/freebsd/3d915d96-0b1f-11ec-8d9f-080027415d17.html)

## References
 - REPORT: [https://www.cyrusimap.org/imap/download/release-notes/3.4/x/3.4.2.html](https://www.cyrusimap.org/imap/download/release-notes/3.4/x/3.4.2.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2021-33582](https://api.osv.dev/v1/vulns/CVE-2021-33582)
 - ADVISORY: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33582](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33582)
