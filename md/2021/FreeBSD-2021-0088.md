# curl -- TLS 1.3 session ticket proxy host mixup
Daniel Stenberg reports:

> Enabled by default, libcurl supports the use of TLS 1.3 session
> tickets to resume previous TLS sessions to speed up subsequent TLS
> handshakes.
>
> When using a HTTPS proxy and TLS 1.3, libcurl can confuse session
> tickets arriving from the HTTPS proxy but work as if they arrived from
> the remote server and then wrongly \"short-cut\" the host handshake.
> The reason for this confusion is the modified sequence from TLS 1.2
> when the session ids would provided only during the TLS handshake,
> while in TLS 1.3 it happens post hand-shake and the code was not
> updated to take that changed behavior into account.
>
> When confusing the tickets, a HTTPS proxy can trick libcurl to use the
> wrong session ticket resume for the host and thereby circumvent the
> server TLS certificate check and make a MITM attack to be possible to
> perform unnoticed.
>
> This flaw can allow a malicious HTTPS proxy to MITM the traffic. Such
> a malicious HTTPS proxy needs to provide a certificate that curl will
> accept for the MITMed server for an attack to work - unless curl has
> been told to ignore the server certificate check.


## Affected packages
 - **curl**
    - **Introduced:** 7.63.0
    - **Fixed:** 7.76.0

## Details
 - **published**: 2021-04-10T00:00:00Z
 - **modified**: 2021-04-10T00:00:00Z
 - **discovery**: 2021-03-31T00:00:00Z
 - **vid**: [d10fc771-958f-11eb-9c34-080027f515ea](https://vuxml.freebsd.org/freebsd/d10fc771-958f-11eb-9c34-080027f515ea.html)

## References
 - REPORT: [https://curl.se/docs/CVE-2021-22890.html](https://curl.se/docs/CVE-2021-22890.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2021-22890](https://api.osv.dev/v1/vulns/CVE-2021-22890)
 - WEB: [https://curl.se/docs/CVE-2021-22890.html](https://curl.se/docs/CVE-2021-22890.html)
