# FreeBSD -- jail escape possible by mounting over jail root
# Problem Description:

Due to a race condition between lookup of \"..\" and remounting a
filesystem, a process running inside a jail might access filesystem
hierarchy outside of jail.

# Impact:

A process with superuser privileges running inside a jail configured
with the allow.mount permission (not enabled by default) could change
the root directory outside of the jail, and thus gain full read and
write access to all files and directories in the system.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.2
    - **Fixed:** 12.2_6
    - **Introduced:** 11.4
    - **Fixed:** 11.4_9

## Details
 - **published**: 2021-04-07T00:00:00Z
 - **modified**: 2021-04-07T00:00:00Z
 - **discovery**: 2021-04-06T00:00:00Z
 - **vid**: [a7b97d26-9792-11eb-b87a-901b0ef719ab](https://vuxml.freebsd.org/freebsd/a7b97d26-9792-11eb-b87a-901b0ef719ab.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2020-25584](https://cveawg.mitre.org/api/cve/CVE-2020-25584)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-21:10.jail_mount.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-21:10.jail_mount.asc)
