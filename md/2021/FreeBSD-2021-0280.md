# rubygem-cgi -- buffer overrun in CGI.escape_html
chamal reports:

> A security vulnerability that causes buffer overflow when you pass a
> very large string (\> 700 MB) to `CGI.escape_html` on a platform where
> `long` type takes 4 bytes, typically, Windows.


## Affected packages
 - **ruby**
    - **Introduced:** 2.7.0,1
    - **Fixed:** 2.7.5,1
    - **Introduced:** 3.0.0,1
    - **Fixed:** 3.0.3,1
 - **ruby27**
    - **Introduced:** 2.7.0,1
    - **Fixed:** 2.7.5,1
 - **ruby30**
    - **Introduced:** 3.0.0,1
    - **Fixed:** 3.0.3,1
 - **rubygem-cgi**
    - **Fixed:** 0.3.1

## Details
 - **published**: 2021-11-24T00:00:00Z
 - **modified**: 2021-11-24T00:00:00Z
 - **discovery**: 2021-11-24T00:00:00Z
 - **vid**: [2c6af5c3-4d36-11ec-a539-0800270512f4](https://vuxml.freebsd.org/freebsd/2c6af5c3-4d36-11ec-a539-0800270512f4.html)

## References
 - REPORT: [https://www.ruby-lang.org/en/news/2021/11/24/buffer-overrun-in-cgi-escape_html-cve-2021-41816/](https://www.ruby-lang.org/en/news/2021/11/24/buffer-overrun-in-cgi-escape_html-cve-2021-41816/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2021-41816](https://api.osv.dev/v1/vulns/CVE-2021-41816)
 - WEB: [https://www.ruby-lang.org/en/news/2021/11/24/buffer-overrun-in-cgi-escape_html-cve-2021-41816/](https://www.ruby-lang.org/en/news/2021/11/24/buffer-overrun-in-cgi-escape_html-cve-2021-41816/)
