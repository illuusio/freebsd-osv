# FreeBSD -- Xen grant mapping error handling issues
# Problem Description:

Grant mapping operations often occur in batch hypercalls, where a number
of operations are done in a single hypercall, the success or failure of
each one reported to the backend driver, and the backend driver then
loops over the results, performing follow-up actions based on the
success or failure of each operation.

Unfortunately, when running in HVM/PVH mode, the FreeBSD backend drivers
mishandle this: Some errors are ignored, effectively implying their
success from the success of related batch elements. In other cases,
errors resulting from one batch element lead to further batch elements
not being inspected, and hence successful ones to not be possible to
properly unmap upon error recovery.

# Impact:

A malicious or buggy frontend driver may be able to cause resource leaks
in the domain running the corresponding backend driver.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.2
    - **Fixed:** 12.2_4
    - **Introduced:** 11.4
    - **Fixed:** 11.4_8

## Details
 - **published**: 2021-02-25T00:00:00Z
 - **modified**: 2021-02-25T00:00:00Z
 - **discovery**: 2021-02-24T00:00:00Z
 - **vid**: [5b8c6e1e-770f-11eb-b87a-901b0ef719ab](https://vuxml.freebsd.org/freebsd/5b8c6e1e-770f-11eb-b87a-901b0ef719ab.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2021-26932](https://cveawg.mitre.org/api/cve/CVE-2021-26932)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-21:06.xen.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-21:06.xen.asc)
