# FreeBSD -- Missing message validation in libradius(3)
# Problem Description:

libradius did not perform sufficient validation of received messages.

rad_get_attr(3) did not verify that the attribute length is valid before
subtracting the length of the Type and Length fields. As a result, it
could return success while also providing a bogus length of SIZE_T_MAX -
2 for the Value field.

When processing attributes to find an optional authenticator,
is_valid_response() failed to verify that each attribute length is
non-zero and could thus enter an infinite loop.

# Impact:

A server may use libradius(3) to process messages from RADIUS clients.
In this case, a malicious client could trigger a denial-of-service in
the server. A client using libradius(3) to process messages from a
server is susceptible to the same problem.

The impact of the rad_get_attr(3) bug depends on how the returned length
is validated and used by the consumer. It is possible that libradius(3)
applications will crash or enter an infinite loop when calling
rad_get_attr(3) on untrusted RADIUS messages.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 13.0
    - **Fixed:** 13.0_1
    - **Introduced:** 12.2
    - **Fixed:** 12.2_7
    - **Introduced:** 11.4
    - **Fixed:** 11.4_10

## Details
 - **published**: 2021-05-27T00:00:00Z
 - **modified**: 2021-05-27T00:00:00Z
 - **discovery**: 2021-05-27T00:00:00Z
 - **vid**: [107c7a76-beaa-11eb-b87a-901b0ef719ab](https://vuxml.freebsd.org/freebsd/107c7a76-beaa-11eb-b87a-901b0ef719ab.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2021-29629](https://cveawg.mitre.org/api/cve/CVE-2021-29629)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-21:12.libradius.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-21:12.libradius.asc)
