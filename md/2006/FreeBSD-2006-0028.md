# sudo -- arbitrary command execution
Tavis Ormandy reports:

> The bash shell uses the value of the PS4 environment variable (after
> expansion) as a prefix for commands run in execution trace mode.
> Execution trace mode (xtrace) is normally set via bash\'s -x command
> line option or interactively by running \"set -o xtrace\". However, it
> may also be enabled by placing the string \"xtrace\" in the SHELLOPTS
> environment variable before bash is started.
>
> A malicious user with sudo access to a shell script that uses bash can
> use this feature to run arbitrary commands for each line of the
> script.


## Affected packages
 - **sudo**
    - **Fixed:** 1.6.8.10

## Details
 - **published**: 2006-02-16T00:00:00Z
 - **modified**: 2006-02-16T00:00:00Z
 - **discovery**: 2005-10-25T00:00:00Z
 - **vid**: [1b725079-9ef6-11da-b410-000e0c2e438a](https://vuxml.freebsd.org/freebsd/1b725079-9ef6-11da-b410-000e0c2e438a.html)

## References
 - REPORT: [http://www.courtesan.com/sudo/alerts/bash_env.html](http://www.courtesan.com/sudo/alerts/bash_env.html)
 - ADVISORY: [https://www.securityfocus.com/bid/15191/info](https://www.securityfocus.com/bid/15191/info)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2005-2959](https://api.osv.dev/v1/vulns/CVE-2005-2959)
