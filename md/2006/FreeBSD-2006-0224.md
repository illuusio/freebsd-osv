# bind9 -- Denial of Service in named(8)
# Problem Description

For a recursive DNS server, a remote attacker sending enough recursive
queries for the replies to arrive after all the interested clients have
left the recursion queue will trigger an INSIST failure in the named(8)
daemon. Also for a recursive DNS server, an assertion failure can occur
when processing a query whose reply will contain more than one
SIG(covered) RRset.

For an authoritative DNS server serving a RFC 2535 DNSSEC zone which is
queried for the SIG records where there are multiple SIG(covered) RRsets
(e.g. a zone apex), named(8) will trigger an assertion failure when it
tries to construct the response.

# Impact

An attacker who can perform recursive lookups on a DNS server and is
able to send a sufficiently large number of recursive queries, or is
able to get the DNS server to return more than one SIG(covered) RRsets
can stop the functionality of the DNS service.

An attacker querying an authoritative DNS server serving a RFC 2535
DNSSEC zone may be able to crash the DNS server.

# Workaround

A possible workaround is to only allow trusted clients to perform
recursive queries.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.1
    - **Fixed:** 6.1_6
    - **Introduced:** 6.0
    - **Fixed:** 6.0_11
    - **Introduced:** 5.5
    - **Fixed:** 5.5_4
    - **Introduced:** 5.4
    - **Fixed:** 5.4_18
    - **Introduced:** 5.0
    - **Fixed:** 5.3_33
 - **bind9**
    - **Introduced:** 9.0
    - **Fixed:** 9.3.2.1

## Details
 - **published**: 2006-12-19T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2006-09-06T00:00:00Z
 - **vid**: [ef3306fc-8f9b-11db-ab33-000e0c2e438a](https://vuxml.freebsd.org/freebsd/ef3306fc-8f9b-11db-ab33-000e0c2e438a.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2006-4095](https://api.osv.dev/v1/vulns/CVE-2006-4095)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2006-4096](https://api.osv.dev/v1/vulns/CVE-2006-4096)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-06:20.bind.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-06:20.bind.asc)
