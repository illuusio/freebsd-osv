# cvsbug -- race condition
Problem description

A temporary file is created, used, deleted, and then re-created with the
same name. This creates a window during which an attacker could replace
the file with a link to another file. While cvsbug(1) is based on the
send-pr(1) utility, this problem does not exist in the version of
send-pr(1) distributed with FreeBSD.\
In FreeBSD 4.10 and 5.3, some additional problems exist concerning
temporary file usage in both cvsbug(1) and send-pr(1).

Impact

A local attacker could cause data to be written to any file to which the
user running cvsbug(1) (or send-pr(1) in FreeBSD 4.10 and 5.3) has write
access. This may cause damage in itself (e.g., by destroying important
system files or documents) or may be used to obtain elevated privileges.

Workaround

Do not use the cvsbug(1) utility on any system with untrusted users.\
Do not use the send-pr(1) utility on a FreeBSD 4.10 or 5.3 system with
untrusted users.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 5.4
    - **Fixed:** 5.4_7
    - **Introduced:** 5.3
    - **Fixed:** 5.3_22
    - **Introduced:** 4.11
    - **Fixed:** 4.11_12
    - **Introduced:** 4.10
    - **Fixed:** 4.10_18
 - **cvs+ipv6**
    - **Fixed:** 1.11.17_1

## Details
 - **published**: 2006-01-27T00:00:00Z
 - **modified**: 2006-11-08T00:00:00Z
 - **discovery**: 2005-09-07T00:00:00Z
 - **vid**: [c5c17ead-8f23-11da-8c1d-000e0c2e438a](https://vuxml.freebsd.org/freebsd/c5c17ead-8f23-11da-8c1d-000e0c2e438a.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CAN-2005-2693](https://cveawg.mitre.org/api/cve/CAN-2005-2693)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-05:20.cvsbug.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-05:20.cvsbug.asc)
