# php -- _ecalloc Integer Overflow Vulnerability
Stefan Esser reports:

> The PHP 5 branch of the PHP source code lacks the protection against
> possible integer overflows inside ecalloc() that is present in the PHP
> 4 branch and also for several years part of our Hardening-Patch and
> our new Suhosin-Patch.
>
> It was discovered that such an integer overflow can be triggered when
> user input is passed to the unserialize() function. Earlier
> vulnerabilities in PHP\'s unserialize() that were also discovered by
> one of our audits in December 2004 are unrelated to the newly
> discovered flaw, but they have shown, that the unserialize() function
> is exposed to user-input in many popular PHP applications. Examples
> for applications that use the content of COOKIE variables with
> unserialize() are phpBB and Serendipity.
>
> The successful exploitation of this integer overflow will result in
> arbitrary code execution.


## Affected packages
 - **php5**
    - **Fixed:** 5.1.6_1
 - **php5-cli**
    - **Introduced:** 5
    - **Fixed:** 5.1.6_1
 - **php5-cgi**
    - **Introduced:** 5
    - **Fixed:** 5.1.6_1
 - **php5-dtc**
    - **Introduced:** 5
    - **Fixed:** 5.1.6_1
 - **php5-horde**
    - **Introduced:** 5
    - **Fixed:** 5.1.6_1
 - **php5-nms**
    - **Introduced:** 5
    - **Fixed:** 5.1.6_1
 - **mod_php5**
    - **Introduced:** 5
    - **Fixed:** 5.1.6_1

## Details
 - **published**: 2006-10-06T00:00:00Z
 - **modified**: 2013-04-01T00:00:00Z
 - **discovery**: 2006-09-30T00:00:00Z
 - **vid**: [e329550b-54f7-11db-a5ae-00508d6a62df](https://vuxml.freebsd.org/freebsd/e329550b-54f7-11db-a5ae-00508d6a62df.html)

## References
 - REPORT: [http://www.hardened-php.net/advisory_092006.133.html](http://www.hardened-php.net/advisory_092006.133.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2006-4812](https://cveawg.mitre.org/api/cve/CVE-2006-4812)
 - WEB: [http://secunia.com/advisories/22280/](http://secunia.com/advisories/22280/)
