# OPIE -- arbitrary password change
# Problem Description

The opiepasswd(1) program uses getlogin(2) to identify the user calling
opiepasswd(1). In some circumstances getlogin(2) will return \"root\"
even when running as an unprivileged user. This causes opiepasswd(1) to
allow an unpriviled user to configure OPIE authentication for the root
user.

# Impact

In certain cases an attacker able to run commands as a non privileged
users which have not explicitly logged in, for example CGI scripts run
by a web server, is able to configure OPIE access for the root user. If
the attacker is able to authenticate as root using OPIE authentication,
for example if \"PermitRootLogin\" is set to \"yes\" in sshd_config or
the attacker has access to a local user in the \"wheel\" group, the
attacker can gain root privileges.

# Workaround

Disable OPIE authentication in PAM:

    # sed -i "" -e /opie/s/^/#/ /etc/pam.d/*

or

Remove the setuid bit from opiepasswd:

    # chflags noschg /usr/bin/opiepasswd

    # chmod 555 /usr/bin/opiepasswd

    # chflags schg /usr/bin/opiepasswd


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.0
    - **Fixed:** 6.0_6
    - **Introduced:** 5.4
    - **Fixed:** 5.4_13
    - **Introduced:** 5.3
    - **Fixed:** 5.3_28
    - **Introduced:** 4.11
    - **Fixed:** 4.11_16
    - **Introduced:** 4.10
    - **Fixed:** 4.10_22

## Details
 - **published**: 2006-03-24T00:00:00Z
 - **modified**: 2006-06-09T00:00:00Z
 - **discovery**: 2006-03-22T00:00:00Z
 - **vid**: [e93bc5b0-bb2e-11da-b2fb-000e0c2e438a](https://vuxml.freebsd.org/freebsd/e93bc5b0-bb2e-11da-b2fb-000e0c2e438a.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2006-1283](https://cveawg.mitre.org/api/cve/CVE-2006-1283)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-06:12.opie.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-06:12.opie.asc)
