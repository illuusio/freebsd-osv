# bogofilter -- heap corruption through malformed input
Matthias Andree reports:

> When using Unicode databases (default in more recent bogofilter
> installations), upon encountering invalid input sequences, bogofilter
> or bogolexer could overrun a malloc()\'d buffer, corrupting the heap,
> while converting character sets. Bogofilter would usually be
> processing untrusted data received from the network at that time.
>
> This problem was aggravated by an unrelated bug that made bogofilter
> process binary attachments as though they were text, and attempt
> charset conversion on them. Given the MIME default character set,
> US-ASCII, all input octets in the range 0x80\...0xff were considered
> invalid input sequences and could trigger the heap corruption.


## Affected packages
 - **bogofilter**
    - **Introduced:** 0.93.5
    - **Fixed:** 0.96.3

## Details
 - **published**: 2006-01-07T00:00:00Z
 - **modified**: 2006-01-07T00:00:00Z
 - **discovery**: 2005-10-22T00:00:00Z
 - **vid**: [92140bc9-7bde-11da-8ec4-0002b3b60e4c](https://vuxml.freebsd.org/freebsd/92140bc9-7bde-11da-8ec4-0002b3b60e4c.html)

## References
 - REPORT: [http://bogofilter.sourceforge.net/security/bogofilter-SA-2005-01](http://bogofilter.sourceforge.net/security/bogofilter-SA-2005-01)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2005-4591](https://cveawg.mitre.org/api/cve/CVE-2005-4591)
