# texindex -- temporary file privilege escalation
Problem description

The \"sort_offline\" function used by texindex(1) employs the
\"maketempname\" function, which produces predictable file names and
fails to validate that the paths do not exist.

Impact

These predictable temporary file names are problematic because they
allow an attacker to take advantage of a race condition in order to
execute a symlink attack, which could enable them to overwrite files on
the system in the context of the user running the texindex(1) utility.

Workaround

No workaround is available, but the problematic code is only executed if
the input file being processed is 500kB or more in length; as a result,
users working with documents of less than several hundred pages are very
unlikely to be affected.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.0
    - **Fixed:** 6.0_2
    - **Introduced:** 5.4
    - **Fixed:** 5.4_9
    - **Introduced:** 5.3
    - **Fixed:** 5.3_24
    - **Introduced:** 4.11
    - **Fixed:** 4.11_14
    - **Introduced:** 4.10
    - **Fixed:** 4.10_20

## Details
 - **published**: 2006-01-27T00:00:00Z
 - **modified**: 2006-01-27T00:00:00Z
 - **discovery**: 2006-01-11T00:00:00Z
 - **vid**: [c01a25f5-8f20-11da-8c1d-000e0c2e438a](https://vuxml.freebsd.org/freebsd/c01a25f5-8f20-11da-8c1d-000e0c2e438a.html)

## References
 - ADVISORY: [https://www.securityfocus.com/bid/14854/info](https://www.securityfocus.com/bid/14854/info)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CAN-2005-3011](https://cveawg.mitre.org/api/cve/CAN-2005-3011)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-06:01.texindex.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-06:01.texindex.asc)
