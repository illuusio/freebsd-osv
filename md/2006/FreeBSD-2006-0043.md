# nfs -- remote denial of service
# Problem description:

A part of the NFS server code charged with handling incoming RPC
messages via TCP had an error which, when the server received a message
with a zero-length payload, would cause a NULL pointer dereference which
results in a kernel panic. The kernel will only process the RPC messages
if a userland nfsd daemon is running.

# Impact:

The NULL pointer deference allows a remote attacker capable of sending
RPC messages to an affected FreeBSD system to crash the FreeBSD system.

# Workaround:

1.  Disable the NFS server: set the nfs_server_enable variable to \"NO\"
    in /etc/rc.conf, and reboot.

    Alternatively, if there are no active NFS clients (as listed by the
    showmount(8) utility), simply killing the mountd and nfsd processes
    should suffice.

2.  Add firewall rules to block RPC traffic to the NFS server from
    untrusted hosts.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.0
    - **Fixed:** 6.0_5
    - **Introduced:** 5.4
    - **Fixed:** 5.4_12
    - **Introduced:** 5.3
    - **Fixed:** 5.3_27
    - **Introduced:** 4.11
    - **Fixed:** 4.11_15
    - **Introduced:** 4.10
    - **Fixed:** 4.10_21

## Details
 - **published**: 2006-03-12T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2006-03-01T00:00:00Z
 - **vid**: [6111ecb8-b20d-11da-b2fb-000e0c2e438a](https://vuxml.freebsd.org/freebsd/6111ecb8-b20d-11da-b2fb-000e0c2e438a.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2006-0900](https://cveawg.mitre.org/api/cve/CVE-2006-0900)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-06:10.nfs.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-06:10.nfs.asc)
