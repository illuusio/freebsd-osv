# openssh -- multiple vulnerabilities
# Problem Description

The CRC compensation attack detector in the sshd(8) daemon, upon receipt
of duplicate blocks, uses CPU time cubic in the number of duplicate
blocks received. \[CVE-2006-4924\]

A race condition exists in a signal handler used by the sshd(8) daemon
to handle the LoginGraceTime option, which can potentially cause some
cleanup routines to be executed multiple times. \[CVE-2006-5051\]

# Impact

An attacker sending specially crafted packets to sshd(8) can cause a
Denial of Service by using 100% of CPU time until a connection timeout
occurs. Since this attack can be performed over multiple connections
simultaneously, it is possible to cause up to MaxStartups (10 by
default) sshd processes to use all the CPU time they can obtain.
\[CVE-2006-4924\]

The OpenSSH project believe that the race condition can lead to a Denial
of Service or potentially remote code execution, but the FreeBSD
Security Team has been unable to verify the exact impact.
\[CVE-2006-5051\]

# Workaround

The attack against the CRC compensation attack detector can be avoided
by disabling SSH Protocol version 1 support in sshd_config(5).

There is no workaround for the second issue.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.1
    - **Fixed:** 6.1_10
    - **Introduced:** 6.0
    - **Fixed:** 6.0_15
    - **Introduced:** 5.5
    - **Fixed:** 5.5_8
    - **Introduced:** 5.4
    - **Fixed:** 5.4_22
    - **Introduced:** 5.0
    - **Fixed:** 5.3_37
    - **Fixed:** 4.11_25
 - **openssh**
    - **Fixed:** 4.4,1
 - **openssh-portable**
    - **Fixed:** 4.4.p1,1

## Details
 - **published**: 2006-09-30T00:00:00Z
 - **modified**: 2006-09-30T00:00:00Z
 - **discovery**: 2006-09-25T00:00:00Z
 - **vid**: [32db37a5-50c3-11db-acf3-000c6ec775d9](https://vuxml.freebsd.org/freebsd/32db37a5-50c3-11db-acf3-000c6ec775d9.html)

## References
 - ADVISORY: [https://www.securityfocus.com/bid/20216/info](https://www.securityfocus.com/bid/20216/info)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2006-4924](https://cveawg.mitre.org/api/cve/CVE-2006-4924)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2006-5051](https://cveawg.mitre.org/api/cve/CVE-2006-5051)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-06:22.openssh.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-06:22.openssh.asc)
 - WEB: [http://www.openssh.com/txt/release-4.4](http://www.openssh.com/txt/release-4.4)
