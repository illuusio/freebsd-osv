# php -- open_basedir Race Condition Vulnerability
Stefan Esser reports:

> PHP\'s open_basedir feature is meant to disallow scripts to access
> files outside a set of configured base directories. The checks for
> this are placed within PHP functions dealing with files before the
> actual open call is performed.
>
> Obviously there is a little span of time between the check and the
> actual open call. During this time span the checked path could have
> been altered and point to a file that is forbidden to be accessed due
> to open_basedir restrictions.
>
> Because the open_basedir restrictions often not call PHP functions but
> 3rd party library functions to actually open the file it is impossible
> to close this time span in a general way. It would only be possible to
> close it when PHP handles the actual opening on it\'s own.
>
> While it seems hard to change the path during this little time span it
> is very simple with the use of the symlink() function combined with a
> little trick. PHP\'s symlink() function ensures that source and target
> of the symlink operation are allowed by open_basedir restrictions (and
> safe_mode). However it is possible to point a symlink to any file by
> the use of mkdir(), unlink() and at least two symlinks.


## Affected packages
 - **php4**
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php5**
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php-suhosin**
    - **Fixed:** 0.9.6
 - **php4-cli**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php5-cli**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php4-cgi**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php5-cgi**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php4-dtc**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php5-dtc**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php4-horde**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php5-horde**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php4-nms**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **php5-nms**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **mod_php4**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2
 - **mod_php5**
    - **Introduced:** 4
    - **Fixed:** 4.4.4_1
    - **Introduced:** 5
    - **Fixed:** 5.1.6_2

## Details
 - **published**: 2006-10-05T00:00:00Z
 - **modified**: 2013-04-01T00:00:00Z
 - **discovery**: 2006-10-02T00:00:00Z
 - **vid**: [edabe438-542f-11db-a5ae-00508d6a62df](https://vuxml.freebsd.org/freebsd/edabe438-542f-11db-a5ae-00508d6a62df.html)

## References
 - REPORT: [http://www.hardened-php.net/advisory_082006.132.html](http://www.hardened-php.net/advisory_082006.132.html)
 - ADVISORY: [https://www.securityfocus.com/bid/20326/info](https://www.securityfocus.com/bid/20326/info)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2006-5178](https://cveawg.mitre.org/api/cve/CVE-2006-5178)
 - WEB: [http://secunia.com/advisories/22235/](http://secunia.com/advisories/22235/)
