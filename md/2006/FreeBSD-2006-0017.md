# pf -- IP fragment handling panic
Problem description:

A logic bug in pf\'s IP fragment cache may result in a packet fragment
being inserted twice, violating a kernel invariant.

Impact:

By sending carefully crafted sequence of IP packet fragments, a remote
attacker can cause a system running pf with a ruleset containing a
\'scrub fragment crop\' or \'scrub fragment drop-ovl\' rule to crash.

Workaround:

Do not use \'scrub fragment crop\' or \'scrub fragment drop-ovl\' rules
on systems running pf. In most cases, such rules can be replaced by
\'scrub fragment reassemble\' rules; see the pf.conf(5) manual page for
more details.

Systems which do not use pf, or use pf but do not use the aforementioned
rules, are not affected by this issue.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.0
    - **Fixed:** 6.0_4
    - **Introduced:** 5.4
    - **Fixed:** 5.4_10
    - **Introduced:** 5.3
    - **Fixed:** 5.3_25

## Details
 - **published**: 2006-02-14T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2006-01-25T00:00:00Z
 - **vid**: [52ba7713-9d42-11da-8c1d-000e0c2e438a](https://vuxml.freebsd.org/freebsd/52ba7713-9d42-11da-8c1d-000e0c2e438a.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2006-0381](https://api.osv.dev/v1/vulns/CVE-2006-0381)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-06:07.pf.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-06:07.pf.asc)
