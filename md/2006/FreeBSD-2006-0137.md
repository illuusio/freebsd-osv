# clamav -- heap overflow vulnerability
Clamav team reports:

> A heap overflow vulnerability was discovered in libclamav which could
> cause a denial of service or allow the execution of arbitrary code.
>
> The problem is specifically located in the PE file rebuild function
> used by the UPX unpacker.
>
> Relevant code from libclamav/upx.c:
>
> memcpy(dst, newbuf, foffset); \*dsize = foffset; free(newbuf);
> cli_dbgmsg(\"UPX: PE structure rebuilt from compressed file\\n\");
> return 1;
>
> Due to improper validation it is possible to overflow the above
> memcpy() beyond the allocated memory block.


## Affected packages
 - **clamav**
    - **Introduced:** 0.88.1
    - **Fixed:** 0.88.4
 - **clamav-devel**
    - **Fixed:** 20060808

## Details
 - **published**: 2006-08-08T00:00:00Z
 - **modified**: 2006-08-08T00:00:00Z
 - **discovery**: 2006-08-07T00:00:00Z
 - **vid**: [342d2e48-26db-11db-9275-000475abc56f](https://vuxml.freebsd.org/freebsd/342d2e48-26db-11db-9275-000475abc56f.html)

## References
 - REPORT: [http://www.clamav.net/security/0.88.4.html](http://www.clamav.net/security/0.88.4.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2006-4018](https://api.osv.dev/v1/vulns/CVE-2006-4018)
