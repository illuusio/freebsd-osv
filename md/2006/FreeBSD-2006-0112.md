# smbfs -- chroot escape
# Problem Description

smbfs does not properly sanitize paths containing a backslash character;
in particular the directory name \'..\\\' is interpreted as the parent
directory by the SMB/CIFS server, but smbfs handles it in the same
manner as any other directory.

# Impact

When inside a chroot environment which resides on a smbfs mounted
file-system it is possible for an attacker to escape out of this chroot
to any other directory on the smbfs mounted file-system.

# Workaround

Mount the smbfs file-systems which need to be used with chroot on top,
in a way so the chroot directory is exactly on the mount point and not a
sub directory


## Affected packages
 - **FreeBSD**
    - **Introduced:** 4.10
    - **Fixed:** 4.10_24
    - **Introduced:** 4.11
    - **Fixed:** 4.11_18
    - **Introduced:** 5.3
    - **Fixed:** 5.3_30
    - **Introduced:** 5.4
    - **Fixed:** 5.4_15
    - **Introduced:** 5.5
    - **Fixed:** 5.5_1
    - **Introduced:** 6.0
    - **Fixed:** 6.0_8
    - **Introduced:** 6.1
    - **Fixed:** 6.1_1

## Details
 - **published**: 2006-06-09T00:00:00Z
 - **modified**: 2006-06-09T00:00:00Z
 - **discovery**: 2006-05-31T00:00:00Z
 - **vid**: [cf3b9a96-f7bb-11da-9156-000e0c2e438a](https://vuxml.freebsd.org/freebsd/cf3b9a96-f7bb-11da-9156-000e0c2e438a.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2006-2654](https://cveawg.mitre.org/api/cve/CVE-2006-2654)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-06:16.smbfs.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-06:16.smbfs.asc)
