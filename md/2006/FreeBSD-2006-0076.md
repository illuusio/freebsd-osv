# FreeBSD -- FPU information disclosure
# Problem Description

On \"7th generation\" and \"8th generation\" processors manufactured by
AMD, including the AMD Athlon, Duron, Athlon MP, Athlon XP, Athlon64,
Athlon64 FX, Opteron, Turion, and Sempron, the fxsave and fxrstor
instructions do not save and restore the FOP, FIP, and FDP registers
unless the exception summary bit (ES) in the x87 status word is set to
1, indicating that an unmasked x87 exception has occurred.

This behaviour is consistent with documentation provided by AMD, but is
different from processors from other vendors, which save and restore the
FOP, FIP, and FDP registers regardless of the value of the ES bit. As a
result of this discrepancy remaining unnoticed until now, the FreeBSD
kernel does not restore the contents of the FOP, FIP, and FDP registers
between context switches.

# Impact

On affected processors, a local attacker can monitor the execution path
of a process which uses floating-point operations. This may allow an
attacker to steal cryptographic keys or other sensitive information.

# Workaround

No workaround is available, but systems which do not use AMD Athlon,
Duron, Athlon MP, Athlon XP, Athlon64, Athlon64 FX, Opteron, Turion, or
Sempron processors are not vulnerable.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.0
    - **Fixed:** 6.0_7
    - **Introduced:** 5.4
    - **Fixed:** 5.4_14
    - **Introduced:** 5.3
    - **Fixed:** 5.3_29
    - **Introduced:** 5
    - **Fixed:** 5.3
    - **Introduced:** 4.11
    - **Fixed:** 4.11_17
    - **Introduced:** 4.10
    - **Fixed:** 4.10_23
    - **Fixed:** 4.10

## Details
 - **published**: 2006-04-19T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2006-04-19T00:00:00Z
 - **vid**: [1fa4c9f1-cfca-11da-a672-000e0c2e438a](https://vuxml.freebsd.org/freebsd/1fa4c9f1-cfca-11da-a672-000e0c2e438a.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2006-1056](https://api.osv.dev/v1/vulns/CVE-2006-1056)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-06:14.fpu.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-06:14.fpu.asc)
