# xen-kernel -- x86 shadow pagetables: address width overflow
The Xen Project reports:

> In the x86 shadow pagetable code, the guest frame number of a
> superpage mapping is stored in a 32-bit field. If a shadowed guest can
> cause a superpage mapping of a guest-physical address at or above
> 2\^44 to be shadowed, the top bits of the address will be lost,
> causing an assertion failure or NULL dereference later on, in code
> that removes the shadow.
>
> A HVM guest using shadow pagetables can cause the host to crash.
>
> A PV guest using shadow pagetables (i.e. being migrated) with PV
> superpages enabled (which is not the default) can crash the host, or
> corrupt hypervisor memory, and so a privilege escalation cannot be
> ruled out.


## Affected packages
 - **xen-kernel**
    - **Introduced:** 3.4
    - **Fixed:** 4.7.0

## Details
 - **published**: 2016-07-04T00:00:00Z
 - **modified**: 2016-07-04T00:00:00Z
 - **discovery**: 2016-04-18T00:00:00Z
 - **vid**: [d51ced72-4212-11e6-942d-bc5ff45d0f28](https://vuxml.freebsd.org/freebsd/d51ced72-4212-11e6-942d-bc5ff45d0f28.html)

## References
 - REPORT: [http://xenbits.xen.org/xsa/advisory-173.html](http://xenbits.xen.org/xsa/advisory-173.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2016-3960](https://api.osv.dev/v1/vulns/CVE-2016-3960)
 - WEB: [http://xenbits.xen.org/xsa/advisory-173.html](http://xenbits.xen.org/xsa/advisory-173.html)
