# qemu -- code execution on host machine
Petr Matousek of Red Hat Inc. reports:

> Due converting PIO to the new memory read/write api we no longer
> provide separate I/O region lenghts for read and write operations. As
> a result, reading from PIT Mode/Command register will end with
> accessing pit-\>channels with invalid index and potentially cause
> memory corruption and/or minor information leak.
>
> A privileged guest user in a guest with QEMU PIT emulation enabled
> could potentially (tough unlikely) use this flaw to execute arbitrary
> code on the host with the privileges of the hosting QEMU process.
>
> Please note that by default QEMU/KVM guests use in-kernel (KVM) PIT
> emulation and are thus not vulnerable to this issue.


## Affected packages
 - **qemu**
    - **Fixed:** 2.4.0
 - **qemu-devel**
    - **Fixed:** 2.4.0
 - **qemu-sbruno**
    - **Fixed:** 2.4.50.g20150814
 - **qemu-user-static**
    - **Fixed:** 2.4.50.g20150814

## Details
 - **published**: 2016-01-01T00:00:00Z
 - **modified**: 2016-01-01T00:00:00Z
 - **discovery**: 2015-06-17T00:00:00Z
 - **vid**: [aea8d90e-b0c1-11e5-8d13-bc5ff45d0f28](https://vuxml.freebsd.org/freebsd/aea8d90e-b0c1-11e5-8d13-bc5ff45d0f28.html)

## References
 - REPORT: [http://openwall.com/lists/oss-security/2015/06/17/5](http://openwall.com/lists/oss-security/2015/06/17/5)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2015-3214](https://cveawg.mitre.org/api/cve/CVE-2015-3214)
 - WEB: [http://git.qemu.org/?p=qemu.git;a=commit;h=d4862a87e31a51de9eb260f25c9e99a75efe3235](http://git.qemu.org/?p=qemu.git;a=commit;h=d4862a87e31a51de9eb260f25c9e99a75efe3235)
 - WEB: [https://github.com/seanbruno/qemu-bsd-user/commit/d4862a87e31a51de9eb260f25c9e99a75efe3235](https://github.com/seanbruno/qemu-bsd-user/commit/d4862a87e31a51de9eb260f25c9e99a75efe3235)
