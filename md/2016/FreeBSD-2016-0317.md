# FreeBSD -- Kernel memory disclosure in control messages and SCTP
# Problem Description:

Buffer between control message header and data may not be completely
initialized before being copied to userland. \[CVE-2014-3952\]

Three SCTP cmsgs, SCTP_SNDRCV, SCTP_EXTRCV and SCTP_RCVINFO, have
implicit padding that may not be completely initialized before being
copied to userland. In addition, three SCTP notifications,
SCTP_PEER_ADDR_CHANGE, SCTP_REMOTE_ERROR and SCTP_AUTHENTICATION_EVENT,
have padding in the returning data structure that may not be completely
initialized before being copied to userland. \[CVE-2014-3953\]

# Impact:

An unprivileged local process may be able to retrieve portion of kernel
memory.

For the generic control message, the process may be able to retrieve a
maximum of 4 bytes of kernel memory.

For SCTP, the process may be able to retrieve 2 bytes of kernel memory
for all three control messages, plus 92 bytes for SCTP_SNDRCV and 76
bytes for SCTP_EXTRCV. If the local process is permitted to receive SCTP
notification, a maximum of 112 bytes of kernel memory may be returned to
userland.

This information might be directly useful, or it might be leveraged to
obtain elevated privileges in some way. For example, a terminal buffer
might include a user-entered password.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 10.0
    - **Fixed:** 10.0_7
    - **Introduced:** 9.2
    - **Fixed:** 9.2_10
    - **Introduced:** 9.1
    - **Fixed:** 9.1_17
    - **Introduced:** 8.4
    - **Fixed:** 8.4_14

## Details
 - **published**: 2016-08-11T00:00:00Z
 - **modified**: 2016-08-11T00:00:00Z
 - **discovery**: 2014-07-08T00:00:00Z
 - **vid**: [7240de58-6007-11e6-a6c3-14dae9d210b8](https://vuxml.freebsd.org/freebsd/7240de58-6007-11e6-a6c3-14dae9d210b8.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2014-3952](https://cveawg.mitre.org/api/cve/CVE-2014-3952)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2014-3953](https://cveawg.mitre.org/api/cve/CVE-2014-3953)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-14:17.kmem.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-14:17.kmem.asc)
