# py-pillow -- Buffer overflow in TIFF decoding code
The Pillow maintainers report:

> Pillow 3.1.0 and earlier when linked against libtiff \>= 4.0.0 on x64
> may overflow a buffer when reading a specially crafted tiff file.
>
> Specifically, libtiff \>= 4.0.0 changed the return type of
> TIFFScanlineSize from int32 to machine dependent int32\|64. If the
> scanline is sized so that it overflows an int32, it may be interpreted
> as a negative number, which will then pass the size check in
> TiffDecode.c line 236. To do this, the logical scanline size has to be
> \> 2gb, and for the test file, the allocated buffer size is 64k
> against a roughly 4gb scan line size. Any image data over 64k is
> written over the heap, causing a segfault.
>
> This issue was found by security researcher FourOne.


## Affected packages
 - **py27-pillow**
    - **Fixed:** 2.9.0_1
 - **py33-pillow**
    - **Fixed:** 2.9.0_1
 - **py34-pillow**
    - **Fixed:** 2.9.0_1
 - **py35-pillow**
    - **Fixed:** 2.9.0_1

## Details
 - **published**: 2016-02-09T00:00:00Z
 - **modified**: 2016-02-09T00:00:00Z
 - **discovery**: 2016-02-04T00:00:00Z
 - **vid**: [53252879-cf11-11e5-805c-5453ed2e2b49](https://vuxml.freebsd.org/freebsd/53252879-cf11-11e5-805c-5453ed2e2b49.html)

## References
 - REPORT: [https://pillow.readthedocs.org/en/3.1.x/releasenotes/3.1.1.html](https://pillow.readthedocs.org/en/3.1.x/releasenotes/3.1.1.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2016-0740](https://cveawg.mitre.org/api/cve/CVE-2016-0740)
 - WEB: [https://github.com/python-pillow/Pillow/commit/6dcbf5bd96b717c58d7b642949da8d323099928e](https://github.com/python-pillow/Pillow/commit/6dcbf5bd96b717c58d7b642949da8d323099928e)
