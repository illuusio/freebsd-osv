# qemu and xen-tools -- denial of service vulnerabilities in AMD PC-Net II NIC support
Prasad J Pandit, Red Hat Product Security Team, reports:

> Qemu emulator built with the AMD PC-Net II Ethernet Controller support
> is vulnerable to a heap buffer overflow flaw. While receiving packets
> in the loopback mode, it appends CRC code to the receive buffer. If
> the data size given is same as the receive buffer size, the appended
> CRC code overwrites 4 bytes beyond this \'s-\>buffer\' array.
>
> A privileged(CAP_SYS_RAWIO) user inside guest could use this flaw to
> crash the Qemu instance resulting in DoS or potentially execute
> arbitrary code with privileges of the Qemu process on the host.

> The AMD PC-Net II emulator(hw/net/pcnet.c), while receiving packets
> from a remote host(non-loopback mode), fails to validate the received
> data size, thus resulting in a buffer overflow issue. It could
> potentially lead to arbitrary code execution on the host, with
> privileges of the Qemu process. It requires the guest NIC to have
> larger MTU limit.
>
> A remote user could use this flaw to crash the guest instance
> resulting in DoS or potentially execute arbitrary code on a remote
> host with privileges of the Qemu process.


## Affected packages
 - **qemu**
    - **Fixed:** 2.5.0
 - **qemu-devel**
    - **Fixed:** 2.5.0
 - **qemu-sbruno**
    - **Fixed:** 2.5.50.g20151224
 - **qemu-user-static**
    - **Fixed:** 2.5.50.g20151224
 - **xen-tools**
    - **Fixed:** 4.5.2_1

## Details
 - **published**: 2016-01-03T00:00:00Z
 - **modified**: 2016-01-06T00:00:00Z
 - **discovery**: 2015-11-30T00:00:00Z
 - **vid**: [405446f4-b1b3-11e5-9728-002590263bf5](https://vuxml.freebsd.org/freebsd/405446f4-b1b3-11e5-9728-002590263bf5.html)

## References
 - REPORT: [http://www.openwall.com/lists/oss-security/2015/11/30/2](http://www.openwall.com/lists/oss-security/2015/11/30/2)
 - REPORT: [http://www.openwall.com/lists/oss-security/2015/11/30/3](http://www.openwall.com/lists/oss-security/2015/11/30/3)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2015-7504](https://cveawg.mitre.org/api/cve/CVE-2015-7504)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2015-7512](https://cveawg.mitre.org/api/cve/CVE-2015-7512)
 - WEB: [http://git.qemu.org/?p=qemu.git;a=commit;h=837f21aacf5a714c23ddaadbbc5212f9b661e3f7](http://git.qemu.org/?p=qemu.git;a=commit;h=837f21aacf5a714c23ddaadbbc5212f9b661e3f7)
 - WEB: [http://git.qemu.org/?p=qemu.git;a=commit;h=8b98a2f07175d46c3f7217639bd5e03f2ec56343](http://git.qemu.org/?p=qemu.git;a=commit;h=8b98a2f07175d46c3f7217639bd5e03f2ec56343)
 - WEB: [https://github.com/seanbruno/qemu-bsd-user/commit/837f21aacf5a714c23ddaadbbc5212f9b661e3f7](https://github.com/seanbruno/qemu-bsd-user/commit/837f21aacf5a714c23ddaadbbc5212f9b661e3f7)
 - WEB: [https://github.com/seanbruno/qemu-bsd-user/commit/8b98a2f07175d46c3f7217639bd5e03f2ec56343](https://github.com/seanbruno/qemu-bsd-user/commit/8b98a2f07175d46c3f7217639bd5e03f2ec56343)
 - WEB: [http://xenbits.xen.org/xsa/advisory-162.html](http://xenbits.xen.org/xsa/advisory-162.html)
