# xen-kernel -- XENMEM_exchange error handling issues
The Xen Project reports:

> Error handling in the operation may involve handing back pages to the
> domain. This operation may fail when in parallel the domain gets torn
> down. So far this failure unconditionally resulted in the host being
> brought down due to an internal error being assumed. This is
> CVE-2015-8339.
>
> Furthermore error handling so far wrongly included the release of a
> lock. That lock, however, was either not acquired or already released
> on all paths leading to the error handling sequence. This is
> CVE-2015-8340.
>
> A malicious guest administrator may be able to deny service by
> crashing the host or causing a deadlock.


## Affected packages
 - **xen-kernel**
    - **Fixed:** 4.5.2_1

## Details
 - **published**: 2016-01-06T00:00:00Z
 - **modified**: 2016-01-06T00:00:00Z
 - **discovery**: 2015-12-08T00:00:00Z
 - **vid**: [bcad3faa-b40c-11e5-9728-002590263bf5](https://vuxml.freebsd.org/freebsd/bcad3faa-b40c-11e5-9728-002590263bf5.html)

## References
 - REPORT: [http://xenbits.xen.org/xsa/advisory-159.html](http://xenbits.xen.org/xsa/advisory-159.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2015-8339](https://api.osv.dev/v1/vulns/CVE-2015-8339)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2015-8340](https://api.osv.dev/v1/vulns/CVE-2015-8340)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=205841](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=205841)
 - WEB: [http://xenbits.xen.org/xsa/advisory-159.html](http://xenbits.xen.org/xsa/advisory-159.html)
