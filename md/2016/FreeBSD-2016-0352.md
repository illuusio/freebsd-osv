# FreeBSD -- Heap vulnerability in bspatch
# Problem Description:

The implementation of bspatch does not check for a negative value on
numbers of bytes read from the diff and extra streams, allowing an
attacker who can control the patch file to write at arbitrary locations
in the heap.

This issue was first discovered by The Chromium Project and reported
independently by Lu Tung-Pin to the FreeBSD project.

# Impact:

An attacker who can control the patch file can cause a crash or run
arbitrary code under the credentials of the user who runs bspatch, in
many cases, root.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 10.3
    - **Fixed:** 10.3_6
    - **Introduced:** 10.2
    - **Fixed:** 10.2_20
    - **Introduced:** 10.1
    - **Fixed:** 10.1_37
    - **Introduced:** 9.3
    - **Fixed:** 9.3_45

## Details
 - **published**: 2016-08-11T00:00:00Z
 - **modified**: 2016-08-11T00:00:00Z
 - **discovery**: 2016-07-25T00:00:00Z
 - **vid**: [7d4f4955-600a-11e6-a6c3-14dae9d210b8](https://vuxml.freebsd.org/freebsd/7d4f4955-600a-11e6-a6c3-14dae9d210b8.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2014-9862](https://cveawg.mitre.org/api/cve/CVE-2014-9862)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-16:25.bspatch.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-16:25.bspatch.asc)
