# glibc -- getaddrinfo stack-based buffer overflow
Fabio Olive Leite reports:

> A stack-based buffer overflow was found in libresolv when invoked from
> nss_dns, allowing specially crafted DNS responses to seize control of
> EIP in the DNS client. The buffer overflow occurs in the functions
> send_dg (send datagram) and send_vc (send TCP) for the NSS module
> libnss_dns.so.2 when calling getaddrinfo with AF_UNSPEC family, or in
> some cases AF_INET6 family. The use of AF_UNSPEC (or AF_INET6 in some
> cases) triggers the low-level resolver code to send out two parallel
> queries for A and AAAA. A mismanagement of the buffers used for those
> queries could result in the response of a query writing beyond the
> alloca allocated buffer created by \_\_res_nquery.


## Affected packages
 - **linux_base-c6**
    - **Fixed:** 6.7_1
 - **linux_base-c6_64**
    - **Fixed:** 6.7_1
 - **linux_base-f10**

## Details
 - **published**: 2016-02-18T00:00:00Z
 - **modified**: 2016-02-18T00:00:00Z
 - **discovery**: 2016-02-16T00:00:00Z
 - **vid**: [2dd7e97e-d5e8-11e5-bcbd-bc5ff45d0f28](https://vuxml.freebsd.org/freebsd/2dd7e97e-d5e8-11e5-bcbd-bc5ff45d0f28.html)

## References
 - REPORT: [https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-7547](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-7547)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2015-7547](https://api.osv.dev/v1/vulns/CVE-2015-7547)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=207272](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=207272)
 - REPORT: [https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-7547](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-7547)
 - WEB: [https://blog.des.no/2016/02/freebsd-and-cve-2015-7547/](https://blog.des.no/2016/02/freebsd-and-cve-2015-7547/)
 - WEB: [https://googleonlinesecurity.blogspot.no/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html](https://googleonlinesecurity.blogspot.no/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html)
 - WEB: [https://sourceware.org/ml/libc-alpha/2016-02/msg00416.html](https://sourceware.org/ml/libc-alpha/2016-02/msg00416.html)
