# openssh -- command injection when X11Forwarding is enabled
The OpenSSH project reports:

> Missing sanitisation of untrusted input allows an authenticated user
> who is able to request X11 forwarding to inject commands to xauth(1).
>
> Injection of xauth commands grants the ability to read arbitrary files
> under the authenticated user\'s privilege, Other xauth commands allow
> limited information leakage, file overwrite, port probing and
> generally expose xauth(1), which was not written with a hostile user
> in mind, as an attack surface.
>
> Mitigation:
>
> Set X11Forwarding=no in sshd_config. This is the default.
>
> For authorized_keys that specify a \"command\" restriction, also set
> the \"restrict\" (available in OpenSSH \>=7.2) or
> \"no-x11-forwarding\" restrictions.


## Affected packages
 - **openssh-portable**
    - **Fixed:** 7.2.p2,1
 - **FreeBSD**
    - **Introduced:** 10.2
    - **Fixed:** 10.2_14
    - **Introduced:** 10.1
    - **Fixed:** 10.1_31
    - **Introduced:** 9.3
    - **Fixed:** 9.3_39

## Details
 - **published**: 2016-03-11T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2016-03-11T00:00:00Z
 - **vid**: [e4644df8-e7da-11e5-829d-c80aa9043978](https://vuxml.freebsd.org/freebsd/e4644df8-e7da-11e5-829d-c80aa9043978.html)

## References
 - REPORT: [http://www.openssh.com/txt/x11fwd.adv](http://www.openssh.com/txt/x11fwd.adv)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2016-3115](https://cveawg.mitre.org/api/cve/CVE-2016-3115)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-16:14.openssh.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-16:14.openssh.asc)
