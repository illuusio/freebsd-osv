# xen-kernel -- use after free in FIFO event channel code
The Xen Project reports:

> When the EVTCHNOP_init_control operation is called with a bad guest
> frame number, it takes an error path which frees a control structure
> without also clearing the corresponding pointer. Certain subsequent
> operations (EVTCHNOP_expand_array or another EVTCHNOP_init_control),
> upon finding the non-NULL pointer, continue operation assuming it
> points to allocated memory.
>
> A malicious guest administrator can crash the host, leading to a DoS.
> Arbitrary code execution (and therefore privilege escalation), and
> information leaks, cannot be excluded.


## Affected packages
 - **xen-kernel**
    - **Introduced:** 4.4
    - **Fixed:** 4.5

## Details
 - **published**: 2016-12-04T00:00:00Z
 - **modified**: 2016-12-04T00:00:00Z
 - **discovery**: 2016-09-08T00:00:00Z
 - **vid**: [4bf57137-ba4d-11e6-ae1b-002590263bf5](https://vuxml.freebsd.org/freebsd/4bf57137-ba4d-11e6-ae1b-002590263bf5.html)

## References
 - REPORT: [https://xenbits.xen.org/xsa/advisory-188.html](https://xenbits.xen.org/xsa/advisory-188.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2016-7154](https://cveawg.mitre.org/api/cve/CVE-2016-7154)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214936](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214936)
