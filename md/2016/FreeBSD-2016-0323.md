# FreeBSD -- Kernel stack disclosure in setlogin(2) / getlogin(2)
# Problem Description:

When setlogin(2) is called while setting up a new login session, the
login name is copied into an uninitialized stack buffer, which is then
copied into a buffer of the same size in the session structure. The
getlogin(2) system call returns the entire buffer rather than just the
portion occupied by the login name associated with the session.

# Impact:

An unprivileged user can access this memory by calling getlogin(2) and
reading beyond the terminating NUL character of the resulting string. Up
to 16 (FreeBSD 8) or 32 (FreeBSD 9 and 10) bytes of kernel memory may be
leaked in this manner for each invocation of setlogin(2).

This memory may contain sensitive information, such as portions of the
file cache or terminal buffers, which an attacker might leverage to
obtain elevated privileges.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 10.0
    - **Fixed:** 10.0_12
    - **Introduced:** 9.3
    - **Fixed:** 9.3_5
    - **Introduced:** 9.2
    - **Fixed:** 9.2_15
    - **Introduced:** 9.1
    - **Fixed:** 9.1_22
    - **Introduced:** 8.4
    - **Fixed:** 8.4_19

## Details
 - **published**: 2016-08-11T00:00:00Z
 - **modified**: 2016-08-11T00:00:00Z
 - **discovery**: 2014-11-04T00:00:00Z
 - **vid**: [74389f22-6007-11e6-a6c3-14dae9d210b8](https://vuxml.freebsd.org/freebsd/74389f22-6007-11e6-a6c3-14dae9d210b8.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2014-8476](https://api.osv.dev/v1/vulns/CVE-2014-8476)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-14:25.setlogin.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-14:25.setlogin.asc)
