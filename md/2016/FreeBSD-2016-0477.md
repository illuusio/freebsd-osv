# xen-kernel -- x86: Mishandling of SYSCALL singlestep during emulation
The Xen Project reports:

> The typical behaviour of singlestepping exceptions is determined at
> the start of the instruction, with a #DB trap being raised at the end
> of the instruction. SYSCALL (and SYSRET, although we don\'t implement
> it) behave differently because the typical behaviour allows userspace
> to escalate its privilege. (This difference in behaviour seems to be
> undocumented.) Xen wrongly raised the exception based on the flags at
> the start of the instruction.
>
> Guest userspace which can invoke the instruction emulator can use this
> flaw to escalate its privilege to that of the guest kernel.


## Affected packages
 - **xen-kernel**
    - **Fixed:** 4.7.1_2

## Details
 - **published**: 2016-12-20T00:00:00Z
 - **modified**: 2016-12-20T00:00:00Z
 - **discovery**: 2016-12-19T00:00:00Z
 - **vid**: [942433db-c661-11e6-ae1b-002590263bf5](https://vuxml.freebsd.org/freebsd/942433db-c661-11e6-ae1b-002590263bf5.html)

## References
 - REPORT: [http://xenbits.xen.org/xsa/advisory-204.html](http://xenbits.xen.org/xsa/advisory-204.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2016-10013](https://api.osv.dev/v1/vulns/CVE-2016-10013)
