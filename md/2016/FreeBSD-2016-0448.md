# xen-kernel -- x86: Mishandling of instruction pointer truncation during emulation
The Xen Project reports:

> When emulating HVM instructions, Xen uses a small i-cache for fetches
> from guest memory. The code that handles cache misses does not check
> if the address from which it fetched lies within the cache before
> blindly writing to it. As such it is possible for the guest to
> overwrite hypervisor memory.
>
> It is currently believed that the only way to trigger this bug is to
> use the way that Xen currently incorrectly wraps CS:IP in 16 bit
> modes. The included patch prevents such wrapping.
>
> A malicious HVM guest administrator can escalate their privilege to
> that of the host.


## Affected packages
 - **xen-kernel**
    - **Introduced:** 4.5.3
    - **Fixed:** 4.5.3
    - **Introduced:** 4.6.3
    - **Fixed:** 4.6.3
    - **Introduced:** 4.7.0
    - **Fixed:** 4.7.1

## Details
 - **published**: 2016-12-04T00:00:00Z
 - **modified**: 2016-12-04T00:00:00Z
 - **discovery**: 2016-09-08T00:00:00Z
 - **vid**: [49211361-ba4d-11e6-ae1b-002590263bf5](https://vuxml.freebsd.org/freebsd/49211361-ba4d-11e6-ae1b-002590263bf5.html)

## References
 - REPORT: [https://xenbits.xen.org/xsa/advisory-186.html](https://xenbits.xen.org/xsa/advisory-186.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2016-7093](https://cveawg.mitre.org/api/cve/CVE-2016-7093)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214936](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214936)
