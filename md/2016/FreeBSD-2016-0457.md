# xen-tools -- qemu incautious about shared ring processing
The Xen Project reports:

> The compiler can emit optimizations in qemu which can lead to double
> fetch vulnerabilities. Specifically data on the rings shared between
> qemu and the hypervisor (which the guest under control can obtain
> mappings of) can be fetched twice (during which time the guest can
> alter the contents) possibly leading to arbitrary code execution in
> qemu.
>
> Malicious administrators can exploit this vulnerability to take over
> the qemu process, elevating its privilege to that of the qemu process.
>
> In a system not using a device model stub domain (or other techniques
> for deprivileging qemu), malicious guest administrators can thus
> elevate their privilege to that of the host.


## Affected packages
 - **xen-tools**
    - **Fixed:** 4.7.1

## Details
 - **published**: 2016-12-04T00:00:00Z
 - **modified**: 2016-12-04T00:00:00Z
 - **discovery**: 2016-11-22T00:00:00Z
 - **vid**: [58685e23-ba4d-11e6-ae1b-002590263bf5](https://vuxml.freebsd.org/freebsd/58685e23-ba4d-11e6-ae1b-002590263bf5.html)

## References
 - REPORT: [https://xenbits.xen.org/xsa/advisory-197.html](https://xenbits.xen.org/xsa/advisory-197.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2016-9381](https://cveawg.mitre.org/api/cve/CVE-2016-9381)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214936](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214936)
