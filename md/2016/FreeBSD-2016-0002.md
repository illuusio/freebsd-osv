# qemu -- stack buffer overflow while parsing SCSI commands
Prasad J Pandit, Red Hat Product Security Team, reports:

> Qemu emulator built with the SCSI device emulation support is
> vulnerable to a stack buffer overflow issue. It could occur while
> parsing SCSI command descriptor block with an invalid operation code.
>
> A privileged(CAP_SYS_RAWIO) user inside guest could use this flaw to
> crash the Qemu instance resulting in DoS.


## Affected packages
 - **qemu**
    - **Fixed:** 2.4.0
 - **qemu-devel**
    - **Fixed:** 2.4.0
 - **qemu-sbruno**
    - **Fixed:** 2.4.50.g20150814
 - **qemu-user-static**
    - **Fixed:** 2.4.50.g20150814

## Details
 - **published**: 2016-01-01T00:00:00Z
 - **modified**: 2016-01-01T00:00:00Z
 - **discovery**: 2015-07-23T00:00:00Z
 - **vid**: [a267cd6c-b0c4-11e5-8d13-bc5ff45d0f28](https://vuxml.freebsd.org/freebsd/a267cd6c-b0c4-11e5-8d13-bc5ff45d0f28.html)

## References
 - REPORT: [http://openwall.com/lists/oss-security/2015/07/23/6](http://openwall.com/lists/oss-security/2015/07/23/6)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2015-5158](https://cveawg.mitre.org/api/cve/CVE-2015-5158)
 - WEB: [http://git.qemu.org/?p=qemu.git;a=commit;h=c170aad8b057223b1139d72e5ce7acceafab4fa9](http://git.qemu.org/?p=qemu.git;a=commit;h=c170aad8b057223b1139d72e5ce7acceafab4fa9)
 - WEB: [https://github.com/seanbruno/qemu-bsd-user/commit/c170aad8b057223b1139d72e5ce7acceafab4fa9](https://github.com/seanbruno/qemu-bsd-user/commit/c170aad8b057223b1139d72e5ce7acceafab4fa9)
