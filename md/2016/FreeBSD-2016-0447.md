# xen-kernel -- x86: Disallow L3 recursive pagetable for 32-bit PV guests
The Xen Project reports:

> On real hardware, a 32-bit PAE guest must leave the USER and RW bit
> clear in L3 pagetable entries, but the pagetable walk behaves as if
> they were set. (The L3 entries are cached in processor registers, and
> don\'t actually form part of the pagewalk.)
>
> When running a 32-bit PV guest on a 64-bit Xen, Xen must always OR in
> the USER and RW bits for L3 updates for the guest to observe
> architectural behaviour. This is unsafe in combination with recursive
> pagetables.
>
> As there is no way to construct an L3 recursive pagetable in native
> 32-bit PAE mode, disallow this option in 32-bit PV guests.
>
> A malicious 32-bit PV guest administrator can escalate their privilege
> to that of the host.


## Affected packages
 - **xen-kernel**
    - **Fixed:** 4.7.1

## Details
 - **published**: 2016-12-04T00:00:00Z
 - **modified**: 2016-12-04T00:00:00Z
 - **discovery**: 2016-09-08T00:00:00Z
 - **vid**: [45ca25b5-ba4d-11e6-ae1b-002590263bf5](https://vuxml.freebsd.org/freebsd/45ca25b5-ba4d-11e6-ae1b-002590263bf5.html)

## References
 - REPORT: [https://xenbits.xen.org/xsa/advisory-185.html](https://xenbits.xen.org/xsa/advisory-185.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2016-7092](https://cveawg.mitre.org/api/cve/CVE-2016-7092)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214936](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214936)
