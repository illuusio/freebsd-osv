# xen-kernel -- x86: Missing SMAP whitelisting in 32-bit exception / event delivery
The Xen Project reports:

> Supervisor Mode Access Prevention is a hardware feature designed to
> make an Operating System more robust, by raising a pagefault rather
> than accidentally following a pointer into userspace. However,
> legitimate accesses into userspace require whitelisting, and the
> exception delivery mechanism for 32bit PV guests wasn\'t whitelisted.
>
> A malicious 32-bit PV guest kernel can trigger a safety check,
> crashing the hypervisor and causing a denial of service to other VMs
> on the host.


## Affected packages
 - **xen-kernel**
    - **Introduced:** 4.5,1
    - **Fixed:** 4.7.0_3

## Details
 - **published**: 2016-08-02T00:00:00Z
 - **modified**: 2016-08-02T00:00:00Z
 - **discovery**: 2016-07-26T00:00:00Z
 - **vid**: [04cf89e3-5854-11e6-b334-002590263bf5](https://vuxml.freebsd.org/freebsd/04cf89e3-5854-11e6-b334-002590263bf5.html)

## References
 - REPORT: [http://xenbits.xen.org/xsa/advisory-183.html](http://xenbits.xen.org/xsa/advisory-183.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2016-6259](https://api.osv.dev/v1/vulns/CVE-2016-6259)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=211482](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=211482)
