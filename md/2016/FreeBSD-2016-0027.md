# xen-tools -- libxl leak of pv kernel and initrd on error
The Xen Project reports:

> When constructing a guest which is configured to use a PV bootloader
> which runs as a userspace process in the toolstack domain (e.g.
> pygrub) libxl creates a mapping of the files to be used as kernel and
> initial ramdisk when building the guest domain.
>
> However if building the domain subsequently fails these mappings would
> not be released leading to a leak of virtual address space in the
> calling process, as well as preventing the recovery of the temporary
> disk files containing the kernel and initial ramdisk.
>
> For toolstacks which manage multiple domains within the same process,
> an attacker who is able to repeatedly start a suitable domain (or many
> such domains) can cause an out-of-memory condition in the toolstack
> process, leading to a denial of service.
>
> Under the same circumstances an attacker can also cause files to
> accumulate on the toolstack domain filesystem (usually under /var in
> dom0) used to temporarily store the kernel and initial ramdisk,
> perhaps leading to a denial of service against arbitrary other
> services using that filesystem.


## Affected packages
 - **xen-tools**
    - **Introduced:** 4.1
    - **Fixed:** 4.5.2_1

## Details
 - **published**: 2016-01-06T00:00:00Z
 - **modified**: 2016-01-06T00:00:00Z
 - **discovery**: 2015-12-08T00:00:00Z
 - **vid**: [5d1d4473-b40d-11e5-9728-002590263bf5](https://vuxml.freebsd.org/freebsd/5d1d4473-b40d-11e5-9728-002590263bf5.html)

## References
 - REPORT: [http://xenbits.xen.org/xsa/advisory-160.html](http://xenbits.xen.org/xsa/advisory-160.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2015-8341](https://cveawg.mitre.org/api/cve/CVE-2015-8341)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=205841](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=205841)
