# FreeBSD -- Resource exhaustion in TCP reassembly
# Problem Description:

There is a mistake with the introduction of VNET, which converted the
global limit on the number of segments that could belong to reassembly
queues into a per-VNET limit. Because mbufs are allocated from a global
pool, in the presence of a sufficient number of VNETs, the total number
of mbufs attached to reassembly queues can grow to the total number of
mbufs in the system, at which point all network traffic would cease.

# Impact:

An attacker who can establish concurrent TCP connections across a
sufficient number of VNETs and manipulate the inbound packet streams
such that the maximum number of mbufs are enqueued on each reassembly
queue can cause mbuf cluster exhaustion on the target system, resulting
in a Denial of Service condition.

As the default per-VNET limit on the number of segments that can belong
to reassembly queues is 1/16 of the total number of mbuf clusters in the
system, only systems that have 16 or more VNET instances are vulnerable.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 10.1
    - **Fixed:** 10.1_16
    - **Introduced:** 9.3
    - **Fixed:** 9.3_21
    - **Introduced:** 8.4
    - **Fixed:** 8.4_35

## Details
 - **published**: 2016-08-11T00:00:00Z
 - **modified**: 2016-08-11T00:00:00Z
 - **discovery**: 2015-07-28T00:00:00Z
 - **vid**: [0cb9d5bb-600a-11e6-a6c3-14dae9d210b8](https://vuxml.freebsd.org/freebsd/0cb9d5bb-600a-11e6-a6c3-14dae9d210b8.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2015-1417](https://api.osv.dev/v1/vulns/CVE-2015-1417)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-15:15.tcp.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-15:15.tcp.asc)
