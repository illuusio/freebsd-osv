# PHP5 -- memory corruption in openssl_x509_parse()
Stefan Esser reports:

> The PHP function openssl_x509_parse() uses a helper function called
> asn1_time_to_time_t() to convert timestamps from ASN1 string format
> into integer timestamp values. The parser within this helper function
> is not binary safe and can therefore be tricked to write up to five
> NUL bytes outside of an allocated buffer.
>
> This problem can be triggered by x509 certificates that contain NUL
> bytes in their notBefore and notAfter timestamp fields and leads to a
> memory corruption that might result in arbitrary code execution.
>
> Depending on how openssl_x509_parse() is used within a PHP application
> the attack requires either a malicious cert signed by a
> compromised/malicious CA or can be carried out with a self-signed
> cert.


## Affected packages
 - **php5**
    - **Introduced:** 5.4.0
    - **Fixed:** 5.4.23
 - **php53**
    - **Fixed:** 5.3.28
 - **php55**
    - **Introduced:** 5.5.0
    - **Fixed:** 5.5.7

## Details
 - **published**: 2013-12-14T00:00:00Z
 - **modified**: 2013-12-14T00:00:00Z
 - **discovery**: 2013-12-13T00:00:00Z
 - **vid**: [47b4e713-6513-11e3-868f-0025905a4771](https://vuxml.freebsd.org/freebsd/47b4e713-6513-11e3-868f-0025905a4771.html)

## References
 - REPORT: [https://www.sektioneins.de/advisories/advisory-012013-php-openssl_x509_parse-memory-corruption-vulnerability.html](https://www.sektioneins.de/advisories/advisory-012013-php-openssl_x509_parse-memory-corruption-vulnerability.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2013-6420](https://cveawg.mitre.org/api/cve/CVE-2013-6420)
