# FreeBSD -- Insufficient credential checks in network ioctl(2)
Problem Description:

As is commonly the case, the IPv6 and ATM network layer ioctl request
handlers are written in such a way that an unrecognized request is
passed on unmodified to the link layer, which will either handle it or
return an error code.

Network interface drivers, however, assume that the SIOCSIFADDR,
SIOCSIFBRDADDR, SIOCSIFDSTADDR and SIOCSIFNETMASK requests have been
handled at the network layer, and therefore do not perform input
validation or verify the caller\'s credentials. Typical link-layer
actions for these requests may include marking the interface as \"up\"
and resetting the underlying hardware.

Impact:

An unprivileged user with the ability to run arbitrary code can cause
any network interface in the system to perform the link layer actions
associated with a SIOCSIFADDR, SIOCSIFBRDADDR, SIOCSIFDSTADDR or
SIOCSIFNETMASK ioctl request; or trigger a kernel panic by passing a
specially crafted address structure which causes a network interface
driver to dereference an invalid pointer.

Although this has not been confirmed, the possibility that an attacker
may be able to execute arbitrary code in kernel context cannot be ruled
out.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 9.1
    - **Fixed:** 9.1_7
    - **Introduced:** 8.4
    - **Fixed:** 8.4_4
    - **Introduced:** 8.3
    - **Fixed:** 8.3_11

## Details
 - **published**: 2013-09-19T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2013-09-10T00:00:00Z
 - **vid**: [4d87d357-202c-11e3-be06-000c29ee3065](https://vuxml.freebsd.org/freebsd/4d87d357-202c-11e3-be06-000c29ee3065.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2013-5691](https://api.osv.dev/v1/vulns/CVE-2013-5691)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-13:12.ifioctl.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-13:12.ifioctl.asc)
