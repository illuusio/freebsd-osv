# FreeBSD -- Integer overflow in libnv
# Problem Description:

A malicious value of size in a structure of packed libnv can cause an
integer overflow, leading to the allocation of a smaller buffer than
required for the parsed data. The introduced check was incorrect, as it
took into account the size of the pointer, not the structure. This
vulnerability affects both kernel and userland.

This issue was originally intended to be addressed as part of
FreeBSD-SA-24:09.libnv, but due to a logic issue, this issue was not
properly addressed.

# Impact:

It is possible for an attacker to overwrite portions of memory (in
userland or the kernel) as the allocated buffer might be smaller than
the data received from a malicious process. This vulnerability could
result in privilege escalation or cause a system panic.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 14.1
    - **Fixed:** 14.1_5
    - **Introduced:** 14.0
    - **Fixed:** 14.0_11
    - **Introduced:** 13.4
    - **Fixed:** 13.4_1
    - **Introduced:** 13.3
    - **Fixed:** 13.3_7
 - **FreeBSD**
    - **Introduced:** 14.1
    - **Fixed:** 14.1_5
    - **Introduced:** 14.0
    - **Fixed:** 14.0_11
    - **Introduced:** 13.4
    - **Fixed:** 13.4_1
    - **Introduced:** 13.3
    - **Fixed:** 13.3_7

## Details
 - **published**: 2024-09-20T00:00:00Z
 - **modified**: 2024-09-20T00:00:00Z
 - **discovery**: 2024-09-19T00:00:00Z
 - **vid**: [93c12fe5-7716-11ef-9a62-002590c1f29c](https://vuxml.freebsd.org/freebsd/93c12fe5-7716-11ef-9a62-002590c1f29c.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2024-45287](https://cveawg.mitre.org/api/cve/CVE-2024-45287)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:16.libnv.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:16.libnv.asc)
