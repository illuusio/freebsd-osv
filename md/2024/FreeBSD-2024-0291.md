# PostgreSQL -- PostgreSQL row security below e.g. subqueries disregards user ID changes
PostgreSQL project reports:

> Incomplete tracking in PostgreSQL of tables with row security allows a
> reused query to view or change different rows from those intended.
> CVE-2023-2455 and CVE-2016-2193 fixed most interaction between row
> security and user ID changes. They missed cases where a subquery, WITH
> query, security invoker view, or SQL-language function references a
> table with a row-level security policy. This has the same consequences
> as the two earlier CVEs. That is to say, it leads to potentially
> incorrect policies being applied in cases where role-specific policies
> are used and a given query is planned under one role and then executed
> under other roles. This scenario can happen under security definer
> functions or when a common user and query is planned initially and
> then re-used across multiple SET ROLEs. Applying an incorrect policy
> may permit a user to complete otherwise-forbidden reads and
> modifications. This affects only databases that have used CREATE
> POLICY to define a row security policy. An attacker must tailor an
> attack to a particular application\'s pattern of query plan reuse,
> user ID changes, and role-specific row security policies.


## Affected packages
 - **postgresql17-server**
    - **Fixed:** 17.1
 - **postgresql16-server**
    - **Fixed:** 16.5
 - **postgresql15-server**
    - **Fixed:** 15.9
 - **postgresql14-server**
    - **Fixed:** 14.14
 - **postgresql13-server**
    - **Fixed:** 13.17
 - **postgresql12-server**
    - **Fixed:** 12.21

## Details
 - **published**: 2024-11-14T00:00:00Z
 - **modified**: 2024-11-14T00:00:00Z
 - **discovery**: 2024-11-14T00:00:00Z
 - **vid**: [3831292b-a29d-11ef-af48-6cc21735f730](https://vuxml.freebsd.org/freebsd/3831292b-a29d-11ef-af48-6cc21735f730.html)

## References
 - REPORT: [https://www.postgresql.org/support/security/CVE-2024-10976/](https://www.postgresql.org/support/security/CVE-2024-10976/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-10976](https://api.osv.dev/v1/vulns/CVE-2024-10976)
