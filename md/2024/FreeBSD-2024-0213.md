# FreeBSD -- bhyve(8) privileged guest escape via USB controller
# Problem Description:

bhyve can be configured to emulate devices on a virtual USB controller
(XHCI), such as USB tablet devices. An insufficient boundary validation
in the USB code could lead to an out-of-bounds write on the heap, with
data controlled by the caller.

# Impact:

A malicious, privileged software running in a guest VM can exploit the
vulnerability to achieve code execution on the host in the bhyve
userspace process, which typically runs as root. Note that bhyve runs in
a Capsicum sandbox, so malicious code is constrained by the capabilities
available to the bhyve process.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 14.1
    - **Fixed:** 14.1_4
    - **Introduced:** 14.0
    - **Fixed:** 14.0_10
    - **Introduced:** 13.3
    - **Fixed:** 13.3_6

## Details
 - **published**: 2024-09-05T00:00:00Z
 - **modified**: 2024-09-05T00:00:00Z
 - **discovery**: 2024-09-04T00:00:00Z
 - **vid**: [4edaa9f4-6b51-11ef-9a62-002590c1f29c](https://vuxml.freebsd.org/freebsd/4edaa9f4-6b51-11ef-9a62-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-32668](https://api.osv.dev/v1/vulns/CVE-2024-32668)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:12.bhyve.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:12.bhyve.asc)
