# postgresql-server -- non-owner REFRESH MATERIALIZED VIEW CONCURRENTLY executes arbitrary SQL
PostgreSQL Project reports:

> One step of a concurrent refresh command was run under weak security
> restrictions. If a materialized view\'s owner could persuade a
> superuser or other high-privileged user to perform a concurrent
> refresh on that view, the view\'s owner could control code executed
> with the privileges of the user running REFRESH. The fix for the
> vulnerability makes is so that all user-determined code is run as the
> view\'s owner, as expected.


## Affected packages
 - **postgresql-server**
    - **Fixed:** 15.6
    - **Fixed:** 14.11
    - **Fixed:** 13.14
    - **Fixed:** 12.18

## Details
 - **published**: 2024-02-08T00:00:00Z
 - **modified**: 2024-02-08T00:00:00Z
 - **discovery**: 2024-02-08T00:00:00Z
 - **vid**: [19e6dd1b-c6a5-11ee-9cd0-6cc21735f730](https://vuxml.freebsd.org/freebsd/19e6dd1b-c6a5-11ee-9cd0-6cc21735f730.html)

## References
 - REPORT: [https://www.postgresql.org/support/security/CVE-2024-0985/](https://www.postgresql.org/support/security/CVE-2024-0985/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-0985](https://api.osv.dev/v1/vulns/CVE-2024-0985)
 - WEB: [https://www.postgresql.org/support/security/CVE-2024-0985/](https://www.postgresql.org/support/security/CVE-2024-0985/)
