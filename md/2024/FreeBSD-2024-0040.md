# DNSSEC validators -- denial-of-service/CPU exhaustion from KeyTrap and NSEC3 vulnerabilities
Simon Kelley reports:

> If DNSSEC validation is enabled, then an attacker who can force a DNS
> server to validate a specially crafted signed domain can use a lot of
> CPU in the validator. This only affects dnsmasq installations with
> DNSSEC enabled.

Stichting NLnet Labs reports:

> The KeyTrap \[CVE-2023-50387\] vulnerability works by using a
> combination of Keys (also colliding Keys), Signatures and number of
> RRSETs on a malicious zone. Answers from that zone can force a DNSSEC
> validator down a very CPU intensive and time costly validation path.
>
> The NSEC3 \[CVE-2023-50868\] vulnerability uses specially crafted
> responses on a malicious zone with multiple NSEC3 RRSETs to force a
> DNSSEC validator down a very CPU intensive and time costly NSEC3 hash
> calculation path.


## Affected packages
 - **bind916**
    - **Fixed:** 9.16.48
 - **bind918**
    - **Fixed:** 9.18.24
 - **bind9-devel**
    - **Fixed:** 9.19.21
 - **dnsmasq**
    - **Fixed:** 2.90
 - **dnsmasq-devel**
    - **Fixed:** 2.90
 - **powerdns-recursor**
    - **Fixed:** 5.0.2
 - **unbound**
    - **Fixed:** 1.19.1
 - **FreeBSD**
    - **Introduced:** 14.0
    - **Fixed:** 14.0_6
    - **Introduced:** 13.2
    - **Fixed:** 13.2_11

## Details
 - **published**: 2024-02-13T00:00:00Z
 - **modified**: 2024-04-01T00:00:00Z
 - **discovery**: 2024-02-06T00:00:00Z
 - **vid**: [21a854cc-cac1-11ee-b7a7-353f1e043d9a](https://vuxml.freebsd.org/freebsd/21a854cc-cac1-11ee-b7a7-353f1e043d9a.html)

## References
 - REPORT: [https://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2024q1/017430.html](https://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2024q1/017430.html)
 - REPORT: [https://nlnetlabs.nl/news/2024/Feb/13/unbound-1.19.1-released/](https://nlnetlabs.nl/news/2024/Feb/13/unbound-1.19.1-released/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-50387](https://api.osv.dev/v1/vulns/CVE-2023-50387)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-50868](https://api.osv.dev/v1/vulns/CVE-2023-50868)
 - WEB: [https://kb.isc.org/docs/cve-2023-50387](https://kb.isc.org/docs/cve-2023-50387)
 - WEB: [https://kb.isc.org/docs/cve-2023-50868](https://kb.isc.org/docs/cve-2023-50868)
 - WEB: [https://blog.powerdns.com/2024/02/13/powerdns-recursor-4-8-6-4-9-3-5-0-2-released](https://blog.powerdns.com/2024/02/13/powerdns-recursor-4-8-6-4-9-3-5-0-2-released)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:03.unbound.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:03.unbound.asc)
