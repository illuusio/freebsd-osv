# Apache Tomcat -- RCE due to TOCTOU issue in JSP compilation
security@apache.org reports:

> Time-of-check Time-of-use (TOCTOU) Race Condition The mitigation for
> CVE-2024-50379 was incomplete. Users running Tomcat on a case
> insensitive file system with the default servlet write enabled
> (readonly initialisation parameter set to the non-default value of
> false) may need additional configuration to fully mitigate
> CVE-2024-50379 depending on which version of Java they are using with
> Tomcat: - running on Java 8 or Java 11: the system
> propertysun.io.useCanonCaches must be explicitly set to false (it
> defaults to true) - running on Java 17: thesystem property
> sun.io.useCanonCaches, if set, must be set to false(it defaults to
> false) - running on Java 21 onwards: no further configuration is
> required(the system property and the problematic cache have been
> removed) Tomcat 11.0.3, 10.1.35 and 9.0.99 onwards will include checks
> thatsun.io.useCanonCaches is set appropriately before allowing the
> default servlet to be write enabled on a case insensitive file system.
> Tomcat will also setsun.io.useCanonCaches to false by default where it
> can.


## Affected packages
 - **tomcat110**
    - **Introduced:** 11.0.0,1
    - **Fixed:** 11.0.1
 - **tomcat101**
    - **Introduced:** 10.1.0,1
    - **Fixed:** 10.1.33
 - **tomcat9**
    - **Introduced:** 9.0.0,1
    - **Fixed:** 9.0.97

## Details
 - **published**: 2024-12-29T00:00:00Z
 - **modified**: 2024-12-29T00:00:00Z
 - **discovery**: 2024-12-20T00:00:00Z
 - **vid**: [ed0a052a-c5e6-11ef-a457-b42e991fc52e](https://vuxml.freebsd.org/freebsd/ed0a052a-c5e6-11ef-a457-b42e991fc52e.html)

## References
 - REPORT: [https://lists.apache.org/thread/b2b9qrgjrz1kvo4ym8y2wkfdvwoq6qbp](https://lists.apache.org/thread/b2b9qrgjrz1kvo4ym8y2wkfdvwoq6qbp)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-56337](https://api.osv.dev/v1/vulns/CVE-2024-56337)
 - ADVISORY: [https://nvd.nist.gov/vuln/detail/CVE-2024-56337](https://nvd.nist.gov/vuln/detail/CVE-2024-56337)
