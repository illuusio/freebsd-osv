# FreeBSD -- umtx Kernel panic or Use-After-Free
# Problem Description:

Concurrent removals of such a mapping by using the UMTX_SHM_DESTROY
sub-request of UMTX_OP_SHM can lead to decreasing the reference count of
the object representing the mapping too many times, causing it to be
freed too early.

# Impact:

A malicious code exercizing the UMTX_SHM_DESTROY sub-request in parallel
can panic the kernel or enable further Use-After-Free attacks,
potentially including code execution or Capsicum sandbox escape.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 14.1
    - **Fixed:** 14.1_4
    - **Introduced:** 14.0
    - **Fixed:** 14.0_10
    - **Introduced:** 13.3
    - **Fixed:** 13.3_6

## Details
 - **published**: 2024-09-05T00:00:00Z
 - **modified**: 2024-09-05T00:00:00Z
 - **discovery**: 2024-09-04T00:00:00Z
 - **vid**: [7e079ce2-6b51-11ef-9a62-002590c1f29c](https://vuxml.freebsd.org/freebsd/7e079ce2-6b51-11ef-9a62-002590c1f29c.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2024-43102](https://cveawg.mitre.org/api/cve/CVE-2024-43102)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:14.umtx.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:14.umtx.asc)
