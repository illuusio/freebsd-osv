# FreeBSD -- ktrace(2) fails to detach when executing a setuid binary
# Problem Description:

A logic bug in the code which disables kernel tracing for setuid
programs meant that tracing was not disabled when it should have,
allowing unprivileged users to trace and inspect the behavior of setuid
programs.

# Impact:

The bug may be used by an unprivileged user to read the contents of
files to which they would not otherwise have access, such as the local
password database.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 14.1
    - **Fixed:** 14.1_3
    - **Introduced:** 14.0
    - **Fixed:** 14.0_9
    - **Introduced:** 13.3
    - **Fixed:** 13.3_5

## Details
 - **published**: 2024-09-20T00:00:00Z
 - **modified**: 2024-09-20T00:00:00Z
 - **discovery**: 2024-08-07T00:00:00Z
 - **vid**: [8fb61d94-771b-11ef-9a62-002590c1f29c](https://vuxml.freebsd.org/freebsd/8fb61d94-771b-11ef-9a62-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-6760](https://api.osv.dev/v1/vulns/CVE-2024-6760)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:06.ktrace.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:06.ktrace.asc)
