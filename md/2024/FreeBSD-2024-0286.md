# FreeBSD -- Multiple issues in the bhyve hypervisor
# Problem Description:

Several vulnerabilities were found in the bhyve hypervisor\'s device
models.

The NVMe driver function nvme_opc_get_log_page is vulnerable to a buffer
over- read from a guest-controlled value. (CVE-2024-51562)

The virtio_vq_recordon function is subject to a time-of-check to
time-of-use (TOCTOU) race condition. (CVE-2024-51563)

A guest can trigger an infinite loop in the hda audio driver.
(CVE-2024-51564)

The hda driver is vulnerable to a buffer over-read from a
guest-controlled value. (CVE-2024-51565)

The NVMe driver queue processing is vulernable to guest-induced infinite
loops. (CVE-2024-51566)

# Impact:

Malicious guest virtual machines may be able to perform a denial of
service (DoS) of the bhyve host, and may read memory within the bhyve
process that they should not be able to access.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 14.1
    - **Fixed:** 14.1_6
    - **Introduced:** 13.4
    - **Fixed:** 13.4_2
    - **Introduced:** 13.3
    - **Fixed:** 13.3_8

## Details
 - **published**: 2024-11-13T00:00:00Z
 - **modified**: 2024-11-13T00:00:00Z
 - **discovery**: 2024-10-29T00:00:00Z
 - **vid**: [eb5c615d-a173-11ef-9a62-002590c1f29c](https://vuxml.freebsd.org/freebsd/eb5c615d-a173-11ef-9a62-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-51562](https://api.osv.dev/v1/vulns/CVE-2024-51562)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-51563](https://api.osv.dev/v1/vulns/CVE-2024-51563)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-51564](https://api.osv.dev/v1/vulns/CVE-2024-51564)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-51565](https://api.osv.dev/v1/vulns/CVE-2024-51565)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-51566](https://api.osv.dev/v1/vulns/CVE-2024-51566)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:17.bhyve.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:17.bhyve.asc)
