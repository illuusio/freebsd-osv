# OpenSSH -- Pre-authentication async signal safety issue
The FreeBSD Project reports:

> A signal handler in sshd(8) may call a logging function that is not
> async- signal-safe. The signal handler is invoked when a client does
> not authenticate within the LoginGraceTime seconds (120 by default).
> This signal handler executes in the context of the sshd(8)\'s
> privileged code, which is not sandboxed and runs with full root
> privileges.
>
> This issue is another instance of the problem in CVE-2024-6387
> addressed by FreeBSD-SA-24:04.openssh. The faulty code in this case is
> from the integration of blacklistd in OpenSSH in FreeBSD.


## Affected packages
 - **openssh-portable**
    - **Fixed:** 9.8.p1_1,1
 - **FreeBSD**
    - **Introduced:** 14.1
    - **Fixed:** 14.1_3
    - **Introduced:** 14.0
    - **Fixed:** 14.0_9
    - **Introduced:** 13.3
    - **Fixed:** 13.3_5

## Details
 - **published**: 2024-09-15T00:00:00Z
 - **modified**: 2024-09-20T00:00:00Z
 - **discovery**: 2024-08-06T00:00:00Z
 - **vid**: [58750d49-7302-11ef-8c95-195d300202b3](https://vuxml.freebsd.org/freebsd/58750d49-7302-11ef-8c95-195d300202b3.html)

## References
 - REPORT: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:08.openssh.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:08.openssh.asc)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2024-7589](https://cveawg.mitre.org/api/cve/CVE-2024-7589)
 - ADVISORY: [https://nvd.nist.gov/vuln/detail/CVE-2024-7589](https://nvd.nist.gov/vuln/detail/CVE-2024-7589)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:08.openssh.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:08.openssh.asc)
