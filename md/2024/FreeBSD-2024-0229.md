# SnappyMail -- multiple mXSS in HTML sanitizer
Oskar reports:

> SnappyMail uses the \`cleanHtml()\` function to cleanup HTML and CSS
> in emails. Research discovered that the function has a few bugs which
> cause an mXSS exploit. Because the function allowed too many (invalid)
> HTML elements, it was possible (with incorrect markup) to trick the
> browser to \"fix\" the broken markup into valid markup. As a result a
> motivated attacker may be able to inject javascript.


## Affected packages
 - **snappymail-php81**
    - **Fixed:** 2.38.0
 - **snappymail-php82**
    - **Fixed:** 2.38.0
 - **snappymail-php83**
    - **Fixed:** 2.38.0
 - **snappymail-php84**
    - **Fixed:** 2.38.0

## Details
 - **published**: 2024-09-16T00:00:00Z
 - **modified**: 2024-09-16T00:00:00Z
 - **discovery**: 2024-09-16T00:00:00Z
 - **vid**: [bd940aba-7467-11ef-a5c4-08002784c58d](https://vuxml.freebsd.org/freebsd/bd940aba-7467-11ef-a5c4-08002784c58d.html)

## References
 - REPORT: [https://github.com/the-djmaze/snappymail/security/advisories/GHSA-2rq7-79vp-ffxm](https://github.com/the-djmaze/snappymail/security/advisories/GHSA-2rq7-79vp-ffxm)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-45800](https://api.osv.dev/v1/vulns/CVE-2024-45800)
 - WEB: [https://github.com/the-djmaze/snappymail/security/advisories/GHSA-2rq7-79vp-ffxm](https://github.com/the-djmaze/snappymail/security/advisories/GHSA-2rq7-79vp-ffxm)
