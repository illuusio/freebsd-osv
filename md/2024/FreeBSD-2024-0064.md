# Grafana -- Data source permission escalation
Grafana Labs reports:

> The vulnerability impacts Grafana Cloud and Grafana Enterprise
> instances, and it is exploitable if a user who should not be able to
> access all data sources is granted permissions to create a data
> source.
>
> By default, only organization Administrators are allowed to create a
> data source and have full access to all data sources. All other users
> need to be explicitly granted permission to create a data source,
> which then means they could exploit this vulnerability.
>
> When a user creates a data source via the
> [API](https://grafana.com/docs/grafana/latest/developers/http_api/data_source/#create-a-data-source),
> they can specify data source UID. If the UID is set to an asterisk
> (\*), the user gains permissions to query, update, and delete all data
> sources in the organization. The exploit, however, does not stretch
> across organizations --- to exploit the vulnerability in several
> organizations, a user would need permissions to create data sources in
> each organization.
>
> The vulnerability comes from a lack of UID validation. When evaluating
> permissions, we interpret an asterisk (\*) as a wild card for all
> resources. Therefore, we should treat it as a reserved value, and not
> allow the creation of a resource with the UID set to an asterisk.
>
> The CVSS score for this vulnerability is [6
> Medium](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L&version=3.1).


## Affected packages
 - **grafana**
    - **Introduced:** 8.5.0
    - **Fixed:** 9.5.17
    - **Introduced:** 10.0.0
    - **Fixed:** 10.0.12
    - **Introduced:** 10.1.0
    - **Fixed:** 10.1.8
    - **Introduced:** 10.2.0
    - **Fixed:** 10.2.5
    - **Introduced:** 10.3.0
    - **Fixed:** 10.3.4
 - **grafana9**
    - **Fixed:** 9.5.17

## Details
 - **published**: 2024-03-11T00:00:00Z
 - **modified**: 2024-03-26T00:00:00Z
 - **discovery**: 2024-02-12T00:00:00Z
 - **vid**: [6d31ef38-df85-11ee-abf1-6c3be5272acd](https://vuxml.freebsd.org/freebsd/6d31ef38-df85-11ee-abf1-6c3be5272acd.html)

## References
 - REPORT: [https://grafana.com/blog/2024/03/07/grafana-security-release-medium-severity-security-fix-for-cve-2024-1442/](https://grafana.com/blog/2024/03/07/grafana-security-release-medium-severity-security-fix-for-cve-2024-1442/)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2024-1442](https://cveawg.mitre.org/api/cve/CVE-2024-1442)
 - WEB: [https://grafana.com/security/security-advisories/cve-2024-1442/](https://grafana.com/security/security-advisories/cve-2024-1442/)
