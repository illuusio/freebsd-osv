# FreeBSD -- bhyve(8) out-of-bounds read access via XHCI emulation
# Problem Description:

bhyve can be configured to emulate devices on a virtual USB controller
(XHCI), such as USB tablet devices. An insufficient boundary validation
in the USB code could lead to an out-of-bounds read on the heap, which
could potentially lead to an arbitrary write and remote code execution.

# Impact:

A malicious, privileged software running in a guest VM can exploit the
vulnerability to crash the hypervisor process or potentially achieve
code execution on the host in the bhyve userspace process, which
typically runs as root. Note that bhyve runs in a Capsicum sandbox, so
malicious code is constrained by the capabilities available to the bhyve
process.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 14.1
    - **Fixed:** 14.1_5
    - **Introduced:** 14.0
    - **Fixed:** 14.0_11
    - **Introduced:** 13.4
    - **Fixed:** 13.4_1
    - **Introduced:** 13.3
    - **Fixed:** 13.3_7

## Details
 - **published**: 2024-09-20T00:00:00Z
 - **modified**: 2024-09-20T00:00:00Z
 - **discovery**: 2024-09-19T00:00:00Z
 - **vid**: [1febd09b-7716-11ef-9a62-002590c1f29c](https://vuxml.freebsd.org/freebsd/1febd09b-7716-11ef-9a62-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2024-41721](https://api.osv.dev/v1/vulns/CVE-2024-41721)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-24:15.bhyve.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-24:15.bhyve.asc)
