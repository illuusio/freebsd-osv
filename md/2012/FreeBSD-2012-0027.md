# apache -- multiple vulnerabilities
CVE MITRE reports:

> An exposure was found when using mod_proxy in reverse proxy mode. In
> certain configurations using RewriteRule with proxy flag or
> ProxyPassMatch, a remote attacker could cause the reverse proxy to
> connect to an arbitrary server, possibly disclosing sensitive
> information from internal web servers not directly accessible to
> attacker.
>
> Integer overflow in the ap_pregsub function in server/util.c in the
> Apache HTTP Server 2.0.x through 2.0.64 and 2.2.x through 2.2.21, when
> the mod_setenvif module is enabled, allows local users to gain
> privileges via a .htaccess file with a crafted SetEnvIf directive, in
> conjunction with a crafted HTTP request header, leading to a
> heap-based buffer overflow.
>
> An additional exposure was found when using mod_proxy in reverse proxy
> mode. In certain configurations using RewriteRule with proxy flag or
> ProxyPassMatch, a remote attacker could cause the reverse proxy to
> connect to an arbitrary server, possibly disclosing sensitive
> information from internal web servers not directly accessible to
> attacker.
>
> A flaw was found in mod_log_config. If the \'%{cookiename}C\' log
> format string is in use, a remote attacker could send a specific
> cookie causing a crash. This crash would only be a denial of service
> if using a threaded MPM.
>
> A flaw was found in the handling of the scoreboard. An unprivileged
> child process could cause the parent process to crash at shutdown
> rather than terminate cleanly.
>
> A flaw was found in the default error response for status code 400.
> This flaw could be used by an attacker to expose \"httpOnly\" cookies
> when no custom ErrorDocument is specified.


## Affected packages
 - **apache**
    - **Introduced:** 2.*,1
    - **Fixed:** 2.2.22

## Details
 - **published**: 2012-01-31T00:00:00Z
 - **modified**: 2012-01-31T00:00:00Z
 - **discovery**: 2011-10-05T00:00:00Z
 - **vid**: [4b7dbfab-4c6b-11e1-bc16-0023ae8e59f0](https://vuxml.freebsd.org/freebsd/4b7dbfab-4c6b-11e1-bc16-0023ae8e59f0.html)

## References
 - REPORT: [http://httpd.apache.org/security/vulnerabilities_22.html](http://httpd.apache.org/security/vulnerabilities_22.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2011-3368](https://cveawg.mitre.org/api/cve/CVE-2011-3368)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2011-3607](https://cveawg.mitre.org/api/cve/CVE-2011-3607)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2011-4317](https://cveawg.mitre.org/api/cve/CVE-2011-4317)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2012-0021](https://cveawg.mitre.org/api/cve/CVE-2012-0021)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2012-0031](https://cveawg.mitre.org/api/cve/CVE-2012-0031)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2012-0053](https://cveawg.mitre.org/api/cve/CVE-2012-0053)
