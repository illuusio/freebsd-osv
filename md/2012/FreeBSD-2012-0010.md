# Multiple implementations -- DoS via hash algorithm collision
oCERT reports:

> A variety of programming languages suffer from a denial-of-service
> (DoS) condition against storage functions of key/value pairs in hash
> data structures, the condition can be leveraged by exploiting
> predictable collisions in the underlying hashing algorithms.
>
> The issue finds particular exposure in web server applications and/or
> frameworks. In particular, the lack of sufficient limits for the
> number of parameters in POST requests in conjunction with the
> predictable collision properties in the hashing functions of the
> underlying languages can render web applications vulnerable to the DoS
> condition. The attacker, using specially crafted HTTP requests, can
> lead to a 100% of CPU usage which can last up to several hours
> depending on the targeted application and server performance, the
> amplification effect is considerable and requires little bandwidth and
> time on the attacker side.
>
> The condition for predictable collisions in the hashing functions has
> been reported for the following language implementations: Java, JRuby,
> PHP, Python, Rubinius, Ruby. In the case of the Ruby language, the
> 1.9.x branch is not affected by the predictable collision condition
> since this version includes a randomization of the hashing function.
>
> The vulnerability outlined in this advisory is practically identical
> to the one reported in 2003 and described in the paper Denial of
> Service via Algorithmic Complexity Attacks which affected the Perl
> language.


## Affected packages
 - **jruby**
    - **Fixed:** 1.6.5.1
 - **ruby**
    - **Fixed:** 1.8.7.357,1
 - **ruby+nopthreads**
    - **Fixed:** 1.8.7.357,1
 - **ruby+nopthreads+oniguruma**
    - **Fixed:** 1.8.7.357,1
 - **ruby+oniguruma**
    - **Fixed:** 1.8.7.357,1
 - **rubygem-rack**
    - **Fixed:** 1.3.6,3
 - **v8**
    - **Fixed:** 3.8.5
 - **redis**
    - **Fixed:** 2.4.6
 - **node**
    - **Fixed:** 0.6.7

## Details
 - **published**: 2012-01-16T00:00:00Z
 - **modified**: 2012-01-20T00:00:00Z
 - **discovery**: 2011-12-28T00:00:00Z
 - **vid**: [91be81e7-3fea-11e1-afc7-2c4138874f7d](https://vuxml.freebsd.org/freebsd/91be81e7-3fea-11e1-afc7-2c4138874f7d.html)

## References
 - REPORT: [http://www.ocert.org/advisories/ocert-2011-003.html](http://www.ocert.org/advisories/ocert-2011-003.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2011-4838](https://api.osv.dev/v1/vulns/CVE-2011-4838)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2011-4815](https://api.osv.dev/v1/vulns/CVE-2011-4815)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2011-5036](https://api.osv.dev/v1/vulns/CVE-2011-5036)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2011-5037](https://api.osv.dev/v1/vulns/CVE-2011-5037)
 - WEB: [http://www.nruns.com/_downloads/advisory28122011.pdf](http://www.nruns.com/_downloads/advisory28122011.pdf)
