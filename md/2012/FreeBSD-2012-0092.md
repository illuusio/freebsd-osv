# sudo -- netmask vulnerability
Todd Miller reports:

> Sudo supports granting access to commands on a per-host basis. The
> host specification may be in the form of a host name, a netgroup, an
> IP address, or an IP network (an IP address with an associated
> netmask).
>
> When IPv6 support was added to sudo, a bug was introduced that caused
> the IPv6 network matching code to be called when an IPv4 network
> address does not match. Depending on the value of the uninitialized
> portion of the IPv6 address, it is possible for the IPv4 network
> number to match when it should not. This bug only affects IP network
> matching and does not affect simple IP address matching.
>
> The reported configuration that exhibited the bug was an LDAP-based
> sudo installation where the sudoRole object contained multiple
> sudoHost entries, each containing a different IPv4 network. File-based
> sudoers should be affected as well as the same matching code is used.


## Affected packages
 - **sudo**
    - **Fixed:** 1.8.4_1

## Details
 - **published**: 2012-05-16T00:00:00Z
 - **modified**: 2012-05-16T00:00:00Z
 - **discovery**: 2012-05-16T00:00:00Z
 - **vid**: [b3435b68-9ee8-11e1-997c-002354ed89bc](https://vuxml.freebsd.org/freebsd/b3435b68-9ee8-11e1-997c-002354ed89bc.html)

## References
 - REPORT: [http://www.sudo.ws/sudo/alerts/netmask.html](http://www.sudo.ws/sudo/alerts/netmask.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2012-2337](https://api.osv.dev/v1/vulns/CVE-2012-2337)
