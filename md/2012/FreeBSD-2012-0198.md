# ruby -- Unintentional file creation caused by inserting an illegal NUL character
The official ruby site reports:

> A vulnerability was found that file creation routines can create
> unintended files by strategically inserting NUL(s) in file paths. This
> vulnerability has been reported as CVE-2012-4522.
>
> Ruby can handle arbitrary binary patterns as Strings, including NUL
> chars. On the other hand OSes and other libraries tend not. They
> usually treat a NUL as an End of String mark. So to interface them
> with Ruby, NUL chars should properly be avoided.
>
> However methods like IO#open did not check the filename passed to
> them, and just passed those strings to lower layer routines. This led
> to create unintentional files.


## Affected packages
 - **ruby**
    - **Introduced:** 1.9.3,1,1
    - **Fixed:** 1.9.3.286,1

## Details
 - **published**: 2012-11-01T00:00:00Z
 - **modified**: 2012-11-01T00:00:00Z
 - **discovery**: 2012-10-12T00:00:00Z
 - **vid**: [3decc87d-2498-11e2-b0c7-000d601460a4](https://vuxml.freebsd.org/freebsd/3decc87d-2498-11e2-b0c7-000d601460a4.html)

## References
 - REPORT: [http://www.ruby-lang.org/en/news/2012/10/12/poisoned-NUL-byte-vulnerability/](http://www.ruby-lang.org/en/news/2012/10/12/poisoned-NUL-byte-vulnerability/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2012-4522](https://api.osv.dev/v1/vulns/CVE-2012-4522)
 - WEB: [https://access.redhat.com/security/cve/CVE-2012-4522/](https://access.redhat.com/security/cve/CVE-2012-4522/)
