# FreeBSD -- heap overflow in file(1)
# Problem Description:

When writing data into a buffer in the file_printf function, the length
of the unused portion of the buffer is not correctly tracked, resulting
in a buffer overflow when processing certain files.

# Impact:

An attacker who can cause file(1) to be run on a maliciously constructed
input can cause file(1) to crash. It may be possible for such an
attacker to execute arbitrary code with the privileges of the user
running file(1).

The above also applies to any other applications using the libmagic(3)
library.

# Workaround:

No workaround is available, but systems where file(1) and other
libmagic(3)-using applications are never run on untrusted input are not
vulnerable.


## Affected packages
 - **file**
    - **Fixed:** 4.21
 - **FreeBSD**
    - **Introduced:** 6.2
    - **Fixed:** 6.2_5
    - **Introduced:** 6.1
    - **Fixed:** 6.1_17
    - **Introduced:** 5.5
    - **Fixed:** 5.5_13

## Details
 - **published**: 2007-05-23T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2007-05-23T00:00:00Z
 - **vid**: [8e01ab5b-0949-11dc-8163-000e0c2e438a](https://vuxml.freebsd.org/freebsd/8e01ab5b-0949-11dc-8163-000e0c2e438a.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2007-1536](https://api.osv.dev/v1/vulns/CVE-2007-1536)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-07:04.file.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-07:04.file.asc)
