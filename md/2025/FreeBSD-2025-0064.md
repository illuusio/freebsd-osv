# Jinja2 -- Sandbox breakout through attr filter selecting format method
security-advisories@github.com reports:

> Jinja is an extensible templating engine. Prior to 3.1.6, an oversight
> in how the Jinja sandboxed environment interacts with the \|attr
> filter allows an attacker that controls the content of a template to
> execute arbitrary Python code. To exploit the vulnerability, an
> attacker needs to control the content of a template. Whether that is
> the case depends on the type of application using Jinja. This
> vulnerability impacts users of applications which execute untrusted
> templates. Jinja\'s sandbox does catch calls to str.format and ensures
> they don\'t escape the sandbox. However, it\'s possible to use the
> \|attr filter to get a reference to a string\'s plain format method,
> bypassing the sandbox. After the fix, the \|attr filter no longer
> bypasses the environment\'s attribute lookup. This vulnerability is
> fixed in 3.1.6.


## Affected packages
 - **py38-Jinja2**
    - **Fixed:** 3.1.6
 - **py39-Jinja2**
    - **Fixed:** 3.1.6
 - **py310-Jinja2**
    - **Fixed:** 3.1.6
 - **py311-Jinja2**
    - **Fixed:** 3.1.6

## Details
 - **published**: 2025-03-06T00:00:00Z
 - **modified**: 2025-03-06T00:00:00Z
 - **discovery**: 2025-03-05T00:00:00Z
 - **vid**: [3299cbfd-fa6e-11ef-929d-b0416f0c4c67](https://vuxml.freebsd.org/freebsd/3299cbfd-fa6e-11ef-929d-b0416f0c4c67.html)

## References
 - REPORT: [https://github.com/pallets/jinja/commit/90457bbf33b8662926ae65cdde4c4c32e756e403](https://github.com/pallets/jinja/commit/90457bbf33b8662926ae65cdde4c4c32e756e403)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2025-27516](https://api.osv.dev/v1/vulns/CVE-2025-27516)
 - ADVISORY: [https://nvd.nist.gov/vuln/detail/CVE-2025-27516](https://nvd.nist.gov/vuln/detail/CVE-2025-27516)
