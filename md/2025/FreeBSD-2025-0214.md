# FreeBSD -- Use-after-free in multi-threaded xz decoder
# Problem Description:

A worker thread could free its input buffer after decoding, while the
main thread might still be writing to it. This leads to an
use-after-free condition on heap memory.

# Impact:

An attacker may use specifically crafted .xz file to cause
multi-threaded xz decoder to crash, or potentially run arbitrary code
under the credential the decoder was executed.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 14.2
    - **Fixed:** 14.2_4
    - **Introduced:** 13.5
    - **Fixed:** 13.5_2

## Details
 - **published**: 2025-07-06T00:00:00Z
 - **modified**: 2025-07-06T00:00:00Z
 - **discovery**: 2025-07-02T00:00:00Z
 - **vid**: [7642ba72-5abf-11f0-87ba-002590c1f29c](https://vuxml.freebsd.org/freebsd/7642ba72-5abf-11f0-87ba-002590c1f29c.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2025-31115](https://cveawg.mitre.org/api/cve/CVE-2025-31115)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-25:06.xz.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-25:06.xz.asc)
