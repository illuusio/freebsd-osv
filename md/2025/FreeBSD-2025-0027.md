# FreeBSD -- Unprivileged access to system files
# Problem Description:

When etcupdate encounters conflicts while merging files, it saves a
version containing conflict markers in /var/db/etcupdate/conflicts. This
version does not preserve the mode of the input file, and is
world-readable. This applies to files that would normally have
restricted visibility, such as /etc/master.passwd.

# Impact:

An unprivileged local user may be able to read encrypted root and user
passwords from the temporary master.passwd file created in
/var/db/etcupdate/conflicts. This is possible only when conflicts within
the password file arise during an update, and the unprotected file is
deleted when conflicts are resolved.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 14.2
    - **Fixed:** 14.2_1
    - **Introduced:** 14.1
    - **Fixed:** 14.1_7
    - **Introduced:** 13.4
    - **Fixed:** 13.4_3

## Details
 - **published**: 2025-01-30T00:00:00Z
 - **modified**: 2025-01-30T00:00:00Z
 - **discovery**: 2025-01-29T00:00:00Z
 - **vid**: [fa9ae646-debc-11ef-87ba-002590c1f29c](https://vuxml.freebsd.org/freebsd/fa9ae646-debc-11ef-87ba-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2025-0374](https://api.osv.dev/v1/vulns/CVE-2025-0374)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-25:03.etcupdate.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-25:03.etcupdate.asc)
