# FreeBSD -- Buffer overflow in some filesystems via NFS
# Problem Description:

In order to export a file system via NFS, the file system must define a
file system identifier (FID) for all exported files. Each FreeBSD file
system implements operations to translate between FIDs and vnodes, the
kernel\'s in-memory representation of files. These operations are
VOP_VPTOFH(9) and VFS_FHTOVP(9).

On 64-bit systems, the implementation of VOP_VPTOFH() in the cd9660,
tarfs and ext2fs filesystems overflows the destination FID buffer by 4
bytes, a stack buffer overflow.

# Impact:

A NFS server that exports a cd9660, tarfs, or ext2fs file system can be
made to panic by mounting and accessing the export with an NFS client.
Further exploitation (e.g., bypassing file permission checking or remote
kernel code execution) is potentially possible, though this has not been
demonstrated. In particular, release kernels are compiled with stack
protection enabled, and some instances of the overflow are caught by
this mechanism, causing a panic.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 14.2
    - **Fixed:** 14.2_1
    - **Introduced:** 14.1
    - **Fixed:** 14.1_7
    - **Introduced:** 13.4
    - **Fixed:** 13.4_3

## Details
 - **published**: 2025-01-30T00:00:00Z
 - **modified**: 2025-01-30T00:00:00Z
 - **discovery**: 2025-01-29T00:00:00Z
 - **vid**: [ab0cbe3f-debc-11ef-87ba-002590c1f29c](https://vuxml.freebsd.org/freebsd/ab0cbe3f-debc-11ef-87ba-002590c1f29c.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2025-0373](https://cveawg.mitre.org/api/cve/CVE-2025-0373)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-25:02.fs.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-25:02.fs.asc)
