# xen-kernel -- vulnerability in the iret hypercall handler
The Xen Project reports:

> A buggy loop in Xen\'s compat_iret() function iterates the wrong way
> around a 32-bit index. Any 32-bit PV guest kernel can trigger this
> vulnerability by attempting a hypercall_iret with EFLAGS.VM set.
>
> Given the use of \_\_get/put_user(), and that the virtual addresses in
> question are contained within the lower canonical half, the guest
> cannot clobber any hypervisor data. Instead, Xen will take up to 2\^33
> pagefaults, in sequence, effectively hanging the host.
>
> Malicious guest administrators can cause a denial of service affecting
> the whole system.


## Affected packages
 - **xen-kernel**
    - **Introduced:** 3.1
    - **Fixed:** 4.5.0_3

## Details
 - **published**: 2015-07-11T00:00:00Z
 - **modified**: 2015-07-11T00:00:00Z
 - **discovery**: 2015-06-11T00:00:00Z
 - **vid**: [8c31b288-27ec-11e5-a4a5-002590263bf5](https://vuxml.freebsd.org/freebsd/8c31b288-27ec-11e5-a4a5-002590263bf5.html)

## References
 - REPORT: [http://xenbits.xen.org/xsa/advisory-136.html](http://xenbits.xen.org/xsa/advisory-136.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2015-4164](https://api.osv.dev/v1/vulns/CVE-2015-4164)
