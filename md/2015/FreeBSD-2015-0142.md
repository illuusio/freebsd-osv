# rubygem-paperclip -- validation bypass vulnerability
Jon Yurek reports:

> Thanks to MORI Shingo of DeNA Co., Ltd. for reporting this.
>
> There is an issue where if an HTML file is uploaded with a .html
> extension, but the content type is listed as being \`image/jpeg\`,
> this will bypass a validation checking for images. But it will also
> pass the spoof check, because a file named .html and containing actual
> HTML passes the spoof check.
>
> This change makes it so that we also check the supplied content type.
> So even if the file contains HTML and ends with .html, it doesn\'t
> match the content type of \`image/jpeg\` and so it fails.


## Affected packages
 - **rubygem-paperclip**
    - **Fixed:** 4.2.2

## Details
 - **published**: 2015-06-22T00:00:00Z
 - **modified**: 2015-06-22T00:00:00Z
 - **discovery**: 2015-06-05T00:00:00Z
 - **vid**: [0f154810-16e4-11e5-a1cf-002590263bf5](https://vuxml.freebsd.org/freebsd/0f154810-16e4-11e5-a1cf-002590263bf5.html)

## References
 - REPORT: [https://github.com/thoughtbot/paperclip/commit/9aee4112f36058cd28d5fe4a006d6981bd1eda57](https://github.com/thoughtbot/paperclip/commit/9aee4112f36058cd28d5fe4a006d6981bd1eda57)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2015-2963](https://api.osv.dev/v1/vulns/CVE-2015-2963)
 - WEB: [https://robots.thoughtbot.com/paperclip-security-release](https://robots.thoughtbot.com/paperclip-security-release)
 - WEB: [http://jvn.jp/en/jp/JVN83881261/index.html](http://jvn.jp/en/jp/JVN83881261/index.html)
