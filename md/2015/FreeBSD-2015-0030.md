# xorg-server -- Information leak in the XkbSetGeometry request of X servers.
Peter Hutterer reports:

> Olivier Fourdan from Red Hat has discovered a protocol handling issue
> in the way the X server code base handles the XkbSetGeometry request.
>
> The issue stems from the server trusting the client to send valid
> string lengths in the request data. A malicious client with string
> lengths exceeding the request length can cause the server to copy
> adjacent memory data into the XKB structs. This data is then available
> to the client via the XkbGetGeometry request. The data length is at
> least up to 64k, it is possible to obtain more data by chaining
> strings, each string length is then determined by whatever happens to
> be in that 16-bit region of memory.
>
> A similarly crafted request can likely cause the X server to crash.


## Affected packages
 - **xorg-server**
    - **Fixed:** 1.14.7_2,1
 - **xorg-server**
    - **Introduced:** 1.15.0,1
    - **Fixed:** 1.16.4,1

## Details
 - **published**: 2015-02-12T00:00:00Z
 - **modified**: 2015-02-12T00:00:00Z
 - **discovery**: 2015-02-10T00:00:00Z
 - **vid**: [54a69cf7-b2ef-11e4-b1f1-bcaec565249c](https://vuxml.freebsd.org/freebsd/54a69cf7-b2ef-11e4-b1f1-bcaec565249c.html)

## References
 - REPORT: [http://lists.freedesktop.org/archives/xorg/2015-February/057158.html](http://lists.freedesktop.org/archives/xorg/2015-February/057158.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2015-0255](https://cveawg.mitre.org/api/cve/CVE-2015-0255)
