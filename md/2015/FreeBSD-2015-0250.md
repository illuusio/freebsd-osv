# qemu, xen-tools -- use-after-free in QEMU/Xen block unplug protocol
The Xen Project reports:

> When unplugging an emulated block device the device was not fully
> unplugged, meaning a second unplug attempt would attempt to unplug the
> device a second time using a previously freed pointer.
>
> An HVM guest which has access to an emulated IDE disk device may be
> able to exploit this vulnerability in order to take over the qemu
> process elevating its privilege to that of the qemu process.


## Affected packages
 - **qemu**
    - **Fixed:** 0.11.1_20
    - **Introduced:** 0.12
    - **Fixed:** 2.3.0_2
 - **qemu-devel**
    - **Fixed:** 0.11.1_20
    - **Introduced:** 0.12
    - **Fixed:** 2.3.0_2
 - **qemu-sbruno**
    - **Fixed:** 2.4.50.g20150814
 - **qemu-user-static**
    - **Fixed:** 2.4.50.g20150814
 - **xen-tools**
    - **Fixed:** 4.5.1

## Details
 - **published**: 2015-08-17T00:00:00Z
 - **modified**: 2015-08-19T00:00:00Z
 - **discovery**: 2015-08-03T00:00:00Z
 - **vid**: [ee99899d-4347-11e5-93ad-002590263bf5](https://vuxml.freebsd.org/freebsd/ee99899d-4347-11e5-93ad-002590263bf5.html)

## References
 - REPORT: [http://xenbits.xen.org/xsa/advisory-139.html](http://xenbits.xen.org/xsa/advisory-139.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2015-5166](https://cveawg.mitre.org/api/cve/CVE-2015-5166)
 - WEB: [http://git.qemu.org/?p=qemu.git;a=commit;h=260425ab405ea76c44dd59744d05176d4f579a52](http://git.qemu.org/?p=qemu.git;a=commit;h=260425ab405ea76c44dd59744d05176d4f579a52)
