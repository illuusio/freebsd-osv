# xen-kernel -- GNTTABOP_swap_grant_ref operation misbehavior
The Xen Project reports:

> With the introduction of version 2 grant table operations, a version
> check became necessary for most grant table related hypercalls. The
> GNTTABOP_swap_grant_ref call was lacking such a check. As a result,
> the subsequent code behaved as if version 2 was in use, when a guest
> issued this hypercall without a prior GNTTABOP_setup_table or
> GNTTABOP_set_version.
>
> The effect is a possible NULL pointer dereferences. However, this
> cannot be exploited to elevate privileges of the attacking domain, as
> the maximum memory address that can be wrongly accessed this way is
> bounded to far below the start of hypervisor memory.
>
> Malicious or buggy guest domain kernels can mount a denial of service
> attack which, if successful, can affect the whole system.


## Affected packages
 - **xen-kernel**
    - **Introduced:** 4.2
    - **Fixed:** 4.5.0_3

## Details
 - **published**: 2015-07-11T00:00:00Z
 - **modified**: 2015-07-11T00:00:00Z
 - **discovery**: 2015-06-11T00:00:00Z
 - **vid**: [80e846ff-27eb-11e5-a4a5-002590263bf5](https://vuxml.freebsd.org/freebsd/80e846ff-27eb-11e5-a4a5-002590263bf5.html)

## References
 - REPORT: [http://xenbits.xen.org/xsa/advisory-134.html](http://xenbits.xen.org/xsa/advisory-134.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2015-4163](https://api.osv.dev/v1/vulns/CVE-2015-4163)
