# pcre -- heap overflow vulnerability
Guanxing Wen reports:

> PCRE library is prone to a vulnerability which leads to Heap Overflow.
> During the compilation of a malformed regular expression, more data is
> written on the malloced block than the expected size output by
> compile_regex(). The Heap Overflow vulnerability is caused by the
> following regular expression.
>
> /(?J:(?\|(:(?\|(?\'R\')(\\z(?\|(?\'R\')(\\k\'R\')\|((?\'R\')))k\'R\')\|((?\'R\')))H\'Ak\'Rf)\|s(?\'R\')))/
>
> A dry run of this particular regular expression with pcretest will
> reports \"double free or corruption (!prev)\". But it is actually a
> heap overflow problem. The overflow only affects pcre 8.x branch,
> pcre2 branch is not affected.


## Affected packages
 - **pcre**
    - **Fixed:** 8.37_4

## Details
 - **published**: 2015-08-24T00:00:00Z
 - **modified**: 2015-08-24T00:00:00Z
 - **discovery**: 2015-08-21T00:00:00Z
 - **vid**: [6900e6f1-4a79-11e5-9ad8-14dae9d210b8](https://vuxml.freebsd.org/freebsd/6900e6f1-4a79-11e5-9ad8-14dae9d210b8.html)

## References
 - REPORT: [http://seclists.org/oss-sec/2015/q3/295](http://seclists.org/oss-sec/2015/q3/295)
 - WEB: [http://seclists.org/oss-sec/2015/q3/295](http://seclists.org/oss-sec/2015/q3/295)
 - WEB: [https://bugs.exim.org/show_bug.cgi?id=1672](https://bugs.exim.org/show_bug.cgi?id=1672)
