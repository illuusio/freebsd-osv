# vim -- vulnerabilities in modeline handling
Ciaran McCreesh discovered news ways in which a VIM modeline can be used
to trojan a text file. The patch by Bram Moolenaar reads:

> Problem: Unusual characters in an option value may cause unexpected
> behavior, especially for a modeline. (Ciaran McCreesh)
>
> Solution: Don\'t allow setting termcap options or \'printdevice\' or
> \'titleold\' in a modeline. Don\'t list options for \"termcap\" and
> \"all\" in a modeline. Don\'t allow unusual characters in
> \'filetype\', \'syntax\', \'backupext\', \'keymap\', \'patchmode\' and
> \'langmenu\'.

**Note:** It is generally recommended that VIM users use
`set nomodeline` in `~/.vimrc` to avoid the possibility of trojaned text
files.


## Affected packages
 - **vim**
    - **Fixed:** 6.3.45
 - **vim-console**
    - **Fixed:** 6.3.45
 - **vim-lite**
    - **Fixed:** 6.3.45
 - **vim+ruby**
    - **Fixed:** 6.3.45

## Details
 - **published**: 2005-01-06T00:00:00Z
 - **modified**: 2005-01-13T00:00:00Z
 - **discovery**: 2004-12-09T00:00:00Z
 - **vid**: [bd9fc2bf-5ffe-11d9-a11a-000a95bc6fae](https://vuxml.freebsd.org/freebsd/bd9fc2bf-5ffe-11d9-a11a-000a95bc6fae.html)

## References
 - REPORT: [ftp://ftp.vim.org/pub/vim/patches/6.3/6.3.045](ftp://ftp.vim.org/pub/vim/patches/6.3/6.3.045)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2004-1138](https://cveawg.mitre.org/api/cve/CVE-2004-1138)
 - DISCUSSION: [http://groups.yahoo.com/group/vimdev/message/38084](http://groups.yahoo.com/group/vimdev/message/38084)
