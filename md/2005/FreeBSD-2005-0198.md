# bzip2 -- denial of service and permission race vulnerabilities
# Problem Description

Two problems have been discovered relating to the extraction of
bzip2-compressed files. First, a carefully constructed invalid bzip2
archive can cause bzip2 to enter an infinite loop. Second, when creating
a new file, bzip2 closes the file before setting its permissions.

# Impact

The first problem can cause bzip2 to extract a bzip2 archive to an
infinitely large file. If bzip2 is used in automated processing of
untrusted files this could be exploited by an attacker to create an
denial-of-service situation by exhausting disk space or by consuming all
available cpu time.

The second problem can allow a local attacker to change the permissions
of local files owned by the user executing bzip2 providing that they
have write access to the directory in which the file is being extracted.

# Workaround

Do not uncompress bzip2 archives from untrusted sources and do not
uncompress files in directories where untrusted users have write access.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 5.4
    - **Fixed:** 5.4_3
    - **Introduced:** 5.0
    - **Fixed:** 5.3_17
    - **Introduced:** 4.11
    - **Fixed:** 4.11_11
    - **Fixed:** 4.10_16
 - **bzip2**
    - **Fixed:** 1.0.3_1

## Details
 - **published**: 2005-06-29T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2005-03-30T00:00:00Z
 - **vid**: [197f444f-e8ef-11d9-b875-0001020eed82](https://vuxml.freebsd.org/freebsd/197f444f-e8ef-11d9-b875-0001020eed82.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2005-0953](https://api.osv.dev/v1/vulns/CVE-2005-0953)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2005-1260](https://api.osv.dev/v1/vulns/CVE-2005-1260)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-05:14.bzip2.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-05:14.bzip2.asc)
 - WEB: [http://scary.beasts.org/security/CESA-2005-002.txt](http://scary.beasts.org/security/CESA-2005-002.txt)
