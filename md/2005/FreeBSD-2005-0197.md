# kernel -- TCP connection stall denial of service
# Problem Description

Two problems have been discovered in the FreeBSD TCP stack.

First, when a TCP packets containing a timestamp is received, inadequate
checking of sequence numbers is performed, allowing an attacker to
artificially increase the internal \"recent\" timestamp for a
connection.

Second, a TCP packet with the SYN flag set is accepted for established
connections, allowing an attacker to overwrite certain TCP options.

# Impact

Using either of the two problems an attacker with knowledge of the local
and remote IP and port numbers associated with a connection can cause a
denial of service situation by stalling the TCP connection. The stalled
TCP connection my be closed after some time by the other host.

# Workaround

In some cases it may be possible to defend against these attacks by
blocking the attack packets using a firewall. Packets used to effect
either of these attacks would have spoofed source IP addresses.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 5.4
    - **Fixed:** 5.4_3
    - **Introduced:** 5.0
    - **Fixed:** 5.3_17
    - **Introduced:** 4.11
    - **Fixed:** 4.11_11
    - **Fixed:** 4.10_16

## Details
 - **published**: 2005-06-29T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2005-06-29T00:00:00Z
 - **vid**: [3ec8f43b-e8ef-11d9-b875-0001020eed82](https://vuxml.freebsd.org/freebsd/3ec8f43b-e8ef-11d9-b875-0001020eed82.html)

## References
 - ADVISORY: [https://www.kb.cert.org/vuls/id/637934](https://www.kb.cert.org/vuls/id/637934)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2005-0356](https://api.osv.dev/v1/vulns/CVE-2005-0356)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2005-2068](https://api.osv.dev/v1/vulns/CVE-2005-2068)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-05:15.tcp.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-05:15.tcp.asc)
