# firefox & mozilla -- buffer overflow vulnerability
Tom Ferris reports:

> A buffer overflow vulnerability exists within Firefox version 1.0.6
> and all other prior versions which allows for an attacker to remotely
> execute arbitrary code on an affected host.
>
> The problem seems to be when a hostname which has all dashes causes
> the NormalizeIDN call in nsStandardURL::BuildNormalizedSpec to return
> true, but is sets encHost to an empty string. Meaning, Firefox appends
> 0 to approxLen and then appends the long string of dashes to the
> buffer instead.

**Note:** It is possible to disable IDN support as a workaround to
protect against this buffer overflow. How to do this is described on the
*[What Firefox and Mozilla users should know about the IDN buffer
overflow security issue](http://www.mozilla.org/security/idn.html)* web
page.


## Affected packages
 - **firefox**
    - **Fixed:** 1.0.6_5,1
 - **linux-firefox**
    - **Fixed:** 1.0.7
 - **mozilla**
    - **Fixed:** 1.7.11_1,2
    - **Introduced:** 1.8.*,2
    - **Fixed:** 1.8.b1_5,2
 - **linux-mozilla**
    - **Fixed:** 1.7.12
 - **linux-mozilla-devel**
    - **Introduced:** 0,1
 - **netscape7**
 - **de-linux-mozillafirebird**
 - **el-linux-mozillafirebird**
 - **ja-linux-mozillafirebird-gtk1**
 - **ja-mozillafirebird-gtk2**
 - **linux-mozillafirebird**
 - **ru-linux-mozillafirebird**
 - **zhCN-linux-mozillafirebird**
 - **zhTW-linux-mozillafirebird**
 - **de-linux-netscape**
 - **de-netscape7**
 - **fr-linux-netscape**
 - **fr-netscape7**
 - **ja-linux-netscape**
 - **ja-netscape7**
 - **linux-netscape**
 - **linux-phoenix**
 - **mozilla+ipv6**
 - **mozilla-embedded**
 - **mozilla-firebird**
 - **mozilla-gtk1**
 - **mozilla-gtk2**
 - **mozilla-gtk**
 - **mozilla-thunderbird**
 - **phoenix**
 - **pt_BR-netscape7**

## Details
 - **published**: 2005-09-10T00:00:00Z
 - **modified**: 2005-10-26T00:00:00Z
 - **discovery**: 2005-09-08T00:00:00Z
 - **vid**: [8665ebb9-2237-11da-978e-0001020eed82](https://vuxml.freebsd.org/freebsd/8665ebb9-2237-11da-978e-0001020eed82.html)

## References
 - REPORT: [http://marc.theaimsgroup.com/?l=full-disclosure&m=112624614008387](http://marc.theaimsgroup.com/?l=full-disclosure&m=112624614008387)
 - ADVISORY: [https://www.securityfocus.com/bid/14784/info](https://www.securityfocus.com/bid/14784/info)
 - ADVISORY: [https://www.kb.cert.org/vuls/id/573857](https://www.kb.cert.org/vuls/id/573857)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2005-2871](https://cveawg.mitre.org/api/cve/CVE-2005-2871)
 - WEB: [http://www.mozilla.org/security/idn.html](http://www.mozilla.org/security/idn.html)
 - REPORT: [https://bugzilla.mozilla.org/show_bug.cgi?id=307259](https://bugzilla.mozilla.org/show_bug.cgi?id=307259)
 - WEB: [http://www.mozilla.org/security/announce/mfsa2005-57.html](http://www.mozilla.org/security/announce/mfsa2005-57.html)
