# zgv -- exploitable heap overflows
infamous41md reports:

> zgv uses malloc() frequently to allocate memory for storing image
> data. When calculating how much to allocate, user supplied data from
> image headers is multiplied and/or added without any checks for
> arithmetic overflows. We can overflow numerous calculations, and cause
> small buffers to be allocated. Then we can overflow the buffer, and
> eventually execute code. There are a total of 11 overflows that are
> exploitable to execute arbitrary code.

These bugs exist in both zgv and xzgv.


## Affected packages
 - **zgv**
    - **Fixed:** 5.8_1
 - **xzgv**
    - **Fixed:** 0.8_2

## Details
 - **published**: 2005-01-18T00:00:00Z
 - **modified**: 2005-01-21T00:00:00Z
 - **discovery**: 2004-10-26T00:00:00Z
 - **vid**: [249a8c42-6973-11d9-ae49-000c41e2cdad](https://vuxml.freebsd.org/freebsd/249a8c42-6973-11d9-ae49-000c41e2cdad.html)

## References
 - REPORT: [http://marc.theaimsgroup.com/?l=bugtraq&m=109886210702781](http://marc.theaimsgroup.com/?l=bugtraq&m=109886210702781)
 - DISCUSSION: [http://marc.theaimsgroup.com/?l=bugtraq&m=109886210702781](http://marc.theaimsgroup.com/?l=bugtraq&m=109886210702781)
 - DISCUSSION: [http://marc.theaimsgroup.com/?l=bugtraq&m=109898111915661](http://marc.theaimsgroup.com/?l=bugtraq&m=109898111915661)
 - WEB: [http://rus.members.beeb.net/xzgv.html](http://rus.members.beeb.net/xzgv.html)
 - WEB: [http://www.svgalib.org/rus/zgv/](http://www.svgalib.org/rus/zgv/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2004-0994](https://api.osv.dev/v1/vulns/CVE-2004-0994)
 - WEB: [http://www.idefense.com/application/poi/display?id=160&type=vulnerabilities&flashstatus=false](http://www.idefense.com/application/poi/display?id=160&type=vulnerabilities&flashstatus=false)
