# trac -- file upload/download vulnerability
Stefan Esser reports:

> Trac\'s wiki and ticket systems allows to add attachments to wiki
> entries and bug tracker tickets. These attachments are stored within
> directories that are determined by the id of the corresponding ticket
> or wiki entry.
>
> Due to a missing validation of the id parameter it is possible for an
> attacker to supply arbitrary paths to the upload and attachment viewer
> scripts. This means that a potential attacker can retrieve any file
> accessible by the webserver user.
>
> Additionally it is possible to upload arbitrary files (up to a
> configured file length) to any place the webserver has write access
> too.
>
> For obvious reasons this can lead to the execution of arbitrary code
> if it possible to upload files to the document root or it\'s
> subdirectories. One example of a configuration would be f.e. running
> Trac and s9y/wordpress with writeable content directories on the same
> webserver.
>
> Another potential usage of this exploit would be to abuse Trac powered
> webservers as storage for f.e. torrent files.


## Affected packages
 - **trac**
    - **Fixed:** 0.8.4

## Details
 - **published**: 2005-06-20T00:00:00Z
 - **modified**: 2005-06-20T00:00:00Z
 - **discovery**: 2005-06-20T00:00:00Z
 - **vid**: [b02c1d80-e1bb-11d9-b875-0001020eed82](https://vuxml.freebsd.org/freebsd/b02c1d80-e1bb-11d9-b875-0001020eed82.html)

## References
 - REPORT: [http://www.hardened-php.net/advisory-012005.php](http://www.hardened-php.net/advisory-012005.php)
 - ADVISORY: [https://www.securityfocus.com/bid/13990/info](https://www.securityfocus.com/bid/13990/info)
 - WEB: [http://projects.edgewall.com/trac/wiki/ChangeLog](http://projects.edgewall.com/trac/wiki/ChangeLog)
