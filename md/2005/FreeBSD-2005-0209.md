# clamav -- cabinet file handling DoS vulnerability
An iDEFENSE Security Advisory reports:

> Remote exploitation of an input validation error in Clam AntiVirus
> ClamAV allows attackers to cause a denial of service condition.
>
> The vulnerability specifically exists due to insufficient validation
> on cabinet file header data. The `ENSURE_BITS()` macro fails to check
> for zero length reads, allowing a carefully constructed cabinet file
> to cause an infinite loop.
>
> ClamAV is used in a number of mail gateway products. Successful
> exploitation requires an attacker to send a specially constructed CAB
> file through a mail gateway or personal anti-virus client utilizing
> the ClamAV scanning engine. The infinate loop will cause the ClamAV
> software to use all available processor resources, resulting in a
> denial of service or severe degradation to system performance. Remote
> exploitation can be achieved by sending a malicious file in an e-mail
> message or during an HTTP session.


## Affected packages
 - **clamav**
    - **Fixed:** 0.86
 - **clamav-devel**
    - **Fixed:** 20050620

## Details
 - **published**: 2005-07-06T00:00:00Z
 - **modified**: 2005-07-06T00:00:00Z
 - **discovery**: 2005-06-29T00:00:00Z
 - **vid**: [d8e1aadd-ee68-11d9-8310-0001020eed82](https://vuxml.freebsd.org/freebsd/d8e1aadd-ee68-11d9-8310-0001020eed82.html)

## References
 - REPORT: [http://marc.theaimsgroup.com/?l=bugtraq&m=112006456809016](http://marc.theaimsgroup.com/?l=bugtraq&m=112006456809016)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2005-1923](https://cveawg.mitre.org/api/cve/CVE-2005-1923)
 - DISCUSSION: [http://marc.theaimsgroup.com/?l=bugtraq&m=112006456809016](http://marc.theaimsgroup.com/?l=bugtraq&m=112006456809016)
