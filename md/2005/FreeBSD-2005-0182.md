# gzip -- directory traversal and permission race vulnerabilities
# Problem Description

Two problems related to extraction of files exist in gzip:

The first problem is that gzip does not properly sanitize filenames
containing \"/\" when uncompressing files using the -N command line
option.

The second problem is that gzip does not set permissions on newly
extracted files until after the file has been created and the file
descriptor has been closed.

# Impact

The first problem can allow an attacker to overwrite arbitrary local
files when uncompressing a file using the -N command line option.

The second problem can allow a local attacker to change the permissions
of arbitrary local files, on the same partition as the one the user is
uncompressing a file on, by removing the file the user is uncompressing
and replacing it with a hardlink before the uncompress operation is
finished.

# Workaround

Do not use the -N command line option on untrusted files and do not
uncompress files in directories where untrusted users have write access.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 5.4
    - **Fixed:** 5.4_2
    - **Introduced:** 5.0
    - **Fixed:** 5.3_16
    - **Introduced:** 4.11
    - **Fixed:** 4.11_10
    - **Introduced:** 4.10
    - **Fixed:** 4.10_15
    - **Introduced:** 4.9
    - **Fixed:** 4.9_18
    - **Fixed:** 4.8_33
 - **gzip**
    - **Fixed:** 1.3.5_2

## Details
 - **published**: 2005-06-18T00:00:00Z
 - **modified**: 2005-07-06T00:00:00Z
 - **discovery**: 2005-04-20T00:00:00Z
 - **vid**: [63bd4bad-dffe-11d9-b875-0001020eed82](https://vuxml.freebsd.org/freebsd/63bd4bad-dffe-11d9-b875-0001020eed82.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2005-0988](https://api.osv.dev/v1/vulns/CVE-2005-0988)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2005-1228](https://api.osv.dev/v1/vulns/CVE-2005-1228)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-05:11.gzip.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-05:11.gzip.asc)
 - DISCUSSION: [http://marc.theaimsgroup.com/?l=bugtraq&m=111271860708210](http://marc.theaimsgroup.com/?l=bugtraq&m=111271860708210)
 - DISCUSSION: [http://marc.theaimsgroup.com/?l=bugtraq&m=111402732406477](http://marc.theaimsgroup.com/?l=bugtraq&m=111402732406477)
