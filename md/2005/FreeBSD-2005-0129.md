# mozilla -- privilege escalation via DOM property overrides
A Mozilla Foundation Security Advisory reports:

> moz_bug_r_a4 reported several exploits giving an attacker the ability
> to install malicious code or steal data, requiring only that the user
> do commonplace actions like click on a link or open the context menu.
> The common cause in each case was privileged UI code (\"chrome\")
> being overly trusting of DOM nodes from the content window. Scripts in
> the web page can override properties and methods of DOM nodes and
> shadow the native values, unless steps are taken to get the true
> underlying values.
>
> We found that most extensions also interacted with content DOM in a
> natural, but unsafe, manner. Changes were made so that chrome code
> using this natural DOM coding style will now automatically use the
> native DOM value if it exists without having to use cumbersome wrapper
> objects.
>
> Most of the specific exploits involved tricking the privileged code
> into calling eval() on an attacker-supplied script string, or the
> equivalent using the Script() object. Checks were added in the
> security manager to make sure eval and Script objects are run with the
> privileges of the context that created them, not the potentially
> elevated privileges of the context calling them.
>
> **Workaround**: Disable Javascript


## Affected packages
 - **firefox**
    - **Fixed:** 1.0.3,1
 - **linux-firefox**
    - **Fixed:** 1.0.3
 - **mozilla**
    - **Fixed:** 1.7.7,2
    - **Introduced:** 1.8.*,2
 - **linux-mozilla**
    - **Fixed:** 1.7.7
    - **Introduced:** 1.8.*
 - **linux-mozilla-devel**
    - **Fixed:** 1.7.7
    - **Introduced:** 1.8.*
 - **netscape7**
 - **de-linux-mozillafirebird**
 - **el-linux-mozillafirebird**
 - **ja-linux-mozillafirebird-gtk1**
 - **ja-mozillafirebird-gtk2**
 - **linux-mozillafirebird**
 - **ru-linux-mozillafirebird**
 - **zhCN-linux-mozillafirebird**
 - **zhTW-linux-mozillafirebird**
 - **de-linux-netscape**
 - **de-netscape7**
 - **fr-linux-netscape**
 - **fr-netscape7**
 - **ja-linux-netscape**
 - **ja-netscape7**
 - **linux-netscape**
 - **linux-phoenix**
 - **mozilla+ipv6**
 - **mozilla-embedded**
 - **mozilla-firebird**
 - **mozilla-gtk1**
 - **mozilla-gtk2**
 - **mozilla-gtk**
 - **mozilla-thunderbird**
 - **phoenix**
 - **pt_BR-netscape7**

## Details
 - **published**: 2005-04-16T00:00:00Z
 - **modified**: 2005-04-16T00:00:00Z
 - **discovery**: 2005-04-15T00:00:00Z
 - **vid**: [f650d5b8-ae62-11d9-a788-0001020eed82](https://vuxml.freebsd.org/freebsd/f650d5b8-ae62-11d9-a788-0001020eed82.html)

## References
 - REPORT: [http://www.mozilla.org/security/announce/mfsa2005-41.html](http://www.mozilla.org/security/announce/mfsa2005-41.html)
 - WEB: [http://www.mozilla.org/security/announce/mfsa2005-41.html](http://www.mozilla.org/security/announce/mfsa2005-41.html)
