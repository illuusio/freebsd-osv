# oniguruma -- multiple vulnerabilities
the PHP project reports:

> - A stack out-of-bounds read occurs in match_at() during regular
>   expression searching. A logical error involving order of validation
>   and access in match_at() could result in an out-of-bounds read from
>   a stack buffer (CVE-2017-9224).
> - A heap out-of-bounds write or read occurs in next_state_val() during
>   regular expression compilation. Octal numbers larger than 0xff are
>   not handled correctly in fetch_token() and fetch_token_in_cc(). A
>   malformed regular expression containing an octal number in the form
>   of \'\\700\' would produce an invalid code point value larger than
>   0xff in next_state_val(), resulting in an out-of-bounds write memory
>   corruption (CVE-2017-9226).
> - A stack out-of-bounds read occurs in mbc_enc_len() during regular
>   expression searching. Invalid handling of reg-\>dmin in
>   forward_search_range() could result in an invalid pointer
>   dereference, as an out-of-bounds read from a stack buffer
>   (CVE-2017-9227).
> - A heap out-of-bounds write occurs in bitset_set_range() during
>   regular expression compilation due to an uninitialized variable from
>   an incorrect state transition. An incorrect state transition in
>   parse_char_class() could create an execution path that leaves a
>   critical local variable uninitialized until it\'s used as an index,
>   resulting in an out-of-bounds write memory corruption
>   (CVE-2017-9228).
> - A SIGSEGV occurs in left_adjust_char_head() during regular
>   expression compilation. Invalid handling of reg-\>dmax in
>   forward_search_range() could result in an invalid pointer
>   dereference, normally as an immediate denial-of-service condition
>   (CVE-2017-9228).


## Affected packages
 - **libevhtp**
    - **Fixed:** 1.2.14
 - **oniguruma4**
    - **Fixed:** 4.7.2
 - **oniguruma5**
    - **Fixed:** 5.9.7
 - **oniguruma6**
    - **Fixed:** 6.4.0
 - **php56-mbstring**
    - **Fixed:** 5.6.31
 - **php70-mbstring**
    - **Fixed:** 7.0.21
 - **php71-mbstring**
    - **Fixed:** 7.1.7

## Details
 - **published**: 2017-07-07T00:00:00Z
 - **modified**: 2018-01-04T00:00:00Z
 - **discovery**: 2017-07-06T00:00:00Z
 - **vid**: [b396cf6c-62e6-11e7-9def-b499baebfeaf](https://vuxml.freebsd.org/freebsd/b396cf6c-62e6-11e7-9def-b499baebfeaf.html)

## References
 - REPORT: [http://php.net/ChangeLog-7.php](http://php.net/ChangeLog-7.php)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-9224](https://api.osv.dev/v1/vulns/CVE-2017-9224)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-9226](https://api.osv.dev/v1/vulns/CVE-2017-9226)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-9227](https://api.osv.dev/v1/vulns/CVE-2017-9227)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-9228](https://api.osv.dev/v1/vulns/CVE-2017-9228)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-9228](https://api.osv.dev/v1/vulns/CVE-2017-9228)
