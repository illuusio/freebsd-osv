# rsync -- multiple vulnerabilities
Jeriko One reports:

> The receive_xattr function in xattrs.c in rsync 3.1.2 and
> 3.1.3-development does not check for a trailing \'\\0\' character in
> an xattr name, which allows remote attackers to cause a denial of
> service (heap-based buffer over-read and application crash) or
> possibly have unspecified other impact by sending crafted data to the
> daemon.

> The recv_files function in receiver.c in the daemon in rsync 3.1.2,
> and 3.1.3-development before 2017-12-03, proceeds with certain file
> metadata updates before checking for a filename in the
> daemon_filter_list data structure, which allows remote attackers to
> bypass intended access restrictions.

> The daemon in rsync 3.1.2, and 3.1.3-development before 2017-12-03,
> does not check for fnamecmp filenames in the daemon_filter_list data
> structure (in the recv_files function in receiver.c) and also does not
> apply the sanitize_paths protection mechanism to pathnames found in
> \"xname follows\" strings (in the read_ndx_and_attrs function in
> rsync.c), which allows remote attackers to bypass intended access
> restrictions.


## Affected packages
 - **rsync**
    - **Introduced:** 3.1.2
    - **Fixed:** 3.1.2_7

## Details
 - **published**: 2017-12-20T00:00:00Z
 - **modified**: 2017-12-31T00:00:00Z
 - **discovery**: 2017-12-17T00:00:00Z
 - **vid**: [72fff788-e561-11e7-8097-0800271d4b9c](https://vuxml.freebsd.org/freebsd/72fff788-e561-11e7-8097-0800271d4b9c.html)

## References
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16548](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16548)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17433](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17433)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17434](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17434)
 - ADVISORY: [https://www.debian.org/security/2017/dsa-4068](https://www.debian.org/security/2017/dsa-4068)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-16548](https://api.osv.dev/v1/vulns/CVE-2017-16548)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-17433](https://api.osv.dev/v1/vulns/CVE-2017-17433)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-17434](https://api.osv.dev/v1/vulns/CVE-2017-17434)
 - REPORT: [https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=224477](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=224477)
