# FreeBSD -- OpenSSH multiple vulnerabilities
# Problem Description:

The ssh-agent(1) agent supports loading a PKCS#11 module from outside a
trusted whitelist. An attacker can request loading of a PKCS#11 module
across forwarded agent-socket. \[CVE-2016-10009\]

When privilege separation is disabled, forwarded Unix domain sockets
would be created by sshd(8) with the privileges of \'root\' instead of
the authenticated user. \[CVE-2016-10010\]

# Impact:

A remote attacker who have control of a forwarded agent-socket on a
remote system and have the ability to write files on the system running
ssh-agent(1) agent can run arbitrary code under the same user
credential. Because the attacker must already have some control on both
systems, it is relatively hard to exploit this vulnerability in a
practical attack. \[CVE-2016-10009\]

When privilege separation is disabled (on FreeBSD, privilege separation
is enabled by default and has to be explicitly disabled), an
authenticated attacker can potentially gain root privileges on systems
running OpenSSH server. \[CVE-2016-10010\]


## Affected packages
 - **openssh-portable**
    - **Fixed:** 7.3.p1_5,1
 - **FreeBSD**
    - **Introduced:** 11.0
    - **Fixed:** 11.0_7
    - **Introduced:** 10.3
    - **Fixed:** 10.3_16

## Details
 - **published**: 2017-01-11T00:00:00Z
 - **modified**: 2017-01-13T00:00:00Z
 - **discovery**: 2017-01-11T00:00:00Z
 - **vid**: [2c948527-d823-11e6-9171-14dae9d210b8](https://vuxml.freebsd.org/freebsd/2c948527-d823-11e6-9171-14dae9d210b8.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2016-10009](https://cveawg.mitre.org/api/cve/CVE-2016-10009)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2016-10010](https://cveawg.mitre.org/api/cve/CVE-2016-10010)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-17:01.openssh.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-17:01.openssh.asc)
