# solr -- Code execution via entity expansion
Solr developers report:

> Lucene XML parser does not explicitly prohibit doctype declaration and
> expansion of external entities which leads to arbitrary HTTP requests
> to the local SOLR instance and to bypass all firewall restrictions.
>
> Solr \"RunExecutableListener\" class can be used to execute arbitrary
> commands on specific events, for example after each update query. The
> problem is that such listener can be enabled with any parameters just
> by using Config API with add-listener command.


## Affected packages
 - **apache-solr**
    - **Introduced:** 5.1
    - **Fixed:** 6.6.1
    - **Introduced:** 7.0.0
    - **Fixed:** 7.1

## Details
 - **published**: 2017-10-13T00:00:00Z
 - **modified**: 2017-10-16T00:00:00Z
 - **discovery**: 2017-10-13T00:00:00Z
 - **vid**: [e837390d-0ceb-46b8-9b32-29c1195f5dc7](https://vuxml.freebsd.org/freebsd/e837390d-0ceb-46b8-9b32-29c1195f5dc7.html)

## References
 - REPORT: [http://lucene.472066.n3.nabble.com/Re-Several-critical-vulnerabilities-discovered-in-Apache-Solr-XXE-amp-RCE-td4358308.html](http://lucene.472066.n3.nabble.com/Re-Several-critical-vulnerabilities-discovered-in-Apache-Solr-XXE-amp-RCE-td4358308.html)
 - WEB: [https://marc.info/?l=apache-announce&m=150786685013286](https://marc.info/?l=apache-announce&m=150786685013286)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2017-12629](https://cveawg.mitre.org/api/cve/CVE-2017-12629)
