# nss -- Use-after-free in TLS 1.2 generating handshake hashes
Mozilla reports:

> During TLS 1.2 exchanges, handshake hashes are generated which point
> to a message buffer. This saved data is used for later messages but in
> some cases, the handshake transcript can exceed the space available in
> the current buffer, causing the allocation of a new buffer. This
> leaves a pointer pointing to the old, freed buffer, resulting in a
> use-after-free when handshake hashes are then calculated afterwards.
> This can result in a potentially exploitable crash.


## Affected packages
 - **nss**
    - **Introduced:** 3.32
    - **Fixed:** 3.32.1
    - **Introduced:** 3.28
    - **Fixed:** 3.28.6
 - **linux-c6-nss**
    - **Introduced:** 3.28
    - **Fixed:** 3.28.4_2
 - **linux-c7-nss**
    - **Introduced:** 3.28
    - **Fixed:** 3.28.4_2

## Details
 - **published**: 2017-10-12T00:00:00Z
 - **modified**: 2018-01-29T00:00:00Z
 - **discovery**: 2017-08-04T00:00:00Z
 - **vid**: [e71fd9d3-af47-11e7-a633-009c02a2ab30](https://vuxml.freebsd.org/freebsd/e71fd9d3-af47-11e7-a633-009c02a2ab30.html)

## References
 - REPORT: [https://www.mozilla.org/en-US/security/advisories/mfsa2017-21/#CVE-2017-7805](https://www.mozilla.org/en-US/security/advisories/mfsa2017-21/#CVE-2017-7805)
 - WEB: [https://hg.mozilla.org/projects/nss/rev/2d7b65b72290](https://hg.mozilla.org/projects/nss/rev/2d7b65b72290)
 - WEB: [https://hg.mozilla.org/projects/nss/rev/d3865e2957d0](https://hg.mozilla.org/projects/nss/rev/d3865e2957d0)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-7805](https://api.osv.dev/v1/vulns/CVE-2017-7805)
