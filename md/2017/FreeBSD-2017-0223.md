# OpenVPN -- out-of-bounds write in legacy key-method 1
Steffan Karger reports:

> The bounds check in read_key() was performed after using the value,
> instead of before. If \'key-method 1\' is used, this allowed an
> attacker to send a malformed packet to trigger a stack buffer
> overflow. \[\...\]
>
> Note that \'key-method 1\' has been replaced by \'key method 2\' as
> the default in OpenVPN 2.0 (released on 2005-04-17), and explicitly
> deprecated in 2.4 and marked for removal in 2.5. This should limit the
> amount of users impacted by this issue.


## Affected packages
 - **openvpn-polarssl**
    - **Fixed:** 2.3.18
 - **openvpn-mbedtls**
    - **Introduced:** 2.4.0
    - **Fixed:** 2.4.4
 - **openvpn**
    - **Introduced:** 2.4.0
    - **Fixed:** 2.4.4
    - **Fixed:** 2.3.18

## Details
 - **published**: 2017-09-27T00:00:00Z
 - **modified**: 2017-09-27T00:00:00Z
 - **discovery**: 2017-09-21T00:00:00Z
 - **vid**: [3dd6ccf4-a3c6-11e7-a52e-0800279f2ff8](https://vuxml.freebsd.org/freebsd/3dd6ccf4-a3c6-11e7-a52e-0800279f2ff8.html)

## References
 - REPORT: [https://community.openvpn.net/openvpn/wiki/CVE-2017-12166](https://community.openvpn.net/openvpn/wiki/CVE-2017-12166)
 - WEB: [https://www.mail-archive.com/openvpn-devel@lists.sourceforge.net/msg15492.html](https://www.mail-archive.com/openvpn-devel@lists.sourceforge.net/msg15492.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2017-12166](https://api.osv.dev/v1/vulns/CVE-2017-12166)
