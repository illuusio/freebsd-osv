# bro -- array bounds and potential DOS issues
Corelight reports:

> Bro 2.5.5 primarily addresses security issues:
>
> - Fix array bounds checking in BinPAC: for arrays that are fields
>   within a record, the bounds check was based on a pointer to the
>   start of the record rather than the start of the array field,
>   potentially resulting in a buffer over-read.
> - Fix SMTP command string comparisons: the number of bytes compared
>   was based on the user-supplied string length and can lead to
>   incorrect matches. e.g. giving a command of \"X\" incorrectly
>   matched \"X-ANONYMOUSTLS\" (and an empty commands match anything).
>
> Address potential vectors for Denial of Service:
>
> - \"Weird\" events are now generally suppressed/sampled by default
>   according to some tunable parameters.
> - Improved handling of empty lines in several text protocol analyzers
>   that can cause performance issues when seen in long sequences.
> - Add \`smtp_excessive_pending_cmds\' weird which serves as a
>   notification for when the \"pending command\" queue has reached an
>   upper limit and been cleared to prevent one from attempting to
>   slowly exhaust memory.


## Affected packages
 - **bro**
    - **Fixed:** 2.5.5

## Details
 - **published**: 2018-08-29T00:00:00Z
 - **modified**: 2018-08-29T00:00:00Z
 - **discovery**: 2018-08-28T00:00:00Z
 - **vid**: [d0be41fe-2a20-4633-b057-4e8b25c41780](https://vuxml.freebsd.org/freebsd/d0be41fe-2a20-4633-b057-4e8b25c41780.html)

## References
 - REPORT: [https://www.bro.org/download/NEWS.bro.html](https://www.bro.org/download/NEWS.bro.html)
