# FreeBSD -- ipsec crash or denial of service
# Problem Description:

The length field of the option header does not count the size of the
option header itself. This causes a problem when the length is zero, the
count is then incremented by zero, which causes an infinite loop.

In addition there are pointer/offset mistakes in the handling of IPv4
options.

# Impact:

A remote attacker who is able to send an arbitrary packet, could cause
the remote target machine to crash.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 11.1
    - **Fixed:** 11.1_9
    - **Introduced:** 10.4
    - **Fixed:** 10.4_8
    - **Introduced:** 10.3
    - **Fixed:** 10.3_29

## Details
 - **published**: 2018-04-05T00:00:00Z
 - **modified**: 2018-04-05T00:00:00Z
 - **discovery**: 2018-04-04T00:00:00Z
 - **vid**: [c0c5afef-38db-11e8-8b7f-a4badb2f469b](https://vuxml.freebsd.org/freebsd/c0c5afef-38db-11e8-8b7f-a4badb2f469b.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2018-6918](https://api.osv.dev/v1/vulns/CVE-2018-6918)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-18:05.ipsec.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-18:05.ipsec.asc)
