# FreeBSD -- ipsec validation and use-after-free
# Problem Description:

Due to a lack of strict checking, an attacker from a trusted host can
send a specially constructed IP packet that may lead to a system crash.

Additionally, a use-after-free vulnerability in the AH handling code
could cause unpredictable results.

# Impact:

Access to out of bounds or freed mbuf data can lead to a kernel panic or
other unpredictable results.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 11.1
    - **Fixed:** 11.1_7
    - **Introduced:** 10.4
    - **Fixed:** 10.4_7
    - **Introduced:** 10.3
    - **Fixed:** 10.3_28

## Details
 - **published**: 2018-03-14T00:00:00Z
 - **modified**: 2018-03-14T00:00:00Z
 - **discovery**: 2018-03-07T00:00:00Z
 - **vid**: [dca7ced0-2796-11e8-95ec-a4badb2f4699](https://vuxml.freebsd.org/freebsd/dca7ced0-2796-11e8-95ec-a4badb2f4699.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-6916](https://cveawg.mitre.org/api/cve/CVE-2018-6916)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-18:01.ipsec.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-18:01.ipsec.asc)
