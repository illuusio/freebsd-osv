# tomcat -- Security constraints ignored or applied too late
The Apache Software Foundation reports:

> Security constraints defined by annotations of Servlets were only
> applied once a Servlet had been loaded. Because security constraints
> defined in this way apply to the URL pattern and any URLs below that
> point, it was possible - depending on the order Servlets were loaded -
> for some security constraints not to be applied. This could have
> exposed resources to users who were not authorised to access them.

> The URL pattern of \"\" (the empty string) which exactly maps to the
> context root was not correctly handled when used as part of a security
> constraint definition. This caused the constraint to be ignored. It
> was, therefore, possible for unauthorised users to gain access to web
> application resources that should have been protected. Only security
> constraints with a URL pattern of the empty string were affected.


## Affected packages
 - **tomcat**
    - **Introduced:** 7.0.0
    - **Fixed:** 7.0.84
    - **Introduced:** 8.0.0
    - **Fixed:** 8.0.49
    - **Introduced:** 8.5.0
    - **Fixed:** 8.5.27
    - **Introduced:** 9.0.0
    - **Fixed:** 9.0.4

## Details
 - **published**: 2018-02-23T00:00:00Z
 - **modified**: 2018-02-23T00:00:00Z
 - **discovery**: 2018-02-23T00:00:00Z
 - **vid**: [55c4233e-1844-11e8-a712-0025908740c2](https://vuxml.freebsd.org/freebsd/55c4233e-1844-11e8-a712-0025908740c2.html)

## References
 - REPORT: [https://lists.apache.org/thread.html/d3354bb0a4eda4acc0a66f3eb24a213fdb75d12c7d16060b23e65781@%3Cannounce.tomcat.apache.org%3E](https://lists.apache.org/thread.html/d3354bb0a4eda4acc0a66f3eb24a213fdb75d12c7d16060b23e65781@%3Cannounce.tomcat.apache.org%3E)
 - REPORT: [https://lists.apache.org/thread.html/b1d7e2425d6fd2cebed40d318f9365b44546077e10949b01b1f8a0fb@%3Cannounce.tomcat.apache.org%3E](https://lists.apache.org/thread.html/b1d7e2425d6fd2cebed40d318f9365b44546077e10949b01b1f8a0fb@%3Cannounce.tomcat.apache.org%3E)
 - WEB: [http://tomcat.apache.org/security-9.html](http://tomcat.apache.org/security-9.html)
 - WEB: [http://tomcat.apache.org/security-8.html](http://tomcat.apache.org/security-8.html)
 - WEB: [http://tomcat.apache.org/security-7.html](http://tomcat.apache.org/security-7.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-1304](https://cveawg.mitre.org/api/cve/CVE-2018-1304)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-1305](https://cveawg.mitre.org/api/cve/CVE-2018-1305)
