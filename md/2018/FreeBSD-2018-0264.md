# curl -- multiple vulnerabilities
curl security problems:

> CVE-2018-16839: SASL password overflow via integer overflow
>
> libcurl contains a buffer overrun in the SASL authentication code.
>
> The internal function Curl_auth_create_plain_message fails to
> correctly verify that the passed in lengths for name and password
> aren\'t too long, then calculates a buffer size to allocate.
>
> On systems with a 32 bit size_t, the math to calculate the buffer size
> triggers an integer overflow when the user name length exceeds 2GB
> (2\^31 bytes). This integer overflow usually causes a very small
> buffer to actually get allocated instead of the intended very huge
> one, making the use of that buffer end up in a heap buffer overflow.
>
> This bug is very similar to CVE-2017-14618.
>
> It affects curl 7.33.0 to 7.61.1.
>
> CVE-2018-16840: use-after-free in handle close
>
> libcurl contains a heap use-after-free flaw in code related to closing
> an easy handle.
>
> When closing and cleaning up an \"easy\" handle in the Curl_close()
> function, the library code first frees a struct (without nulling the
> pointer) and might then subsequently erroneously write to a struct
> field within that already freed struct.
>
> It affects curl 7.59.0 to 7.61.1.
>
> CVE-2018-16842: warning message out-of-buffer read
>
> curl contains a heap out of buffer read vulnerability.
>
> The command line tool has a generic function for displaying warning
> and informational messages to stderr for various situations. For
> example if an unknown command line argument is used, or passed to it
> in a \"config\" file.
>
> This display function formats the output to wrap at 80 columns. The
> wrap logic is however flawed, so if a single word in the message is
> itself longer than 80 bytes the buffer arithmetic calculates the
> remainder wrong and will end up reading behind the end of the buffer.
> This could lead to information disclosure or crash.
>
> This vulnerability could lead to a security issue if used in this or
> similar situations:
>
> 1\. a server somewhere uses the curl command line to run something
>
> 2\. if it fails, it shows stderr to the user
>
> 3\. the server takes user input for parts of its command line input
>
> 4\. user provides something overly long that triggers this crash
>
> 5\. the stderr output may now contain user memory contents that
> wasn\'t meant to be available
>
> It affects curl 7.14.1 to 7.61.1.


## Affected packages
 - **curl**
    - **Introduced:** 7.14.1
    - **Fixed:** 7.60.0

## Details
 - **published**: 2018-11-01T00:00:00Z
 - **modified**: 2018-11-01T00:00:00Z
 - **discovery**: 2018-10-31T00:00:00Z
 - **vid**: [e0ab1773-07c1-46c6-9170-4c5e81c00927](https://vuxml.freebsd.org/freebsd/e0ab1773-07c1-46c6-9170-4c5e81c00927.html)

## References
 - REPORT: [https://curl.haxx.se/docs/security.html](https://curl.haxx.se/docs/security.html)
 - WEB: [https://curl.haxx.se/docs/security.html](https://curl.haxx.se/docs/security.html)
 - WEB: [https://curl.haxx.se/docs/CVE-2018-16839.html](https://curl.haxx.se/docs/CVE-2018-16839.html)
 - WEB: [https://curl.haxx.se/docs/CVE-2018-16840.html](https://curl.haxx.se/docs/CVE-2018-16840.html)
 - WEB: [https://curl.haxx.se/docs/CVE-2018-16842.html](https://curl.haxx.se/docs/CVE-2018-16842.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2018-16839](https://api.osv.dev/v1/vulns/CVE-2018-16839)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2018-16840](https://api.osv.dev/v1/vulns/CVE-2018-16840)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2018-16842](https://api.osv.dev/v1/vulns/CVE-2018-16842)
