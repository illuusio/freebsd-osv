# wavpack -- multiple vulnerabilities
Sebastian Ramacher reports:

> A stack-based buffer over-read in the ParseRiffHeaderConfig function
> of cli/riff.c file of WavPack 5.1.0 allows a remote attacker to cause
> a denial-of-service attack or possibly have unspecified other impact
> via a maliciously crafted RF64 file.

> The ParseDsdiffHeaderConfig function of the cli/dsdiff.c file of
> WavPack 5.1.0 allows a remote attacker to cause a denial-of-service
> (heap-based buffer over-read) or possibly overwrite the heap via a
> maliciously crafted DSDIFF file.

> The ParseCaffHeaderConfig function of the cli/caff.c file of WavPack
> 5.1.0 allows a remote attacker to cause a denial-of-service (global
> buffer over-read), or possibly trigger a buffer overflow or incorrect
> memory allocation, via a maliciously crafted CAF file.

Thuan Pham reports:

> An issue was discovered in WavPack 5.1.0 and earlier. The WAV parser
> component contains a vulnerability that allows writing to memory
> because ParseRiffHeaderConfig in riff.c does not reject multiple
> format chunks.

> An issue was discovered in WavPack 5.1.0 and earlier. The W64 parser
> component contains a vulnerability that allows writing to memory
> because ParseWave64HeaderConfig in wave64.c does not reject multiple
> format chunks.

> An issue was discovered in WavPack 5.1.0 and earlier for WAV input.
> Out-of-bounds writes can occur because ParseRiffHeaderConfig in riff.c
> does not validate the sizes of unknown chunks before attempting memory
> allocation, related to a lack of integer-overflow protection within a
> bytes_to_copy calculation and subsequent malloc call, leading to
> insufficient memory allocation.

> An issue was discovered in WavPack 5.1.0 and earlier for DSDiff input.
> Out-of-bounds writes can occur because ParseDsdiffHeaderConfig in
> dsdiff.c does not validate the sizes of unknown chunks before
> attempting memory allocation, related to a lack of integer-overflow
> protection within a bytes_to_copy calculation and subsequent malloc
> call, leading to insufficient memory allocation.

> An issue was discovered in WavPack 5.1.0 and earlier for W64 input.
> Out-of-bounds writes can occur because ParseWave64HeaderConfig in
> wave64.c does not validate the sizes of unknown chunks before
> attempting memory allocation, related to a lack of integer-overflow
> protection within a bytes_to_copy calculation and subsequent malloc
> call, leading to insufficient memory allocation.


## Affected packages
 - **wavpack**
    - **Fixed:** 5.1.0_1

## Details
 - **published**: 2018-05-11T00:00:00Z
 - **modified**: 2018-05-11T00:00:00Z
 - **discovery**: 2018-05-09T00:00:00Z
 - **vid**: [50210bc1-54ef-11e8-95d9-9c5c8e75236a](https://vuxml.freebsd.org/freebsd/50210bc1-54ef-11e8-95d9-9c5c8e75236a.html)

## References
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6767](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6767)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7253](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7253)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7254](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7254)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10536](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10536)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10537](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10537)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10538](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10538)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10539](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10539)
 - REPORT: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10540](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10540)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-6767](https://cveawg.mitre.org/api/cve/CVE-2018-6767)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-7253](https://cveawg.mitre.org/api/cve/CVE-2018-7253)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-7254](https://cveawg.mitre.org/api/cve/CVE-2018-7254)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-10536](https://cveawg.mitre.org/api/cve/CVE-2018-10536)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-10537](https://cveawg.mitre.org/api/cve/CVE-2018-10537)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-10538](https://cveawg.mitre.org/api/cve/CVE-2018-10538)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-10539](https://cveawg.mitre.org/api/cve/CVE-2018-10539)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-10540](https://cveawg.mitre.org/api/cve/CVE-2018-10540)
 - ADVISORY: [https://www.debian.org/security/2018/dsa-4125](https://www.debian.org/security/2018/dsa-4125)
 - ADVISORY: [https://www.debian.org/security/2018/dsa-4197](https://www.debian.org/security/2018/dsa-4197)
