# PostgreSQL -- SQL injection in pg_upgrade and pg_dump
The PostgreSQL project reports:

> CVE-2018-16850: SQL injection in pg_upgrade and pg_dump, via CREATE
> TRIGGER \... REFERENCING.
>
> Using a purpose-crafted trigger definition, an attacker can run
> arbitrary SQL statements with superuser privileges when a superuser
> runs pg_upgrade on the database or during a pg_dump dump/restore
> cycle. This attack requires a CREATE privilege on some non-temporary
> schema or a TRIGGER privilege on a table. This is exploitable in the
> default PostgreSQL configuration, where all users have CREATE
> privilege on public schema.


## Affected packages
 - **postgresql10-server**
    - **Fixed:** 10.6
 - **postgresql96-server**
    - **Fixed:** 9.6.11
 - **postgresql95-server**
    - **Fixed:** 9.5.15
 - **postgresql94-server**
    - **Fixed:** 9.4.20
 - **postgresql93-server**
    - **Fixed:** 9.3.25

## Details
 - **published**: 2018-11-08T00:00:00Z
 - **modified**: 2018-11-08T00:00:00Z
 - **discovery**: 2018-11-08T00:00:00Z
 - **vid**: [1c27a706-e3aa-11e8-b77a-6cc21735f730](https://vuxml.freebsd.org/freebsd/1c27a706-e3aa-11e8-b77a-6cc21735f730.html)

## References
 - REPORT: [https://www.postgresql.org/about/news/1878/](https://www.postgresql.org/about/news/1878/)
 - WEB: [https://www.postgresql.org/about/news/1905/](https://www.postgresql.org/about/news/1905/)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-16850](https://cveawg.mitre.org/api/cve/CVE-2018-16850)
