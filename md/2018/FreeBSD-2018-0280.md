# samba -- multiple vulnerabilities
The samba project reports:

> All versions of Samba from 4.0.0 onwards are vulnerable to infinite
> query recursion caused by CNAME loops. Any dns record can be added via
> ldap by an unprivileged user using the ldbadd tool, so this is a
> security issue.

> When configured to accept smart-card authentication, Samba\'s KDC will
> call talloc_free() twice on the same memory if the principal in a
> validly signed certificate does not match the principal in the AS-REQ.

> During the processing of an LDAP search before Samba\'s AD DC returns
> the LDAP entries to the client, the entries are cached in a single
> memory object with a maximum size of 256MB. When this size is reached,
> the Samba process providing the LDAP service will follow the NULL
> pointer, terminating the process.

> During the processing of an DNS zone in the DNS management DCE/RPC
> server, the internal DNS server or the Samba DLZ plugin for BIND9, if
> the DSPROPERTY_ZONE_MASTER_SERVERS property or
> DSPROPERTY_ZONE_SCAVENGING_SERVERS property is set, the server will
> follow a NULL pointer and terminate

> A user in a Samba AD domain can crash the KDC when Samba is built in
> the non-default MIT Kerberos configuration.

> AD DC Configurations watching for bad passwords (to restrict brute
> forcing of passwords) in a window of more than 3 minutes may not watch
> for bad passwords at all.


## Affected packages
 - **samba46**
    - **Fixed:** 4.6.16
 - **samba47**
    - **Fixed:** 4.7.12
 - **samba48**
    - **Fixed:** 4.8.7
 - **samba49**
    - **Fixed:** 4.9.3

## Details
 - **published**: 2018-08-14T00:00:00Z
 - **modified**: 2018-08-14T00:00:00Z
 - **discovery**: 2018-08-14T00:00:00Z
 - **vid**: [54976998-f248-11e8-81e2-005056a311d1](https://vuxml.freebsd.org/freebsd/54976998-f248-11e8-81e2-005056a311d1.html)

## References
 - REPORT: [https://www.samba.org/samba/security/CVE-2018-14629.html](https://www.samba.org/samba/security/CVE-2018-14629.html)
 - REPORT: [https://www.samba.org/samba/security/CVE-2018-16841.html](https://www.samba.org/samba/security/CVE-2018-16841.html)
 - REPORT: [https://www.samba.org/samba/security/CVE-2018-16851.html](https://www.samba.org/samba/security/CVE-2018-16851.html)
 - REPORT: [https://www.samba.org/samba/security/CVE-2018-16852.html](https://www.samba.org/samba/security/CVE-2018-16852.html)
 - REPORT: [https://www.samba.org/samba/security/CVE-2018-16853.html](https://www.samba.org/samba/security/CVE-2018-16853.html)
 - REPORT: [https://www.samba.org/samba/security/CVE-2018-16857.html](https://www.samba.org/samba/security/CVE-2018-16857.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-14629](https://cveawg.mitre.org/api/cve/CVE-2018-14629)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-16841](https://cveawg.mitre.org/api/cve/CVE-2018-16841)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-16851](https://cveawg.mitre.org/api/cve/CVE-2018-16851)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-16852](https://cveawg.mitre.org/api/cve/CVE-2018-16852)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-16853](https://cveawg.mitre.org/api/cve/CVE-2018-16853)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2018-16857](https://cveawg.mitre.org/api/cve/CVE-2018-16857)
