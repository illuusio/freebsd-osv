# py-tflite -- buffer overflow vulnerability
Thibaut Goetghebuer-Planchon reports:

> The reference kernel of the CONV_3D_TRANSPOSE TensorFlow Lite operator
> wrongly increments the data_ptr when adding the bias to the result.
>
> Instead of \`data_ptr += num_channels;\` it should be \`data_ptr +=
> output_num_channels;\` as if the number of input channels is different
> than the number of output channels, the wrong result will be returned
> and a buffer overflow will occur if num_channels \>
> output_num_channels.
>
> An attacker can craft a model with a specific number of input channels
> in a way similar to the attached example script.
>
> It is then possible to write specific values through the bias of the
> layer outside the bounds of the buffer.
>
> This attack only works if the reference kernel resolver is used in the
> interpreter (i.e.
> \`experimental_op_resolver_type=tf.lite.experimental.OpResolverType.BUILTIN_REF\`
> is used).


## Affected packages
 - **py37-tflite**
    - **Fixed:** 2.8.4
    - **Introduced:** 2.9.0
    - **Fixed:** 2.9.3
    - **Introduced:** 2.10.0
    - **Fixed:** 2.10.1
 - **py38-tflite**
    - **Fixed:** 2.8.4
    - **Introduced:** 2.9.0
    - **Fixed:** 2.9.3
    - **Introduced:** 2.10.0
    - **Fixed:** 2.10.1
 - **py39-tflite**
    - **Fixed:** 2.8.4
    - **Introduced:** 2.9.0
    - **Fixed:** 2.9.3
    - **Introduced:** 2.10.0
    - **Fixed:** 2.10.1
 - **py310-tflite**
    - **Fixed:** 2.8.4
    - **Introduced:** 2.9.0
    - **Fixed:** 2.9.3
    - **Introduced:** 2.10.0
    - **Fixed:** 2.10.1
 - **py311-tflite**
    - **Fixed:** 2.8.4
    - **Introduced:** 2.9.0
    - **Fixed:** 2.9.3
    - **Introduced:** 2.10.0
    - **Fixed:** 2.10.1

## Details
 - **published**: 2023-04-09T00:00:00Z
 - **modified**: 2023-04-09T00:00:00Z
 - **discovery**: 2022-11-21T00:00:00Z
 - **vid**: [326b2f3e-6fc7-4661-955d-a772760db9cf](https://vuxml.freebsd.org/freebsd/326b2f3e-6fc7-4661-955d-a772760db9cf.html)

## References
 - REPORT: [https://osv.dev/vulnerability/GHSA-h6q3-vv32-2cq5](https://osv.dev/vulnerability/GHSA-h6q3-vv32-2cq5)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2022-41894](https://api.osv.dev/v1/vulns/CVE-2022-41894)
 - WEB: [https://osv.dev/vulnerability/GHSA-h6q3-vv32-2cq5](https://osv.dev/vulnerability/GHSA-h6q3-vv32-2cq5)
