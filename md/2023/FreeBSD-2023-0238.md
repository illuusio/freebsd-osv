# FreeBSD -- Stack overflow in ping(8)
# Problem Description:

ping reads raw IP packets from the network to process responses in the
pr_pack() function. As part of processing a response ping has to
reconstruct the IP header, the ICMP header and if present a \"quoted
packet,\" which represents the packet that generated an ICMP error. The
quoted packet again has an IP header and an ICMP header.

The pr_pack() copies received IP and ICMP headers into stack buffers for
further processing. In so doing, it fails to take into account the
possible presence of IP option headers following the IP header in either
the response or the quoted packet. When IP options are present,
pr_pack() overflows the destination buffer by up to 40 bytes.

# Impact:

The memory safety bugs described above can be triggered by a remote
host, causing the ping program to crash.

The ping process runs in a capability mode sandbox on all affected
versions of FreeBSD and is thus very constrained in how it can interact
with the rest of the system at the point where the bug can occur.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 13.1
    - **Fixed:** 13.1_5
    - **Introduced:** 12.3
    - **Fixed:** 12.3_10

## Details
 - **published**: 2023-08-31T00:00:00Z
 - **modified**: 2023-08-31T00:00:00Z
 - **discovery**: 2022-11-29T00:00:00Z
 - **vid**: [a005aea9-47bb-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/a005aea9-47bb-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-23093](https://cveawg.mitre.org/api/cve/CVE-2022-23093)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-22:15.ping.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-22:15.ping.asc)
