# postgresql-server -- Extension script @substitutions@ within quoting allow SQL injection
PostgreSQL Project reports

> An extension script is vulnerable if it uses \@extowner@,
> \@extschema@, or \@extschema:\...@ inside a quoting construct (dollar
> quoting, \'\', or \"\"). No bundled extension is vulnerable.
> Vulnerable uses do appear in a documentation example and in
> non-bundled extensions. Hence, the attack prerequisite is an
> administrator having installed files of a vulnerable, trusted,
> non-bundled extension. Subject to that prerequisite, this enables an
> attacker having database-level CREATE privilege to execute arbitrary
> code as the bootstrap superuser. PostgreSQL will block this attack in
> the core server, so there\'s no need to modify individual extensions.


## Affected packages
 - **postgresql-server**
    - **Fixed:** 11.21
    - **Fixed:** 12.16
    - **Fixed:** 13.12
    - **Fixed:** 14.9
    - **Fixed:** 15.4

## Details
 - **published**: 2023-08-10T00:00:00Z
 - **modified**: 2023-08-10T00:00:00Z
 - **discovery**: 2023-08-10T00:00:00Z
 - **vid**: [cfd2a634-3785-11ee-94b4-6cc21735f730](https://vuxml.freebsd.org/freebsd/cfd2a634-3785-11ee-94b4-6cc21735f730.html)

## References
 - REPORT: [https://www.postgresql.org/support/security/CVE-2023-39417/](https://www.postgresql.org/support/security/CVE-2023-39417/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-39417](https://api.osv.dev/v1/vulns/CVE-2023-39417)
