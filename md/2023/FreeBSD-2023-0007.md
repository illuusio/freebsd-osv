# xorg-server -- Multiple security issues in X server extensions
The X.org project reports:

> - CVE-2022-46340/ZDI-CAN-19265: X.Org Server XTestSwapFakeInput stack
>   overflow
>
>   The swap handler for the XTestFakeInput request of the XTest
>   extension may corrupt the stack if GenericEvents with lengths larger
>   than 32 bytes are sent through a the XTestFakeInput request.
>
>   This issue does not affect systems where client and server use the
>   same byte order.
>
> - CVE-2022-46341/ZDI-CAN-19381: X.Org Server XIPassiveUngrab
>   out-of-bounds access
>
>   The handler for the XIPassiveUngrab request accesses out-of-bounds
>   memory when invoked with a high keycode or button code.
>
> - CVE-2022-46342/ZDI-CAN-19400: X.Org Server XvdiSelectVideoNotify
>   use-after-free
>
>   The handler for the XvdiSelectVideoNotify request may write to
>   memory after it has been freed.
>
> - CVE-2022-46343/ZDI-CAN-19404: X.Org Server ScreenSaverSetAttributes
>   use-after-free
>
>   The handler for the ScreenSaverSetAttributes request may write to
>   memory after it has been freed.
>
> - CVE-2022-46344/ZDI-CAN-19405: X.Org Server XIChangeProperty
>   out-of-bounds access
>
>   The handler for the XIChangeProperty request has a length-validation
>   issues, resulting in out-of-bounds memory reads and potential
>   information disclosure.
>
> - CVE-2022-4283/ZDI-CAN-19530: X.Org Server XkbGetKbdByName
>   use-after-free
>
>   The XkbCopyNames function left a dangling pointer to freed memory,
>   resulting in out-of-bounds memory access on subsequent
>   XkbGetKbdByName requests.


## Affected packages
 - **xorg-server**
    - **Fixed:** 21.1.5,1
 - **xephyr**
    - **Fixed:** 21.1.5,1
 - **xorg-vfbserver**
    - **Fixed:** 21.1.5,1
 - **xorg-nestserver**
    - **Fixed:** 21.1.5,2
 - **xwayland**
    - **Fixed:** 22.1.6,1
 - **xwayland-devel**
    - **Fixed:** 21.0.99.1.319

## Details
 - **published**: 2023-01-11T00:00:00Z
 - **modified**: 2023-01-11T00:00:00Z
 - **discovery**: 2022-12-14T00:00:00Z
 - **vid**: [9fa7b139-c1e9-409e-bed0-006aadcf5845](https://vuxml.freebsd.org/freebsd/9fa7b139-c1e9-409e-bed0-006aadcf5845.html)

## References
 - REPORT: [https://lists.x.org/archives/xorg-announce/2022-December/003302.html](https://lists.x.org/archives/xorg-announce/2022-December/003302.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-46340](https://cveawg.mitre.org/api/cve/CVE-2022-46340)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-46341](https://cveawg.mitre.org/api/cve/CVE-2022-46341)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-46342](https://cveawg.mitre.org/api/cve/CVE-2022-46342)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-46343](https://cveawg.mitre.org/api/cve/CVE-2022-46343)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-46344](https://cveawg.mitre.org/api/cve/CVE-2022-46344)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-4283](https://cveawg.mitre.org/api/cve/CVE-2022-4283)
