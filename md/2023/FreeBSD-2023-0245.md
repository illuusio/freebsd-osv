# FreeBSD -- bhyve privileged guest escape via fwctl
# Problem Description:

The fwctl driver implements a state machine which is executed when the
guest accesses certain x86 I/O ports. The interface lets the guest copy
a string into a buffer resident in the bhyve process\' memory. A bug in
the state machine implementation can result in a buffer overflowing when
copying this string.

# Impact:

A malicious, privileged software running in a guest VM can exploit the
buffer overflow to achieve code execution on the host in the bhyve
userspace process, which typically runs as root. Note that bhyve runs in
a Capsicum sandbox, so malicious code is constrained by the capabilities
available to the bhyve process.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 13.2
    - **Fixed:** 13.2_2
    - **Introduced:** 13.1
    - **Fixed:** 13.1_9

## Details
 - **published**: 2023-08-31T00:00:00Z
 - **modified**: 2023-08-31T00:00:00Z
 - **discovery**: 2023-08-01T00:00:00Z
 - **vid**: [ab437561-47c0-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/ab437561-47c0-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-3494](https://api.osv.dev/v1/vulns/CVE-2023-3494)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-23:07.bhyve.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-23:07.bhyve.asc)
