# py39-unicorn -- sandbox escape and arbitrary code execution vulnerability
jwang-a reports:

> An issue was discovered in split_region in uc.c in Unicorn Engine
> before 2.0.0-rc5.
>
> It allows local attackers to escape the sandbox.
>
> An attacker must first obtain the ability to execute crafted code in
> the target sandbox in order to exploit this vulnerability.
>
> The specific flaw exists within the virtual memory manager.
>
> The issue results from the faulty comparison of GVA and GPA while
> calling uc_mem_map_ptr to free part of a claimed memory block.
>
> An attacker can leverage this vulnerability to escape the sandbox and
> execute arbitrary code on the host machine.


## Affected packages
 - **py39-unicorn**
    - **Fixed:** 2.0.0rc1

## Details
 - **published**: 2023-04-09T00:00:00Z
 - **modified**: 2023-04-09T00:00:00Z
 - **discovery**: 2021-12-26T00:00:00Z
 - **vid**: [17083017-d993-43eb-8aaf-7138f4486d1c](https://vuxml.freebsd.org/freebsd/17083017-d993-43eb-8aaf-7138f4486d1c.html)

## References
 - REPORT: [https://osv.dev/vulnerability/PYSEC-2021-868](https://osv.dev/vulnerability/PYSEC-2021-868)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2021-44078](https://cveawg.mitre.org/api/cve/CVE-2021-44078)
