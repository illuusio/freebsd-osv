# FreeBSD -- GELI silently omits the keyfile if read from stdin
# Problem Description:

When GELI reads a key file from a standard input, it doesn\'t store it
anywhere. If the user tries to initialize multiple providers at once,
for the second and subsequent devices the standard input stream will be
already empty. In this case, GELI silently uses a NULL key as the user
key file. If the user used only a key file without a user passphrase,
the master key was encrypted with an empty key file. This might not be
noticed if the devices were also decrypted in a batch operation.

# Impact:

Some GELI providers might be silently encrypted with a NULL key file.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 13.1
    - **Fixed:** 13.1_6
    - **Introduced:** 12.4
    - **Fixed:** 12.4_1
    - **Introduced:** 12.3
    - **Fixed:** 12.3_11

## Details
 - **published**: 2023-08-31T00:00:00Z
 - **modified**: 2023-08-31T00:00:00Z
 - **discovery**: 2023-02-08T00:00:00Z
 - **vid**: [3fcab88b-47bc-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/3fcab88b-47bc-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2023-0751](https://cveawg.mitre.org/api/cve/CVE-2023-0751)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-23:01.geli.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-23:01.geli.asc)
