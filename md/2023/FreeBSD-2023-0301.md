# FreeBSD -- copy_file_range insufficient capability rights check
# Problem Description:

The syscall checked only for the CAP_READ and CAP_WRITE capabilities on
the input and output file descriptors, respectively. Using an offset is
logically equivalent to seeking, and the syscall must additionally
require the CAP_SEEK capability.

# Impact:

A sandboxed process with only read or write but no seek capability on a
file descriptor may be able to read data from or write data to an
arbitrary location within the file corresponding to that file
descriptor.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 13.2
    - **Fixed:** 13.2_4

## Details
 - **published**: 2023-10-04T00:00:00Z
 - **modified**: 2023-10-04T00:00:00Z
 - **discovery**: 2023-10-03T00:00:00Z
 - **vid**: [e261e71c-6250-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/e261e71c-6250-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-5369](https://api.osv.dev/v1/vulns/CVE-2023-5369)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-23:13.capsicum.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-23:13.capsicum.asc)
