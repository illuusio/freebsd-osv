# prometheus2 -- basic authentication bypass
Prometheus team reports:

> Prometheus and its exporters can be secured by a web.yml file that
> specifies usernames and hashed passwords for basic authentication.
> Passwords are hashed with bcrypt, which means that even if you have
> access to the hash, it is very hard to find the original password
> back. Passwords are hashed with bcrypt, which means that even if you
> have access to the hash, it is very hard to find the original password
> back. However, a flaw in the way this mechanism was implemented in the
> exporter toolkit makes it possible with people who know the hashed
> password to authenticate against Prometheus. A request can be forged
> by an attacker to poison the internal cache used to cache the
> computation of hashes and make subsequent requests successful. This
> cache is used in both happy and unhappy scenarios in order to limit
> side channel attacks that could tell an attacker if a user is present
> in the file or not.


## Affected packages
 - **prometheus**
    - **Fixed:** 0.8.1

## Details
 - **published**: 2023-01-30T00:00:00Z
 - **modified**: 2023-01-30T00:00:00Z
 - **discovery**: 2022-11-28T00:00:00Z
 - **vid**: [791a09c5-a086-11ed-954d-b42e991fc52e](https://vuxml.freebsd.org/freebsd/791a09c5-a086-11ed-954d-b42e991fc52e.html)

## References
 - REPORT: [https://github.com/prometheus/exporter-toolkit/security/advisories/GHSA-7rg2-cxvp-9p7p](https://github.com/prometheus/exporter-toolkit/security/advisories/GHSA-7rg2-cxvp-9p7p)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-46146](https://cveawg.mitre.org/api/cve/CVE-2022-46146)
