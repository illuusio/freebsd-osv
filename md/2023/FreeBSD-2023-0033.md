# node_exporter -- bypass security with cache poisoning
Prometheus team reports:

> Prometheus and its exporters can be secured by a web.yml file that
> specifies usernames and hashed passwords for basic authentication.
> Passwords are hashed with bcrypt, which means that even if you have
> access to the hash, it is very hard to find the original password
> back. Passwords are hashed with bcrypt, which means that even if you
> have access to the hash, it is very hard to find the original password
> back. However, a flaw in the way this mechanism was implemented in the
> exporter toolkit makes it possible with people who know the hashed
> password to authenticate against Prometheus. A request can be forged
> by an attacker to poison the internal cache used to cache the
> computation of hashes and make subsequent requests successful. This
> cache is used in both happy and unhappy scenarios in order to limit
> side channel attacks that could tell an attacker if a user is present
> in the file or not.


## Affected packages
 - **node_exporter**
    - **Fixed:** 1.5.0

## Details
 - **published**: 2023-02-04T00:00:00Z
 - **modified**: 2023-02-04T00:00:00Z
 - **discovery**: 2021-11-28T00:00:00Z
 - **vid**: [d835c54f-a4bd-11ed-b6af-b42e991fc52e](https://vuxml.freebsd.org/freebsd/d835c54f-a4bd-11ed-b6af-b42e991fc52e.html)

## References
 - REPORT: [https://github.com/prometheus/exporter-toolkit/security/advisories/GHSA-7rg2-cxvp-9p7p](https://github.com/prometheus/exporter-toolkit/security/advisories/GHSA-7rg2-cxvp-9p7p)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2022-46146](https://api.osv.dev/v1/vulns/CVE-2022-46146)
 - ADVISORY: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-46146](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-46146)
