# openvpn -- 2.6.0...2.6.6 --fragment option division by zero crash, and TLS data leak
The OpenVPN community project team reports:

> CVE-2023-46849 OpenVPN versions between 2.6.0 and 2.6.6 incorrectly
> restore \"\--fragment\" configuration in some circumstances, leading
> to a division by zero when \"\--fragment\" is used. On platforms where
> division by zero is fatal, this will cause an OpenVPN crash.\
> Reported by Niccolo Belli and WIPocket (Github #400, #417).
>
> CVE-2023-46850 OpenVPN versions between 2.6.0 and 2.6.6 incorrectly
> use a send buffer after it has been free()d in some circumstances,
> causing some free()d memory to be sent to the peer. All configurations
> using TLS (e.g. not using \--secret) are affected by this issue.
> (found while tracking down CVE-2023-46849 / Github #400, #417)


## Affected packages
 - **openvpn**
    - **Introduced:** 2.6.0
    - **Fixed:** 2.6.7_1
 - **openvpn-devel**
    - **Fixed:** g20231109,1

## Details
 - **published**: 2023-11-15T00:00:00Z
 - **modified**: 2023-12-31T00:00:00Z
 - **discovery**: 2023-08-29T00:00:00Z
 - **vid**: [2fe004f5-83fd-11ee-9f5d-31909fb2f495](https://vuxml.freebsd.org/freebsd/2fe004f5-83fd-11ee-9f5d-31909fb2f495.html)

## References
 - REPORT: [https://github.com/OpenVPN/openvpn/blob/v2.6.7/Changes.rst#overview-of-changes-in-267](https://github.com/OpenVPN/openvpn/blob/v2.6.7/Changes.rst#overview-of-changes-in-267)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-46849](https://api.osv.dev/v1/vulns/CVE-2023-46849)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-46850](https://api.osv.dev/v1/vulns/CVE-2023-46850)
