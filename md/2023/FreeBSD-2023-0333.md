# FreeBSD -- libc stdio buffer overflow
# Problem Description:

For line-buffered streams the \_\_sflush() function did not correctly
update the FILE object\'s write space member when the write(2) system
call returns an error.

# Impact:

Depending on the nature of an application that calls libc\'s stdio
functions and the presence of errors returned from the write(2) system
call (or an overridden stdio write routine) a heap buffer overfly may
occur. Such overflows may lead to data corruption or the execution of
arbitrary code at the privilege level of the calling program.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 13.2
    - **Fixed:** 13.2_5
    - **Introduced:** 12.4
    - **Fixed:** 12.4_7

## Details
 - **published**: 2023-11-08T00:00:00Z
 - **modified**: 2023-11-08T00:00:00Z
 - **discovery**: 2023-11-08T00:00:00Z
 - **vid**: [5afcc9a4-7e04-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/5afcc9a4-7e04-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-5941](https://api.osv.dev/v1/vulns/CVE-2023-5941)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-23:15.stdio.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-23:15.stdio.asc)
