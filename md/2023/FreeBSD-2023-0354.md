# FreeBSD -- TCP spoofing vulnerability in pf(4)
# Problem Description:

As part of its stateful TCP connection tracking implementation, pf
performs sequence number validation on inbound packets. This makes it
difficult for a would-be attacker to spoof the sender and inject packets
into a TCP stream, since crafted packets must contain sequence numbers
which match the current connection state to avoid being rejected by the
firewall.

A bug in the implementation of sequence number validation means that the
sequence number is not in fact validated, allowing an attacker who is
able to impersonate the remote host and guess the connection\'s port
numbers to inject packets into the TCP stream.

# Impact:

An attacker can, with relatively little effort, inject packets into a
TCP stream destined to a host behind a pf firewall. This could be used
to implement a denial-of-service attack for hosts behind the firewall,
for example by sending TCP RST packets to the host.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 14.0
    - **Fixed:** 14.0_2
    - **Introduced:** 13.2
    - **Fixed:** 13.2_4
    - **Introduced:** 12.4
    - **Fixed:** 12.4_6

## Details
 - **published**: 2023-12-05T00:00:00Z
 - **modified**: 2023-12-14T00:00:00Z
 - **discovery**: 2023-12-05T00:00:00Z
 - **vid**: [9cbbc506-93c1-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/9cbbc506-93c1-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-6534](https://api.osv.dev/v1/vulns/CVE-2023-6534)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-23:17.pf.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-23:17.pf.asc)
