# FreeBSD -- Wi-Fi encryption bypass
# Problem Description:

The net80211 subsystem would fallback to the multicast key for unicast
traffic in the event the unicast key was removed. This would result in
buffered unicast traffic being exposed to any stations with access to
the multicast key.

# Impact:

As described in the \"Framing Frames: Bypassing Wi-Fi Encryption by
Manipulating Transmit Queues\" paper, an attacker can induce an access
point to buffer frames for a client, deauthenticate the client (causing
the unicast key to be removed from the access point), and subsequent
flushing of the buffered frames now encrypted with the multicast key.
This would give the attacker access to the data.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 13.2
    - **Fixed:** 13.2_3
    - **Introduced:** 12.4
    - **Fixed:** 12.4_5

## Details
 - **published**: 2023-09-07T00:00:00Z
 - **modified**: 2023-09-07T00:00:00Z
 - **discovery**: 2023-09-06T00:00:00Z
 - **vid**: [924cb116-4d35-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/924cb116-4d35-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2022-47522](https://api.osv.dev/v1/vulns/CVE-2022-47522)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-23:11.wifi.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-23:11.wifi.asc)
