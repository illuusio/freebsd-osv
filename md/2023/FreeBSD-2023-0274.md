# FreeBSD -- pf incorrectly handles multiple IPv6 fragment headers
# Problem Description:

With a \'scrub fragment reassemble\' rule, a packet containing multiple
IPv6 fragment headers would be reassembled, and then immediately
processed. That is, a packet with multiple fragment extension headers
would not be recognized as the correct ultimate payload. Instead a
packet with multiple IPv6 fragment headers would unexpectedly be
interpreted as a fragmented packet, rather than as whatever the real
payload is.

# Impact:

IPv6 fragments may bypass firewall rules written on the assumption all
fragments have been reassembled and, as a result, be forwarded or
processed by the host.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 13.2
    - **Fixed:** 13.2_3
    - **Introduced:** 12.4
    - **Fixed:** 12.4_5

## Details
 - **published**: 2023-09-07T00:00:00Z
 - **modified**: 2023-09-07T00:00:00Z
 - **discovery**: 2023-09-06T00:00:00Z
 - **vid**: [d35373ae-4d34-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/d35373ae-4d34-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-4809](https://api.osv.dev/v1/vulns/CVE-2023-4809)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-23:10.pf.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-23:10.pf.asc)
