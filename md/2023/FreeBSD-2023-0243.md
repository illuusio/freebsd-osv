# FreeBSD -- ssh-add does not honor per-hop destination constraints
# Problem Description:

When using ssh-add(1) to add smartcard keys to ssh-agent(1) with per-hop
destination constraints, a logic error prevented the constraints from
being sent to the agent resulting in keys being added to the agent
without constraints.

# Impact:

A malicious server could leverage the keys provided by a forwarded agent
that would normally not be allowed due to the logic error.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 12.4
    - **Fixed:** 12.4_3

## Details
 - **published**: 2023-08-31T00:00:00Z
 - **modified**: 2023-08-31T00:00:00Z
 - **discovery**: 2023-06-21T00:00:00Z
 - **vid**: [e31a8f8e-47bf-11ee-8e38-002590c1f29c](https://vuxml.freebsd.org/freebsd/e31a8f8e-47bf-11ee-8e38-002590c1f29c.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2023-28531](https://api.osv.dev/v1/vulns/CVE-2023-28531)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-23:05.openssh.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-23:05.openssh.asc)
