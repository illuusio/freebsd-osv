# rubygem-cgi -- HTTP response splitting vulnerability
Hiroshi Tokumaru reports:

> If an application that generates HTTP responses using the cgi gem with
> untrusted user input, an attacker can exploit it to inject a malicious
> HTTP response header and/or body.
>
> Also, the contents for a `CGI::Cookie` object were not checked
> properly. If an application creates a `CGI::Cookie` object based on
> user input, an attacker may exploit it to inject invalid attributes in
> `Set-Cookie` header. We think such applications are unlikely, but we
> have included a change to check arguments for `CGI::Cookie#initialize`
> preventatively.


## Affected packages
 - **rubygem-cgi**
    - **Fixed:** 0.3.4
 - **ruby**
    - **Introduced:** 2.7.0,1
    - **Fixed:** 2.7.7,1
    - **Introduced:** 3.0.0,1
    - **Fixed:** 3.0.5,1
    - **Introduced:** 3.1.0,1
    - **Fixed:** 3.1.3,1
    - **Introduced:** 3.2.0.p1,1
    - **Fixed:** 3.2.0.r1,1
 - **ruby27**
    - **Introduced:** 2.7.0,1
    - **Fixed:** 2.7.7,1
 - **ruby30**
    - **Introduced:** 3.0.0,1
    - **Fixed:** 3.0.5,1
 - **ruby31**
    - **Introduced:** 3.1.0,1
    - **Fixed:** 3.1.3,1
 - **ruby32**
    - **Introduced:** 3.2.0.p1,1
    - **Fixed:** 3.2.0.r1,1

## Details
 - **published**: 2022-11-24T00:00:00Z
 - **modified**: 2022-11-24T00:00:00Z
 - **discovery**: 2022-11-22T00:00:00Z
 - **vid**: [84ab03b6-6c20-11ed-b519-080027f5fec9](https://vuxml.freebsd.org/freebsd/84ab03b6-6c20-11ed-b519-080027f5fec9.html)

## References
 - REPORT: [https://www.ruby-lang.org/en/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/](https://www.ruby-lang.org/en/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2021-33621](https://api.osv.dev/v1/vulns/CVE-2021-33621)
 - WEB: [https://www.ruby-lang.org/en/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/](https://www.ruby-lang.org/en/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/)
