# FreeBSD -- Out of bound read in elf_note_prpsinfo()
# Problem Description:

When dumping core and saving process information, proc_getargv() might
return an sbuf which have a sbuf_len() of 0 or -1, which is not properly
handled.

# Impact:

An out-of-bound read can happen when user constructs a specially crafted
ps_string, which in turn can cause the kernel to crash.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 13.1
    - **Fixed:** 13.1_1
    - **Introduced:** 13.0
    - **Fixed:** 13.0_12
    - **Introduced:** 12.3
    - **Fixed:** 12.3_6

## Details
 - **published**: 2022-08-10T00:00:00Z
 - **modified**: 2022-08-10T00:00:00Z
 - **discovery**: 2022-08-09T00:00:00Z
 - **vid**: [5028c1ae-1890-11ed-9b22-002590c1f29c](https://vuxml.freebsd.org/freebsd/5028c1ae-1890-11ed-9b22-002590c1f29c.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-23089](https://cveawg.mitre.org/api/cve/CVE-2022-23089)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-22:09.elf.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-22:09.elf.asc)
