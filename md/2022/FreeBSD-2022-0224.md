# Grafana -- Privilege escalation
Grafana Labs reports:

> Internal security audit identified a race condition in the Grafana
> codebase, which allowed an unauthenticated user to query an arbitrary
> endpoint in Grafana. A race condition in the [HTTP
> context](https://github.com/grafana/grafana/blob/main/pkg/web/router.go#L153)
> creation could make a HTTP request being assigned the
> authentication/authorization middlewares of another call. Under heavy
> load it is possible that a call protected by a privileged middleware
> receives instead the middleware of a public query. As a result, an
> unauthenticated user can successfully query protected endpoints.
>
> The CVSS score for this vulnerability is 9.8 Critical


## Affected packages
 - **grafana**
    - **Introduced:** 9.2.0
    - **Fixed:** 9.2.4
 - **grafana9**
    - **Introduced:** 9.2.0
    - **Fixed:** 9.2.4

## Details
 - **published**: 2022-11-12T00:00:00Z
 - **modified**: 2022-11-12T00:00:00Z
 - **discovery**: 2022-11-08T00:00:00Z
 - **vid**: [db895ed0-6298-11ed-9ca2-6c3be5272acd](https://vuxml.freebsd.org/freebsd/db895ed0-6298-11ed-9ca2-6c3be5272acd.html)

## References
 - REPORT: [https://grafana.com/blog/2022/11/08/security-release-new-versions-of-grafana-with-critical-and-moderate-fixes-for-cve-2022-39328-cve-2022-39307-and-cve-2022-39306/](https://grafana.com/blog/2022/11/08/security-release-new-versions-of-grafana-with-critical-and-moderate-fixes-for-cve-2022-39328-cve-2022-39307-and-cve-2022-39306/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2022-39328](https://api.osv.dev/v1/vulns/CVE-2022-39328)
 - WEB: [https://github.com/grafana/grafana/security/advisories/GHSA-vqc4-mpj8-jxch](https://github.com/grafana/grafana/security/advisories/GHSA-vqc4-mpj8-jxch)
