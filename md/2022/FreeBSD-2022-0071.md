# FreeBSD -- Potential jail escape vulnerabilities in netmap
# Problem Description:

The total size of the user-provided nmreq to nmreq_copyin() was first
computed and then trusted during the copyin. This time-of-check to
time-of-use bug could lead to kernel memory corruption.
\[CVE-2022-23084\]

A user-provided integer option was passed to nmreq_copyin() without
checking if it would overflow. This insufficient bounds checking could
lead to kernel memory corruption. \[CVE-2022-23085\]

# Impact:

On systems configured to include netmap in their devfs_ruleset, a
privileged process running in a jail can affect the host environment.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 13.0
    - **Fixed:** 13.0_11
    - **Introduced:** 12.3
    - **Fixed:** 12.3_5

## Details
 - **published**: 2022-04-07T00:00:00Z
 - **modified**: 2022-04-07T00:00:00Z
 - **discovery**: 2022-04-06T00:00:00Z
 - **vid**: [27d39055-b61b-11ec-9ebc-1c697aa5a594](https://vuxml.freebsd.org/freebsd/27d39055-b61b-11ec-9ebc-1c697aa5a594.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-23084](https://cveawg.mitre.org/api/cve/CVE-2022-23084)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-23085](https://cveawg.mitre.org/api/cve/CVE-2022-23085)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-22:04.netmap.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-22:04.netmap.asc)
