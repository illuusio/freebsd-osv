# FreeBSD -- Missing bounds check in 9p message handling
# Problem Description:

The implementation of lib9p\'s handling of RWALK messages was missing a
bounds check needed when unpacking the message contents. The missing
check means that the receipt of a specially crafted message will cause
lib9p to overwrite unrelated memory.

# Impact:

The bug can be triggered by a malicious bhyve guest kernel to overwrite
memory in the bhyve(8) process. This could potentially lead to user-mode
code execution on the host, subject to bhyve\'s Capsicum sandbox.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 13.1
    - **Fixed:** 13.1_1
    - **Introduced:** 13.0
    - **Fixed:** 13.0_12

## Details
 - **published**: 2022-08-10T00:00:00Z
 - **modified**: 2022-08-10T00:00:00Z
 - **discovery**: 2022-08-09T00:00:00Z
 - **vid**: [8eaaf135-1893-11ed-9b22-002590c1f29c](https://vuxml.freebsd.org/freebsd/8eaaf135-1893-11ed-9b22-002590c1f29c.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-23092](https://cveawg.mitre.org/api/cve/CVE-2022-23092)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-22:12.lib9p.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-22:12.lib9p.asc)
