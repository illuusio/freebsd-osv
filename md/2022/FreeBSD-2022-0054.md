# OpenSSL -- Infinite loop in BN_mod_sqrt parsing certificates
The OpenSSL project reports:

> Infinite loop in BN_mod_sqrt() reachable when parsing certificates
> (High)
>
> The BN_mod_sqrt() function, which computes a modular square root,
> contains a bug that can cause it to loop forever for non-prime moduli.
>
> Internally this function is used when parsing certificates that
> contain elliptic curve public keys in compressed form or explicit
> elliptic curve parameters with a base point encoded in compressed
> form.
>
> It is possible to trigger the infinite loop by crafting a certificate
> that has invalid explicit curve parameters.
>
> Since certificate parsing happens prior to verification of the
> certificate signature, any process that parses an externally supplied
> certificate may thus be subject to a denial of service attack. The
> infinite loop can also be reached when parsing crafted private keys as
> they can contain explicit elliptic curve parameters.
>
> Thus vulnerable situations include:
>
> - TLS clients consuming server certificates
> - TLS servers consuming client certificates
> - Hosting providers taking certificates or private keys from customers
> - Certificate authorities parsing certification requests from
>   subscribers
> - Anything else which parses ASN.1 elliptic curve parameters
>
> Also any other applications that use the BN_mod_sqrt() where the
> attacker can control the parameter values are vulnerable to this DoS
> issue.


## Affected packages
 - **openssl**
    - **Fixed:** 1.1.1n,1
 - **openssl-devel**
    - **Fixed:** 3.0.2
 - **openssl-quictls**
    - **Fixed:** 3.0.2
 - **libressl**
    - **Fixed:** 3.4.3
 - **libressl-devel**
    - **Fixed:** 3.5.1
 - **FreeBSD**
    - **Introduced:** 13.0
    - **Fixed:** 13.0_8
    - **Introduced:** 12.3
    - **Fixed:** 12.3_3
    - **Introduced:** 12.2
    - **Fixed:** 12.2_14

## Details
 - **published**: 2022-03-16T00:00:00Z
 - **modified**: 2022-03-16T00:00:00Z
 - **discovery**: 2022-03-15T00:00:00Z
 - **vid**: [ea05c456-a4fd-11ec-90de-1c697aa5a594](https://vuxml.freebsd.org/freebsd/ea05c456-a4fd-11ec-90de-1c697aa5a594.html)

## References
 - REPORT: [https://www.openssl.org/news/secadv/20220315.txt](https://www.openssl.org/news/secadv/20220315.txt)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2022-0778](https://api.osv.dev/v1/vulns/CVE-2022-0778)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-22:03.openssl.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-22:03.openssl.asc)
