# uriparser -- Multiple vulnerabilities
Upstream project reports:

> Fix a bug affecting both uriNormalizeSyntax\* and uriMakeOwner\*
> functions where the text range in .hostText would not be duped using
> malloc but remain unchanged (and hence \"not owned\") for URIs with an
> IPv4 or IPv6 address hostname; depending on how an application uses
> uriparser, this could lead the application into a use-after-free
> situation. As the second half, fix uriFreeUriMembers\* functions that
> would not free .hostText memory for URIs with an IPv4 or IPv6 address
> host; also, calling uriFreeUriMembers\* multiple times on a URI of
> this very nature would result in trying to free pointers to stack
> (rather than heap) memory. Fix functions uriNormalizeSyntax\* for
> out-of-memory situations (i.e. malloc returning NULL) for URIs
> containing empty segments (any of user info, host text, query, or
> fragment) where previously pointers to stack (rather than heap) memory
> were freed.


## Affected packages
 - **uriparser**
    - **Fixed:** 0.9.6

## Details
 - **published**: 2022-01-09T00:00:00Z
 - **modified**: 2022-01-09T00:00:00Z
 - **discovery**: 2022-01-06T00:00:00Z
 - **vid**: [b927b654-7146-11ec-ad4b-5404a68ad561](https://vuxml.freebsd.org/freebsd/b927b654-7146-11ec-ad4b-5404a68ad561.html)

## References
 - REPORT: [https://github.com/uriparser/uriparser/blob/uriparser-0.9.6/ChangeLog](https://github.com/uriparser/uriparser/blob/uriparser-0.9.6/ChangeLog)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2021-46141](https://cveawg.mitre.org/api/cve/CVE-2021-46141)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2021-46142](https://cveawg.mitre.org/api/cve/CVE-2021-46142)
