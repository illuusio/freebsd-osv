# Ruby -- Double free in Regexp compilation
piao reports:

> Due to a bug in the Regexp compilation process, creating a Regexp
> object with a crafted source string could cause the same memory to be
> freed twice. This is known as a \"double free\" vulnerability. Note
> that, in general, it is considered unsafe to create and use a Regexp
> object generated from untrusted input. In this case, however,
> following a comprehensive assessment, we treat this issue as a
> vulnerability.


## Affected packages
 - **ruby**
    - **Introduced:** 3.0.0,1
    - **Fixed:** 3.0.4,1
    - **Introduced:** 3.1.0,1
    - **Fixed:** 3.1.2,1
    - **Introduced:** 3.2.0.p1,1
    - **Fixed:** 3.2.0.p1_1,1
 - **ruby30**
    - **Introduced:** 3.0.0,1
    - **Fixed:** 3.0.4,1
 - **ruby31**
    - **Introduced:** 3.1.0,1
    - **Fixed:** 3.1.2,1
 - **ruby32**
    - **Introduced:** 3.2.0.p1,1
    - **Fixed:** 3.2.0.p1_1,1

## Details
 - **published**: 2022-04-13T00:00:00Z
 - **modified**: 2022-04-13T00:00:00Z
 - **discovery**: 2022-04-12T00:00:00Z
 - **vid**: [f22144d7-bad1-11ec-9cfe-0800270512f4](https://vuxml.freebsd.org/freebsd/f22144d7-bad1-11ec-9cfe-0800270512f4.html)

## References
 - REPORT: [https://www.ruby-lang.org/en/news/2022/04/12/double-free-in-regexp-compilation-cve-2022-28738/](https://www.ruby-lang.org/en/news/2022/04/12/double-free-in-regexp-compilation-cve-2022-28738/)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2022-28738](https://api.osv.dev/v1/vulns/CVE-2022-28738)
