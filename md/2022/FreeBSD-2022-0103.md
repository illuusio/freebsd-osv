# PostgreSQL Server -- execute arbitrary SQL code as DBA user
The PostgreSQL project reports:

> Confine additional operations within \"security restricted operation\"
> sandboxes.
>
> Autovacuum, CLUSTER, CREATE INDEX, REINDEX, REFRESH MATERIALIZED VIEW,
> and pg_amcheck activated the \"security restricted operation\"
> protection mechanism too late, or even not at all in some code paths.
> A user having permission to create non-temporary objects within a
> database could define an object that would execute arbitrary SQL code
> with superuser permissions the next time that autovacuum processed the
> object, or that some superuser ran one of the affected commands
> against it.


## Affected packages
 - **postgresql14-server**
    - **Fixed:** 14.3
 - **postgresql13-server**
    - **Fixed:** 13.7
 - **postgresql12-server**
    - **Fixed:** 12.11
 - **postgresql11-server**
    - **Fixed:** 11.16
 - **postgresql10-server**
    - **Fixed:** 10.21

## Details
 - **published**: 2022-05-11T00:00:00Z
 - **modified**: 2022-05-11T00:00:00Z
 - **discovery**: 2022-05-11T00:00:00Z
 - **vid**: [157ce083-d145-11ec-ab9b-6cc21735f730](https://vuxml.freebsd.org/freebsd/157ce083-d145-11ec-ab9b-6cc21735f730.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2022-1552](https://api.osv.dev/v1/vulns/CVE-2022-1552)
