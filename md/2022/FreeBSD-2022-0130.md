# Node.js -- July 7th 2022 Security Releases
Node.js reports:

> # HTTP Request Smuggling - Flawed Parsing of Transfer-Encoding (Medium)(CVE-2022-32213)
>
> The llhttp parser in the http module does not correctly parse and
> validate Transfer-Encoding headers. This can lead to HTTP Request
> Smuggling (HRS).
>
> # HTTP Request Smuggling - Improper Delimiting of Header Fields (Medium)(CVE-2022-32214)
>
> The llhttp parser in the http module does not strictly use the CRLF
> sequence to delimit HTTP requests. This can lead to HTTP Request
> Smuggling (HRS).
>
> # HTTP Request Smuggling - Incorrect Parsing of Multi-line Transfer-Encoding (Medium)(CVE-2022-32215)
>
> The llhttp parser in the http module does not correctly handle
> multi-line Transfer-Encoding headers. This can lead to HTTP Request
> Smuggling (HRS).
>
> # DNS rebinding in \--inspect via invalid IP addresses (High)(CVE-2022-32212)
>
> The IsAllowedHost check can easily be bypassed because IsIPAddress
> does not properly check if an IP address is invalid or not. When an
> invalid IPv4 address is provided (for instance 10.0.2.555 is
> provided), browsers (such as Firefox) will make DNS requests to the
> DNS server, providing a vector for an attacker-controlled DNS server
> or a MITM who can spoof DNS responses to perform a rebinding attack
> and hence connect to the WebSocket debugger, allowing for arbitrary
> code execution. This is a bypass of CVE-2021-22884.
>
> # Attempt to read openssl.cnf from /home/iojs/build/ upon startup (Medium)(CVE-2022-32222)
>
> When Node.js starts on linux based systems, it attempts to read
> /home/iojs/build/ws/out/Release/obj.target/deps/openssl/openssl.cnf,
> which ordinarily doesn\'t exist. On some shared systems an attacker
> may be able create this file and therefore affect the default OpenSSL
> configuration for other users.
>
> # OpenSSL - AES OCB fails to encrypt some bytes (Medium)(CVE-2022-2097)
>
> AES OCB mode for 32-bit x86 platforms using the AES-NI assembly
> optimised implementation will not encrypt the entirety of the data
> under some circumstances. This could reveal sixteen bytes of data that
> was preexisting in the memory that wasn\'t written. In the special
> case of \"in place\" encryption, sixteen bytes of the plaintext would
> be revealed. Since OpenSSL does not support OCB based cipher suites
> for TLS and DTLS, they are both unaffected.


## Affected packages
 - **node**
    - **Introduced:** 14.0.0
    - **Fixed:** 14.20.0
    - **Introduced:** 16.0.0
    - **Fixed:** 16.16.0
    - **Introduced:** 18.0.0
    - **Fixed:** 18.5.0
 - **node16**
    - **Fixed:** 16.16.0
 - **node14**
    - **Fixed:** 14.20.0

## Details
 - **published**: 2022-07-08T00:00:00Z
 - **modified**: 2022-07-08T00:00:00Z
 - **discovery**: 2022-07-05T00:00:00Z
 - **vid**: [b9210706-feb0-11ec-81fa-1c697a616631](https://vuxml.freebsd.org/freebsd/b9210706-feb0-11ec-81fa-1c697a616631.html)

## References
 - REPORT: [https://nodejs.org/en/blog/vulnerability/july-2022-security-releases/](https://nodejs.org/en/blog/vulnerability/july-2022-security-releases/)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-32212](https://cveawg.mitre.org/api/cve/CVE-2022-32212)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-32213](https://cveawg.mitre.org/api/cve/CVE-2022-32213)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-32214](https://cveawg.mitre.org/api/cve/CVE-2022-32214)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-32215](https://cveawg.mitre.org/api/cve/CVE-2022-32215)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-32222](https://cveawg.mitre.org/api/cve/CVE-2022-32222)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2022-2097](https://cveawg.mitre.org/api/cve/CVE-2022-2097)
