# FreeBSD -- netgraph / bluetooth privilege escalation
# Problem Description:

Some function pointers for netgraph and bluetooth sockets are not
properly initialized.

# Impact:

A local user can cause the FreeBSD kernel to execute arbitrary code.
This could be used by an attacker directly; or it could be used to gain
root privilege or to escape from a jail.

# Workaround:

No workaround is available, but systems without local untrusted users
are not vulnerable. Furthermore, systems are not vulnerable if they have
neither the ng_socket nor ng_bluetooth kernel modules loaded or compiled
into the kernel.

Systems with the security.jail.socket_unixiproute_only sysctl set to 1
(the default) are only vulnerable if they have local untrusted users
outside of jails.

If the command

`# kldstat -v | grep ng_`

produces no output, the system is not vulnerable.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.3
    - **Fixed:** 6.3_7
    - **Introduced:** 6.4
    - **Fixed:** 6.4_1
    - **Introduced:** 7.0
    - **Fixed:** 7.0_7

## Details
 - **published**: 2009-01-05T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2008-12-23T00:00:00Z
 - **vid**: [c702944a-db0f-11dd-aa56-000bcdf0a03b](https://vuxml.freebsd.org/freebsd/c702944a-db0f-11dd-aa56-000bcdf0a03b.html)

## References
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-08:13.protosw.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-08:13.protosw.asc)
