# FreeBSD -- kqueue pipe race conditions
# Problem Description

A race condition exists in the pipe close() code relating to kqueues,
causing use-after-free for kernel memory, which may lead to an
exploitable NULL pointer vulnerability in the kernel, kernel memory
corruption, and other unpredictable results.

# Impact:

Successful exploitation of the race condition can lead to local kernel
privilege escalation, kernel data corruption and/or crash.

To exploit this vulnerability, an attacker must be able to run code on
the target system.

# Workaround

An errata notice, FreeBSD-EN-09:05.null has been released simultaneously
to this advisory, and contains a kernel patch implementing a workaround
for a more broad class of vulnerabilities. However, prior to those
changes, no workaround is available.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.3
    - **Fixed:** 6.4_7
    - **Introduced:** 6.4
    - **Fixed:** 6.3_13

## Details
 - **published**: 2009-10-06T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2009-10-02T00:00:00Z
 - **vid**: [90d2e58f-b25a-11de-8c83-02e0185f8d72](https://vuxml.freebsd.org/freebsd/90d2e58f-b25a-11de-8c83-02e0185f8d72.html)

## References
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-09:13.pipe.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-09:13.pipe.asc)
