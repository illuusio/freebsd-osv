# salt -- multiple vulnerabilities in salt-master process
F-Secure reports:

> ### CVE-2020-11651 - Authentication bypass vulnerabilities
>
> The ClearFuncs class processes unauthenticated requests and
> unintentionally exposes the \_send_pub() method, which can be used to
> queue messages directly on the master publish server. Such messages
> can be used to trigger minions to run arbitrary commands as root.
>
> The ClearFuncs class also exposes the method \_prep_auth_info(), which
> returns the \"root key\" used to authenticate commands from the local
> root user on the master server. This \"root key\" can then be used to
> remotely call administrative commands on the master server. This
> unintentional exposure provides a remote un-authenticated attacker
> with root-equivalent access to the salt master.
>
> ### CVE-2020-11652 - Directory traversal vulnerabilities
>
> The wheel module contains commands used to read and write files under
> specific directory paths. The inputs to these functions are
> concatenated with the target directory and the resulting path is not
> canonicalized, leading to an escape of the intended path restriction.
>
> The get_token() method of the salt.tokens.localfs class (which is
> exposed to unauthenticated requests by the ClearFuncs class) fails to
> sanitize the token input parameter which is then used as a filename,
> allowing insertion of \"..\" path elements and thus reading of files
> outside of the intended directory. The only restriction is that the
> file has to be deserializable by salt.payload.Serial.loads().


## Affected packages
 - **py27-salt**
    - **Fixed:** 2019.2.4
    - **Introduced:** 3000
    - **Fixed:** 3000.2
 - **py32-salt**
    - **Fixed:** 2019.2.4
    - **Introduced:** 3000
    - **Fixed:** 3000.2
 - **py33-salt**
    - **Fixed:** 2019.2.4
    - **Introduced:** 3000
    - **Fixed:** 3000.2
 - **py34-salt**
    - **Fixed:** 2019.2.4
    - **Introduced:** 3000
    - **Fixed:** 3000.2
 - **py35-salt**
    - **Fixed:** 2019.2.4
    - **Introduced:** 3000
    - **Fixed:** 3000.2
 - **py36-salt**
    - **Fixed:** 2019.2.4
    - **Introduced:** 3000
    - **Fixed:** 3000.2
 - **py37-salt**
    - **Fixed:** 2019.2.4
    - **Introduced:** 3000
    - **Fixed:** 3000.2
 - **py38-salt**
    - **Fixed:** 2019.2.4
    - **Introduced:** 3000
    - **Fixed:** 3000.2

## Details
 - **published**: 2020-05-16T00:00:00Z
 - **modified**: 2020-05-16T00:00:00Z
 - **discovery**: 2020-04-30T00:00:00Z
 - **vid**: [6bf55af9-973b-11ea-9f2c-38d547003487](https://vuxml.freebsd.org/freebsd/6bf55af9-973b-11ea-9f2c-38d547003487.html)

## References
 - REPORT: [https://labs.f-secure.com/advisories/saltstack-authorization-bypass](https://labs.f-secure.com/advisories/saltstack-authorization-bypass)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-11651](https://api.osv.dev/v1/vulns/CVE-2020-11651)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-11652](https://api.osv.dev/v1/vulns/CVE-2020-11652)
 - ADVISORY: [https://nvd.nist.gov/vuln/detail/CVE-2020-11651](https://nvd.nist.gov/vuln/detail/CVE-2020-11651)
 - ADVISORY: [https://nvd.nist.gov/vuln/detail/CVE-2020-11652](https://nvd.nist.gov/vuln/detail/CVE-2020-11652)
 - WEB: [https://docs.saltstack.com/en/latest/topics/releases/2019.2.4.html](https://docs.saltstack.com/en/latest/topics/releases/2019.2.4.html)
 - WEB: [https://blog.f-secure.com/new-vulnerabilities-make-exposed-salt-hosts-easy-targets/](https://blog.f-secure.com/new-vulnerabilities-make-exposed-salt-hosts-easy-targets/)
 - WEB: [https://www.tenable.com/blog/cve-2020-11651-cve-2020-11652-critical-salt-framework-vulnerabilities-exploited-in-the-wild](https://www.tenable.com/blog/cve-2020-11651-cve-2020-11652-critical-salt-framework-vulnerabilities-exploited-in-the-wild)
