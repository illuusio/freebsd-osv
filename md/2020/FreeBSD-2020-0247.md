# FreeBSD -- bhyve privilege escalation via VMCS access
# Problem Description:

AMD and Intel CPUs support hardware virtualization using specialized
data structures that control various aspects of guest operation. These
are the Virtual Machine Control Structure (VMCS) on Intel CPUs, and the
Virtual Machine Control Block (VMCB) on AMD CPUs. Insufficient access
controls allow root users, including those running in a jail, to change
these data structures.

# Impact:

An attacker with host root access (including to a jailed bhyve instance)
can use this vulnerability to achieve kernel code execution.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.1
    - **Fixed:** 12.1_10
    - **Introduced:** 11.4
    - **Fixed:** 11.4_4
    - **Introduced:** 11.3
    - **Fixed:** 11.3_14

## Details
 - **published**: 2020-09-16T00:00:00Z
 - **modified**: 2020-09-16T00:00:00Z
 - **discovery**: 2020-09-15T00:00:00Z
 - **vid**: [2c5b9cd7-f7e6-11ea-88f8-901b0ef719ab](https://vuxml.freebsd.org/freebsd/2c5b9cd7-f7e6-11ea-88f8-901b0ef719ab.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-24718](https://api.osv.dev/v1/vulns/CVE-2020-24718)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-20:28.bhyve_vmcs.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-20:28.bhyve_vmcs.asc)
