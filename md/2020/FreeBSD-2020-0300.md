# FreeBSD -- ICMPv6 use-after-free in error message handling
# Problem Description:

When an ICMPv6 error message is received, the FreeBSD ICMPv6 stack may
extract information from the message to hand to upper-layer protocols.
As a part of this operation, it may parse IPv6 header options from a
packet embedded in the ICMPv6 message.

The handler for a routing option caches a pointer into the packet buffer
holding the ICMPv6 message. However, when processing subsequent options
the packet buffer may be freed, rendering the cached pointer invalid.
The network stack may later dereference the pointer, potentially
triggering a use-after-free.

# Impact:

A remote host may be able to trigger a read of freed kernel memory. This
may trigger a kernel panic if the address had been unmapped.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.2
    - **Fixed:** 12.2_1
    - **Introduced:** 12.1
    - **Fixed:** 12.1_11
    - **Introduced:** 11.4
    - **Fixed:** 11.4_5

## Details
 - **published**: 2020-12-02T00:00:00Z
 - **modified**: 2020-12-02T00:00:00Z
 - **discovery**: 2020-12-01T00:00:00Z
 - **vid**: [8eed0c5c-3482-11eb-b87a-901b0ef719ab](https://vuxml.freebsd.org/freebsd/8eed0c5c-3482-11eb-b87a-901b0ef719ab.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-7469](https://api.osv.dev/v1/vulns/CVE-2020-7469)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-20:31.icmp6.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-20:31.icmp6.asc)
