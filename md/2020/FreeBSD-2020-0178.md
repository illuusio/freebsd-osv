# FreeBSD -- posix_spawnp(3) buffer overflow
# Problem Description:

posix_spawnp spawns a new thread with a limited stack allocated on the
heap before delegating to execvp for the final execution within that
thread.

execvp would previously make unbounded allocations on the stack,
directly proportional to the length of the user-controlled PATH
environment variable.

# Impact:

Long values in the user-controlled PATH environment variable cause
posix_spawnp to write beyond the end of stack that was allocated,
ultimately overflowing the heap-allocated stack with a direct copy of
the value stored in PATH.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 11.4
    - **Fixed:** 11.4_1

## Details
 - **published**: 2020-07-10T00:00:00Z
 - **modified**: 2020-07-10T00:00:00Z
 - **discovery**: 2020-07-09T00:00:00Z
 - **vid**: [f8b46415-c264-11ea-8659-901b0ef719ab](https://vuxml.freebsd.org/freebsd/f8b46415-c264-11ea-8659-901b0ef719ab.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-7458](https://api.osv.dev/v1/vulns/CVE-2020-7458)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-20:18.posix_spawnp.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-20:18.posix_spawnp.asc)
