# Mbed TLS -- Side-channel attack on ECC key import and validation
Manuel Pégourié-Gonnard reports:

> The scalar multiplication function in Mbed TLS accepts a random number
> generator (RNG) as an optional argument and, if provided, uses it to
> protect against some attacks.
>
> It is the caller\'s responsibility to provide a RNG if protection
> against side-channel attacks is desired; however two groups of
> functions in Mbed TLS itself fail to pass a RNG:
>
> 1.  mbedtls_pk_parse_key() and mbedtls_pk_parse_keyfile()
> 2.  mbedtls_ecp_check_pub_priv() and mbedtls_pk_check_pair()
>
> When those functions are called, scalar multiplication is computed
> without randomisation, a number of old and new attacks apply, allowing
> a powerful local attacker to fully recover the private key.


## Affected packages
 - **mbedtls**
    - **Fixed:** 2.16.7

## Details
 - **published**: 2020-07-07T00:00:00Z
 - **modified**: 2020-07-07T00:00:00Z
 - **discovery**: 2020-07-01T00:00:00Z
 - **vid**: [c685edd9-c045-11ea-8898-001cc0382b2f](https://vuxml.freebsd.org/freebsd/c685edd9-c045-11ea-8898-001cc0382b2f.html)

## References
 - REPORT: [https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2020-07](https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2020-07)
