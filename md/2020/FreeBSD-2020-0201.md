# FreeBSD -- sendmsg(2) privilege escalation
# Problem Description:

When handling a 32-bit sendmsg(2) call, the compat32 subsystem copies
the control message to be transmitted (if any) into kernel memory, and
adjusts alignment of control message headers. The code which performs
this work contained a time-of-check to time-of-use (TOCTOU)
vulnerability which allows a malicious userspace program to modify
control message headers after they were validated by the kernel.

# Impact:

The TOCTOU bug can be exploited by an unprivileged malicious userspace
program to trigger privilege escalation.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.1
    - **Fixed:** 12.1_8
    - **Introduced:** 11.4
    - **Fixed:** 11.4_2
    - **Introduced:** 11.3
    - **Fixed:** 11.3_12

## Details
 - **published**: 2020-08-06T00:00:00Z
 - **modified**: 2020-08-06T00:00:00Z
 - **discovery**: 2020-08-05T00:00:00Z
 - **vid**: [8db74c04-d794-11ea-88f8-901b0ef719ab](https://vuxml.freebsd.org/freebsd/8db74c04-d794-11ea-88f8-901b0ef719ab.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2020-7460](https://api.osv.dev/v1/vulns/CVE-2020-7460)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-20:23.sendmsg.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-20:23.sendmsg.asc)
