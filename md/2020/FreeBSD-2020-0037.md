# OpenSMTPd -- LPE and RCE in OpenSMTPD's default install
OpenSMTPD developers reports:

> An out of bounds read in smtpd allows an attacker to inject arbitrary
> commands into the envelope file which are then executed as root.
> Separately, missing privilege revocation in smtpctl allows arbitrary
> commands to be run with the \_smtpq group.
>
> An unprivileged local attacker can read the first line of an arbitrary
> file (for example, root\'s password hash in /etc/master.passwd) or the
> entire contents of another user\'s file (if this file and
> /var/spool/smtpd/ are on the same filesystem).


## Affected packages
 - **opensmtpd**
    - **Fixed:** 6.6.4,1

## Details
 - **published**: 2020-02-24T00:00:00Z
 - **modified**: 2020-02-27T00:00:00Z
 - **discovery**: 2020-02-22T00:00:00Z
 - **vid**: [f0683976-5779-11ea-8a77-1c872ccb1e42](https://vuxml.freebsd.org/freebsd/f0683976-5779-11ea-8a77-1c872ccb1e42.html)

## References
 - REPORT: [https://opensmtpd.org/security.html](https://opensmtpd.org/security.html)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2020-8793](https://cveawg.mitre.org/api/cve/CVE-2020-8793)
 - WEB: [https://www.openwall.com/lists/oss-security/2020/02/24/4](https://www.openwall.com/lists/oss-security/2020/02/24/4)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2020-8794](https://cveawg.mitre.org/api/cve/CVE-2020-8794)
 - WEB: [https://www.openwall.com/lists/oss-security/2020/02/24/5](https://www.openwall.com/lists/oss-security/2020/02/24/5)
