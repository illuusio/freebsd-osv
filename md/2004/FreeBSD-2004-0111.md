# Courier mail services: remotely exploitable buffer overflows
The Courier set of mail services use a common Unicode library. This
library contains buffer overflows in the converters for two popular
Japanese character encodings. These overflows may be remotely
exploitable, triggered by a maliciously formatted email message that is
later processed by one of the Courier mail services. From the release
notes for the corrected versions of the Courier set of mail services:

> iso2022jp.c: Converters became (upper-)compatible with ISO-2022-JP
> (RFC1468 / JIS X 0208:1997 Annex 2) and ISO-2022-JP-1 (RFC2237).
> Buffer overflow vulnerability (when Unicode character is out of BMP
> range) has been closed. Convert error handling was implemented.
>
> shiftjis.c: Broken SHIFT_JIS converters has been fixed and became
> (upper-)compatible with Shifted Encoding Method (JIS X 0208:1997 Annex
> 1). Buffer overflow vulnerability (when Unicode character is out of
> BMP range) has been closed. Convert error handling was implemented.


## Affected packages
 - **courier**
    - **Fixed:** 0.45
 - **courier-imap**
    - **Fixed:** 3.0,1
 - **sqwebmail**
    - **Fixed:** 4.0

## Details
 - **published**: 2004-03-31T00:00:00Z
 - **modified**: 2004-07-16T00:00:00Z
 - **discovery**: 2004-02-01T00:00:00Z
 - **vid**: [98bd69c3-834b-11d8-a41f-0020ed76ef5a](https://vuxml.freebsd.org/freebsd/98bd69c3-834b-11d8-a41f-0020ed76ef5a.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2004-0224](https://cveawg.mitre.org/api/cve/CVE-2004-0224)
 - WEB: [http://cvs.sourceforge.net/viewcvs.py/courier/libs/unicode/iso2022jp.c?rev=1.10&view=markup](http://cvs.sourceforge.net/viewcvs.py/courier/libs/unicode/iso2022jp.c?rev=1.10&view=markup)
 - WEB: [http://cvs.sourceforge.net/viewcvs.py/courier/libs/unicode/shiftjis.c?rev=1.6&view=markup](http://cvs.sourceforge.net/viewcvs.py/courier/libs/unicode/shiftjis.c?rev=1.6&view=markup)
 - ADVISORY: [https://www.securityfocus.com/bid/9845/info](https://www.securityfocus.com/bid/9845/info)
 - WEB: [http://secunia.com/advisories/11087](http://secunia.com/advisories/11087)
 - WEB: [http://www.osvdb.org/4194](http://www.osvdb.org/4194)
 - WEB: [http://www.osvdb.org/6927](http://www.osvdb.org/6927)
