# Cyrus IMAPd -- PARTIAL command out of bounds memory corruption
Due to a bug within the argument parser of the partial command an
argument like \"body\[p\" will be wrongly detected as \"body.peek\".
Because of this the bufferposition gets increased by 10 instead of 5 and
could therefore point outside the allocated memory buffer for the rest
of the parsing process. In imapd versions prior to 2.2.7 the handling of
\"body\" or \"bodypeek\" arguments was broken so that the terminating
\'\]\' got overwritten by a \'\\0\'. Combined the two problems allow a
potential attacker to overwrite a single byte of malloc() control
structures, which leads to remote code execution if the attacker
successfully controls the heap layout.


## Affected packages
 - **cyrus-imapd**
    - **Fixed:** 2.1.17
    - **Introduced:** 2.2.*
    - **Fixed:** 2.2.6

## Details
 - **published**: 2004-11-22T00:00:00Z
 - **modified**: 2004-11-24T00:00:00Z
 - **discovery**: 2004-11-06T00:00:00Z
 - **vid**: [114d70f3-3d16-11d9-8818-008088034841](https://vuxml.freebsd.org/freebsd/114d70f3-3d16-11d9-8818-008088034841.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2004-1012](https://cveawg.mitre.org/api/cve/CVE-2004-1012)
 - WEB: [http://security.e-matters.de/advisories/152004.html](http://security.e-matters.de/advisories/152004.html)
