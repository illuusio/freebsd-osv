# shmat reference counting bug
A programming error in the
[shmat(2)](http://www.freebsd.org/cgi/man.cgi?query=shmat) system call
can result in a shared memory segment\'s reference count being
erroneously incremented.

It may be possible to cause a shared memory segment to reference
unallocated kernel memory, but remain valid. This could allow a local
attacker to gain read or write access to a portion of kernel memory,
resulting in sensitive information disclosure, bypass of access control
mechanisms, or privilege escalation.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 5.2
    - **Fixed:** 5.2_2
    - **Introduced:** 5.1
    - **Fixed:** 5.1_14
    - **Introduced:** 5.0
    - **Fixed:** 5.0_20
    - **Introduced:** 4.9
    - **Fixed:** 4.9_2
    - **Introduced:** 4.8
    - **Fixed:** 4.8_15
    - **Fixed:** 4.7_25

## Details
 - **published**: 2004-04-07T00:00:00Z
 - **modified**: 2004-05-05T00:00:00Z
 - **discovery**: 2004-02-01T00:00:00Z
 - **vid**: [f95a9005-88ae-11d8-90d1-0020ed76ef5a](https://vuxml.freebsd.org/freebsd/f95a9005-88ae-11d8-90d1-0020ed76ef5a.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2004-0114](https://api.osv.dev/v1/vulns/CVE-2004-0114)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-04:02.shmat.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-04:02.shmat.asc)
 - WEB: [http://www.pine.nl/press/pine-cert-20040201.txt](http://www.pine.nl/press/pine-cert-20040201.txt)
