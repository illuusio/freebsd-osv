# php -- memory_limit related vulnerability
Stefan Esser of e-matters discovered a condition within PHP that may
lead to remote execution of arbitrary code. The memory_limit facility is
used to notify functions when memory contraints have been met. Under
certain conditions, the entry into this facility is able to interrupt
functions such as zend_hash_init() at locations not suitable for
interruption. The result would leave these functions in a vulnerable
state.

> An attacker that is able to trigger the memory_limit abort within
> zend_hash_init() and is additionally able to control the heap before
> the HashTable itself is allocated, is able to supply his own HashTable
> destructor pointer. \[\...\]
>
> All mentioned places outside of the extensions are quite easy to
> exploit, because the memory allocation up to those places is
> deterministic and quite static throughout different PHP versions.
> \[\...\]
>
> Because the exploit itself consist of supplying an arbitrary
> destructor pointer this bug is exploitable on any platform.


## Affected packages
 - **mod_php4-twig**
    - **Fixed:** 4.3.7_3
 - **php4**
    - **Fixed:** 4.3.7_3
 - **php4-cgi**
    - **Fixed:** 4.3.7_3
 - **php4-cli**
    - **Fixed:** 4.3.7_3
 - **php4-dtc**
    - **Fixed:** 4.3.7_3
 - **php4-horde**
    - **Fixed:** 4.3.7_3
 - **php4-nms**
    - **Fixed:** 4.3.7_3
 - **mod_php4**
    - **Fixed:** 4.3.7_3,1
 - **php5**
    - **Fixed:** 5.0.0.r3_2
 - **php5-cgi**
    - **Fixed:** 5.0.0.r3_2
 - **php5-cli**
    - **Fixed:** 5.0.0.r3_2
 - **mod_php5**
    - **Fixed:** 5.0.0.r3_2,1

## Details
 - **published**: 2004-09-27T00:00:00Z
 - **modified**: 2004-10-02T00:00:00Z
 - **discovery**: 2004-07-07T00:00:00Z
 - **vid**: [dd7aa4f1-102f-11d9-8a8a-000c41e2cdad](https://vuxml.freebsd.org/freebsd/dd7aa4f1-102f-11d9-8a8a-000c41e2cdad.html)

## References
 - REPORT: [http://security.e-matters.de/advisories/112004.html](http://security.e-matters.de/advisories/112004.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2004-0594](https://api.osv.dev/v1/vulns/CVE-2004-0594)
 - DISCUSSION: [http://marc.theaimsgroup.com/?l=bugtraq&m=108981780109154](http://marc.theaimsgroup.com/?l=bugtraq&m=108981780109154)
 - WEB: [http://security.e-matters.de/advisories/112004.html](http://security.e-matters.de/advisories/112004.html)
 - ADVISORY: [https://www.securityfocus.com/bid/10725/info](https://www.securityfocus.com/bid/10725/info)
