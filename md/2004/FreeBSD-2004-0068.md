# mksnap_ffs clears file system options
The kernel interface for creating a snapshot of a filesystem is the same
as that for changing the flags on that filesystem. Due to an oversight,
the [mksnap_ffs(8)](http://www.freebsd.org/cgi/man.cgi?query=mksnap_ffs)
command called that interface with only the snapshot flag set, causing
all other flags to be reset to the default value.

A regularly scheduled backup of a live filesystem, or any other process
that uses the mksnap_ffs command (for instance, to provide a rough
undelete functionality on a file server), will clear any flags in effect
on the filesystem being snapshot. Possible consequences depend on local
usage, but can include disabling extended access control lists or
enabling the use of setuid executables stored on an untrusted
filesystem.

The mksnap_ffs command is normally only available to the superuser and
members of the \`operator\' group. There is therefore no risk of a user
gaining elevated privileges directly through use of the mksnap_ffs
command unless it has been intentionally made available to unprivileged
users.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 5.2
    - **Fixed:** 5.2_1
    - **Introduced:** 5.1
    - **Fixed:** 5.1_12

## Details
 - **published**: 2004-04-07T00:00:00Z
 - **modified**: 2004-05-05T00:00:00Z
 - **discovery**: 2004-01-30T00:00:00Z
 - **vid**: [7229d900-88af-11d8-90d1-0020ed76ef5a](https://vuxml.freebsd.org/freebsd/7229d900-88af-11d8-90d1-0020ed76ef5a.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2004-0099](https://cveawg.mitre.org/api/cve/CVE-2004-0099)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-04:01.mksnap_ffs.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-04:01.mksnap_ffs.asc)
