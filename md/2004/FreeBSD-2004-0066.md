# jailed processes can attach to other jails
A programming error has been found in the
[jail_attach(2)](http://www.freebsd.org/cgi/man.cgi?query=jail_attach)
system call which affects the way that system call verifies the
privilege level of the calling process. Instead of failing immediately
if the calling process was already jailed, the jail_attach system call
would fail only after changing the calling process\'s root directory.

A process with superuser privileges inside a jail could change its root
directory to that of a different jail, and thus gain full read and write
access to files and directories within the target jail.


## Affected packages
 - **FreeBSD**
    - **Introduced:** 5.1
    - **Fixed:** 5.1_14
    - **Introduced:** 5.2
    - **Fixed:** 5.2.1

## Details
 - **published**: 2004-04-07T00:00:00Z
 - **modified**: 2004-05-05T00:00:00Z
 - **discovery**: 2004-02-19T00:00:00Z
 - **vid**: [9082a85a-88ae-11d8-90d1-0020ed76ef5a](https://vuxml.freebsd.org/freebsd/9082a85a-88ae-11d8-90d1-0020ed76ef5a.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2004-0126](https://api.osv.dev/v1/vulns/CVE-2004-0126)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-04:03.jail.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-04:03.jail.asc)
