# mysql -- mysql_real_connect buffer overflow vulnerability
The mysql_real_connect function doesn\'t properly handle DNS replies by
copying the IP address into a buffer without any length checking. A
specially crafted DNS reply may therefore be used to cause a buffer
overflow on affected systems.

Note that whether this issue can be exploitable depends on the system
library responsible for the gethostbyname function. The bug finder,
Lukasz Wojtow, explaines this with the following words:

> In glibc there is a limitation for an IP address to have only 4 bytes
> (obviously), but generally speaking the length of the address comes
> with a response for dns query (i know it sounds funny but read rfc1035
> if you don\'t believe). This bug can occur on libraries where
> gethostbyname function takes length from dns\'s response


## Affected packages
 - **mysql-server**
    - **Fixed:** 3.23.58_3
    - **Introduced:** 4.*
    - **Fixed:** 4.0.21
 - **mysql-client**
    - **Fixed:** 3.23.58_3
    - **Introduced:** 4.*
    - **Fixed:** 4.0.21

## Details
 - **published**: 2004-12-16T00:00:00Z
 - **modified**: 2005-03-15T00:00:00Z
 - **discovery**: 2004-06-04T00:00:00Z
 - **vid**: [835256b8-46ed-11d9-8ce0-00065be4b5b6](https://vuxml.freebsd.org/freebsd/835256b8-46ed-11d9-8ce0-00065be4b5b6.html)

## References
 - REPORT: [http://bugs.mysql.com/bug.php?id=4017](http://bugs.mysql.com/bug.php?id=4017)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2004-0836](https://cveawg.mitre.org/api/cve/CVE-2004-0836)
 - ADVISORY: [https://www.securityfocus.com/bid/10981/info](https://www.securityfocus.com/bid/10981/info)
 - WEB: [http://lists.mysql.com/internals/14726](http://lists.mysql.com/internals/14726)
 - WEB: [http://rhn.redhat.com/errata/RHSA-2004-611.html](http://rhn.redhat.com/errata/RHSA-2004-611.html)
 - WEB: [http://www.osvdb.org/displayvuln.php?osvdb_id=10658](http://www.osvdb.org/displayvuln.php?osvdb_id=10658)
