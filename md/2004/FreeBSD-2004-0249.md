# Cyrus IMAPd -- FETCH command out of bounds memory corruption
The argument parser of the fetch command suffers a bug very similiar to
the partial command problem. Arguments like \"body\[p\", \"binary\[p\"
or \"binary\[p\" will be wrongly detected and the bufferposition can
point outside of the allocated buffer for the rest of the parsing
process. When the parser triggers the PARSE_PARTIAL macro after such a
malformed argument was received this can lead to a similiar one byte
memory corruption and allows remote code execution, when the heap layout
was successfully controlled by the attacker.


## Affected packages
 - **cyrus-imapd**
    - **Fixed:** 2.1.17
    - **Introduced:** 2.2.*
    - **Fixed:** 2.2.8

## Details
 - **published**: 2004-11-22T00:00:00Z
 - **modified**: 2004-11-24T00:00:00Z
 - **discovery**: 2004-11-06T00:00:00Z
 - **vid**: [c0a269d5-3d16-11d9-8818-008088034841](https://vuxml.freebsd.org/freebsd/c0a269d5-3d16-11d9-8818-008088034841.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2004-1013](https://api.osv.dev/v1/vulns/CVE-2004-1013)
 - WEB: [http://security.e-matters.de/advisories/152004.html](http://security.e-matters.de/advisories/152004.html)
