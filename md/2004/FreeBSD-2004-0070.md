# heimdal kadmind remote heap buffer overflow
An input validation error was discovered in the kadmind code that
handles the framing of Kerberos 4 compatibility administration requests.
The code assumed that the length given in the framing was always two or
more bytes. Smaller lengths will cause kadmind to read an arbitrary
amount of data into a minimally-sized buffer on the heap.

A remote attacker may send a specially formatted message to kadmind,
causing it to crash or possibly resulting in arbitrary code execution.

The kadmind daemon is part of Kerberos 5 support. However, this bug will
only be present if kadmind was built with additional Kerberos 4 support.
Thus, only systems that have \*both\* Heimdal Kerberos 5 and Kerberos 4
installed might be affected.

*NOTE:* On FreeBSD 4 systems, \`kadmind\' may be installed as
\`k5admind\'.


## Affected packages
 - **heimdal**
    - **Fixed:** 0.6.1_1
 - **FreeBSD**
    - **Introduced:** 4.9
    - **Fixed:** 4.9_7
    - **Introduced:** 4.0
    - **Fixed:** 4.8_20

## Details
 - **published**: 2004-05-05T00:00:00Z
 - **modified**: 2004-05-05T00:00:00Z
 - **discovery**: 2004-05-05T00:00:00Z
 - **vid**: [446dbecb-9edc-11d8-9366-0020ed76ef5a](https://vuxml.freebsd.org/freebsd/446dbecb-9edc-11d8-9366-0020ed76ef5a.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2004-0434](https://api.osv.dev/v1/vulns/CVE-2004-0434)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-04:09.kadmind.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-04:09.kadmind.asc)
