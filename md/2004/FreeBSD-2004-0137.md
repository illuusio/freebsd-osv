# tnftpd -- remotely exploitable vulnerability
lukemftpd(8) is an enhanced BSD FTP server produced within the NetBSD
project. The sources for lukemftpd are shipped with some versions of
FreeBSD, however it is not built or installed by default. The build
system option WANT_LUKEMFTPD must be set to build and install lukemftpd.
\[**NOTE**: An exception is FreeBSD 4.7-RELEASE, wherein lukemftpd was
installed, but not enabled, by default.\]

Przemyslaw Frasunek discovered several vulnerabilities in lukemftpd
arising from races in the out-of-band signal handling code used to
implement the ABOR command. As a result of these races, the internal
state of the FTP server may be manipulated in unexpected ways.

A remote attacker may be able to cause FTP commands to be executed with
the privileges of the running lukemftpd process. This may be a
low-privilege \`ftp\' user if the \`-r\' command line option is
specified, or it may be superuser privileges if \`-r\' is \*not\*
specified.


## Affected packages
 - **tnftpd**
    - **Fixed:** 20040810
 - **lukemftpd**
 - **FreeBSD**
    - **Fixed:** 4.7

## Details
 - **published**: 2004-08-17T00:00:00Z
 - **modified**: 2016-08-11T00:00:00Z
 - **discovery**: 2004-08-17T00:00:00Z
 - **vid**: [c4b025bb-f05d-11d8-9837-000c41e2cdad](https://vuxml.freebsd.org/freebsd/c4b025bb-f05d-11d8-9837-000c41e2cdad.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2004-0794](https://cveawg.mitre.org/api/cve/CVE-2004-0794)
 - ADVISORY: [https://www.securityfocus.com/bid/10967/info](https://www.securityfocus.com/bid/10967/info)
 - WEB: [http://cvsweb.netbsd.org/bsdweb.cgi/src/libexec/ftpd/ftpd.c#rev1.158](http://cvsweb.netbsd.org/bsdweb.cgi/src/libexec/ftpd/ftpd.c#rev1.158)
 - WEB: [ftp://ftp.netbsd.org/pub/NetBSD/security/advisories/NetBSD-SA2004-009.txt.asc](ftp://ftp.netbsd.org/pub/NetBSD/security/advisories/NetBSD-SA2004-009.txt.asc)
 - DISCUSSION: [http://lists.netsys.com/pipermail/full-disclosure/2004-August/025418.html](http://lists.netsys.com/pipermail/full-disclosure/2004-August/025418.html)
