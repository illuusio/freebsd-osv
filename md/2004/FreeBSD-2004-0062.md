# Incorrect cross-realm trust handling in Heimdal
Heimdal does not correctly validate the \`transited\' field of Kerberos
tickets when computing the authentication path. This could allow a rogue
KDC with which cross-realm relationships have been established to
impersonate any KDC in the authentication path.


## Affected packages
 - **heimdal**
    - **Fixed:** 0.6.1
 - **FreeBSD**
    - **Introduced:** 5.0
    - **Fixed:** 5.2_6
    - **Introduced:** 4.9
    - **Fixed:** 4.9_6
    - **Introduced:** 4.0
    - **Fixed:** 4.8_19

## Details
 - **published**: 2004-04-02T00:00:00Z
 - **modified**: 2004-05-05T00:00:00Z
 - **discovery**: 2004-04-01T00:00:00Z
 - **vid**: [bfb36941-84fa-11d8-a41f-0020ed76ef5a](https://vuxml.freebsd.org/freebsd/bfb36941-84fa-11d8-a41f-0020ed76ef5a.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2004-0371](https://cveawg.mitre.org/api/cve/CVE-2004-0371)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-04:08.heimdal.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-04:08.heimdal.asc)
 - WEB: [http://www.pdc.kth.se/heimdal/advisory/2004-04-01/](http://www.pdc.kth.se/heimdal/advisory/2004-04-01/)
