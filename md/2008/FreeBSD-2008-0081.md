# FreeBSD -- DNS cache poisoning
# Problem Description:

The BIND DNS implementation does not randomize the UDP source port when
doing remote queries, and the query id alone does not provide adequate
randomization.

# Impact:

The lack of source port randomization reduces the amount of data the
attacker needs to guess in order to successfully execute a DNS cache
poisoning attack. This allows the attacker to influence or control the
results of DNS queries being returned to users from target systems.

# Workaround:

Limiting the group of machines that can do recursive queries on the DNS
server will make it more difficult, but not impossible, for this
vulnerability to be exploited.

To limit the machines able to perform recursive queries, add an ACL in
named.conf and limit recursion like the following:

    acl example-acl {

       192.0.2.0/24;

    };

    options {

       recursion yes;

       allow-recursion { example-acl; };

    };


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.3
    - **Fixed:** 6.3_3
    - **Introduced:** 7.0
    - **Fixed:** 7.0_3

## Details
 - **published**: 2008-07-13T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2008-07-08T00:00:00Z
 - **vid**: [655ee1ec-511b-11dd-80ba-000bcdf0a03b](https://vuxml.freebsd.org/freebsd/655ee1ec-511b-11dd-80ba-000bcdf0a03b.html)

## References
 - ADVISORY: [https://www.kb.cert.org/vuls/id/800113](https://www.kb.cert.org/vuls/id/800113)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2008-1447](https://cveawg.mitre.org/api/cve/CVE-2008-1447)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-08:06.bind.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-08:06.bind.asc)
