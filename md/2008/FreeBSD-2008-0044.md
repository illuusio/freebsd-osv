# postgresql -- multiple vulnerabilities
The PostgreSQL developers report:

> PostgreSQL allows users to create indexes on the results of
> user-defined functions, known as \"expression indexes\". This provided
> two vulnerabilities to privilege escalation: (1) index functions were
> executed as the superuser and not the table owner during VACUUM and
> ANALYZE, and (2) that SET ROLE and SET SESSION AUTHORIZATION were
> permitted within index functions. Both of these holes have now been
> closed.

> PostgreSQL allowed malicious users to initiate a denial-of-service by
> passing certain regular expressions in SQL queries. First, users could
> create infinite loops using some specific regular expressions. Second,
> certain complex regular expressions could consume excessive amounts of
> memory. Third, out-of-range backref numbers could be used to crash the
> backend.

> DBLink functions combined with local trust or ident authentication
> could be used by a malicious user to gain superuser privileges. This
> issue has been fixed, and does not affect users who have not installed
> DBLink (an optional module), or who are using password authentication
> for local access. This same problem was addressed in the previous
> release cycle, but that patch failed to close all forms of the
> loophole.


## Affected packages
 - **postgresql**
    - **Introduced:** 7.3
    - **Fixed:** 7.3.21
    - **Introduced:** 7.4
    - **Fixed:** 7.4.19
    - **Introduced:** 8.0
    - **Fixed:** 8.0.15
    - **Introduced:** 8.1
    - **Fixed:** 8.1.11
    - **Introduced:** 8.2
    - **Fixed:** 8.2.6
 - **postgresql-server**
    - **Introduced:** 7.3
    - **Fixed:** 7.3.21
    - **Introduced:** 7.4
    - **Fixed:** 7.4.19
    - **Introduced:** 8.0
    - **Fixed:** 8.0.15
    - **Introduced:** 8.1
    - **Fixed:** 8.1.11
    - **Introduced:** 8.2
    - **Fixed:** 8.2.6

## Details
 - **published**: 2008-04-24T00:00:00Z
 - **modified**: 2008-04-24T00:00:00Z
 - **discovery**: 2008-01-06T00:00:00Z
 - **vid**: [51436b4c-1250-11dd-bab7-0016179b2dd5](https://vuxml.freebsd.org/freebsd/51436b4c-1250-11dd-bab7-0016179b2dd5.html)

## References
 - REPORT: [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6600](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6600)
 - REPORT: [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4772](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4772)
 - REPORT: [http://cve.mitre.org/cgi-bin/cvename.cgi?name=](http://cve.mitre.org/cgi-bin/cvename.cgi?name=)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2007-6600](https://cveawg.mitre.org/api/cve/CVE-2007-6600)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2007-4772](https://cveawg.mitre.org/api/cve/CVE-2007-4772)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2007-6067](https://cveawg.mitre.org/api/cve/CVE-2007-6067)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2007-4769](https://cveawg.mitre.org/api/cve/CVE-2007-4769)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2007-6601](https://cveawg.mitre.org/api/cve/CVE-2007-6601)
 - ADVISORY: [https://www.securityfocus.com/bid/27163/info](https://www.securityfocus.com/bid/27163/info)
 - WEB: [http://www.postgresql.org/about/news.905](http://www.postgresql.org/about/news.905)
