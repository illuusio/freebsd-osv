# FreeBSD -- nmount(2) local arbitrary code execution
# Problem Description:

Various user defined input such as mount points, devices, and mount
options are prepared and passed as arguments to nmount(2) into the
kernel. Under certain error conditions, user defined data will be copied
into a stack allocated buffer stored in the kernel without sufficient
bounds checking.

# Impact:

If the system is configured to allow unprivileged users to mount file
systems, it is possible for a local adversary to exploit this
vulnerability and execute code in the context of the kernel.

# Workaround:

It is possible to work around this issue by allowing only privileged
users to mount file systems by running the following sysctl(8) command:

    # sysctl vfs.usermount=0


## Affected packages
 - **FreeBSD**
    - **Introduced:** 6.3
    - **Fixed:** 6.3_4
    - **Introduced:** 7.0
    - **Fixed:** 7.0_4

## Details
 - **published**: 2008-09-05T00:00:00Z
 - **modified**: 2016-08-09T00:00:00Z
 - **discovery**: 2008-09-03T00:00:00Z
 - **vid**: [7dbb7197-7b68-11dd-80ba-000bcdf0a03b](https://vuxml.freebsd.org/freebsd/7dbb7197-7b68-11dd-80ba-000bcdf0a03b.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2008-3531](https://cveawg.mitre.org/api/cve/CVE-2008-3531)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-08:08.nmount.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-08:08.nmount.asc)
