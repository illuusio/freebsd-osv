# clamav -- ClamAV libclamav PE File Integer Overflow Vulnerability
iDefense Security Advisory 02.12.08:

> Remote exploitation of an integer overflow vulnerability in Clam
> AntiVirus\' ClamAV, as included in various vendors\' operating system
> distributions, allows attackers to execute arbitrary code with the
> privileges of the affected process.
>
> The vulnerability exists within the code responsible for parsing and
> scanning PE files. While iterating through all sections contained in
> the PE file, several attacker controlled values are extracted from the
> file. On each iteration, arithmetic operations are performed without
> taking into consideration 32-bit integer wrap.
>
> Since insufficient integer overflow checks are present, an attacker
> can cause a heap overflow by causing a specially crafted Petite packed
> PE binary to be scanned. This results in an exploitable memory
> corruption condition.
>
> Exploitation of this vulnerability results in the execution of
> arbitrary code with the privileges of the process using libclamav. In
> the case of the clamd program, this will result in code execution with
> the privileges of the clamav user. Unsuccessful exploitation results
> in the clamd process crashing.

# Workaround

Disabling the scanning of PE files will prevent exploitation.

If using clamscan, this can be done by running clamscan with the
\'\--no-pe\' option.

If using clamdscan, set the \'ScanPE\' option in the clamd.conf file to
\'no\'.


## Affected packages
 - **clamav**
    - **Introduced:** 0.92
    - **Fixed:** 0.92.1

## Details
 - **published**: 2008-02-15T00:00:00Z
 - **modified**: 2008-02-15T00:00:00Z
 - **discovery**: 2008-01-07T00:00:00Z
 - **vid**: [be4b0529-dbaf-11dc-9791-000ea6702141](https://vuxml.freebsd.org/freebsd/be4b0529-dbaf-11dc-9791-000ea6702141.html)

## References
 - REPORT: [http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=658](http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=658)
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2008-0318](https://cveawg.mitre.org/api/cve/CVE-2008-0318)
 - WEB: [http://svn.clamav.net/svn/clamav-devel/trunk/ChangeLog](http://svn.clamav.net/svn/clamav-devel/trunk/ChangeLog)
