# FreeBSD -- kernel memory disclosure from /dev/midistat
# Problem Description:

The kernel driver for /dev/midistat implements a handler for read(2).
This handler is not thread-safe, and a multi-threaded program can
exploit races in the handler to cause it to copy out kernel memory
outside the boundaries of midistat\'s data buffer.

# Impact:

The races allow a program to read kernel memory within a 4GB window
centered at midistat\'s data buffer. The buffer is allocated each time
the device is opened, so an attacker is not limited to a static 4GB
region of memory.

On 32-bit platforms, an attempt to trigger the race may cause a page
fault in kernel mode, leading to a panic.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.0
    - **Fixed:** 12.0_10
    - **Introduced:** 11.3
    - **Fixed:** 11.3_3
    - **Introduced:** 11.2
    - **Fixed:** 11.2_14

## Details
 - **published**: 2019-10-24T00:00:00Z
 - **modified**: 2019-10-24T00:00:00Z
 - **discovery**: 2019-08-20T00:00:00Z
 - **vid**: [5027b62e-f680-11e9-a87f-a4badb2f4699](https://vuxml.freebsd.org/freebsd/5027b62e-f680-11e9-a87f-a4badb2f4699.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2019-5612](https://cveawg.mitre.org/api/cve/CVE-2019-5612)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-19:23.midi.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-19:23.midi.asc)
