# curl -- multiple vulnerabilities
curl security problems:

> CVE-2018-16890: NTLM type-2 out-of-bounds buffer read
>
> libcurl contains a heap buffer out-of-bounds read flaw.
>
> The function handling incoming NTLM type-2 messages
> (lib/vauth/ntlm.c:ntlm_decode_type2_target) does not validate incoming
> data correctly and is subject to an integer overflow vulnerability.
>
> Using that overflow, a malicious or broken NTLM server could trick
> libcurl to accept a bad length + offset combination that would lead to
> a buffer read out-of-bounds.
>
> CVE-2019-3822: NTLMv2 type-3 header stack buffer overflow
>
> libcurl contains a stack based buffer overflow vulnerability.
>
> The function creating an outgoing NTLM type-3 header
> (lib/vauth/ntlm.c:Curl_auth_create_ntlm_type3_message()), generates
> the request HTTP header contents based on previously received data.
> The check that exists to prevent the local buffer from getting
> overflowed is implemented wrongly (using unsigned math) and as such it
> does not prevent the overflow from happening.
>
> This output data can grow larger than the local buffer if very large
> \"nt response\" data is extracted from a previous NTLMv2 header
> provided by the malicious or broken HTTP server.
>
> Such a \"large value\" needs to be around 1000 bytes or more. The
> actual payload data copied to the target buffer comes from the NTLMv2
> type-2 response header.
>
> CVE-2019-3823: SMTP end-of-response out-of-bounds read
>
> libcurl contains a heap out-of-bounds read in the code handling the
> end-of-response for SMTP.
>
> If the buffer passed to smtp_endofresp() isn\'t NUL terminated and
> contains no character ending the parsed number, and len is set to 5,
> then the strtol() call reads beyond the allocated buffer. The read
> contents will not be returned to the caller.


## Affected packages
 - **curl**
    - **Fixed:** 7.64.0

## Details
 - **published**: 2019-02-07T00:00:00Z
 - **modified**: 2019-02-07T00:00:00Z
 - **discovery**: 2019-02-07T00:00:00Z
 - **vid**: [714b033a-2b09-11e9-8bc3-610fd6e6cd05](https://vuxml.freebsd.org/freebsd/714b033a-2b09-11e9-8bc3-610fd6e6cd05.html)

## References
 - REPORT: [https://curl.haxx.se/docs/security.html](https://curl.haxx.se/docs/security.html)
 - WEB: [https://curl.haxx.se/docs/CVE-2018-16890.html](https://curl.haxx.se/docs/CVE-2018-16890.html)
 - WEB: [https://curl.haxx.se/docs/CVE-2019-3822.html](https://curl.haxx.se/docs/CVE-2019-3822.html)
 - WEB: [https://curl.haxx.se/docs/CVE-2019-3823.html](https://curl.haxx.se/docs/CVE-2019-3823.html)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2018-16890](https://api.osv.dev/v1/vulns/CVE-2018-16890)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2019-3822](https://api.osv.dev/v1/vulns/CVE-2019-3822)
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2019-3823](https://api.osv.dev/v1/vulns/CVE-2019-3823)
