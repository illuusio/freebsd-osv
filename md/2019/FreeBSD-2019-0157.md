# FreeBSD -- IPv6 fragment reassembly panic in pf(4)
# Problem Description:

A bug in the pf(4) IPv6 fragment reassembly logic incorrectly uses the
last extension header offset from the last received packet instead of
from the first packet.

# Impact:

Malicious IPv6 packets with different IPv6 extensions could cause a
kernel panic or potentially a filtering rule bypass.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.0
    - **Fixed:** 12.0_4
    - **Introduced:** 11.2
    - **Fixed:** 11.2_10

## Details
 - **published**: 2019-07-30T00:00:00Z
 - **modified**: 2019-07-30T00:00:00Z
 - **discovery**: 2019-05-14T00:00:00Z
 - **vid**: [3d02520d-b309-11e9-a87f-a4badb2f4699](https://vuxml.freebsd.org/freebsd/3d02520d-b309-11e9-a87f-a4badb2f4699.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2019-5597](https://api.osv.dev/v1/vulns/CVE-2019-5597)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-19:05.pf.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-19:05.pf.asc)
