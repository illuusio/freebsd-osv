# FreeBSD -- Reference count overflow in mqueue filesystem
# Problem Description:

System calls operating on file descriptors obtain a reference to
relevant struct file which due to a programming error was not always put
back, which in turn could be used to overflow the counter of affected
struct file.

# Impact:

A local user can use this flaw to obtain access to files, directories,
sockets etc. opened by processes owned by other users. If obtained
struct file represents a directory from outside of user\'s jail, it can
be used to access files outside of the jail. If the user in question is
a jailed root they can obtain root privileges on the host system.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.0
    - **Fixed:** 12.0_8
    - **Introduced:** 11.2
    - **Fixed:** 11.2_12
    - **Introduced:** 11.3
    - **Fixed:** 11.3_1

## Details
 - **published**: 2019-07-30T00:00:00Z
 - **modified**: 2019-07-30T00:00:00Z
 - **discovery**: 2019-07-24T00:00:00Z
 - **vid**: [deb6e164-b30b-11e9-a87f-a4badb2f4699](https://vuxml.freebsd.org/freebsd/deb6e164-b30b-11e9-a87f-a4badb2f4699.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2019-5603](https://api.osv.dev/v1/vulns/CVE-2019-5603)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-19:15.mqueuefs.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-19:15.mqueuefs.asc)
