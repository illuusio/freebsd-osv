# FreeBSD -- SAE confirm missing state validation
# Problem Description:

When hostapd is used to operate an access point with SAE (Simultaneous
Authentication of Equals; also known as WPA3-Personal), an invalid
authentication sequence could result in the hostapd process terminating
due to a NULL pointer dereference when processing SAE confirm message.
This was caused by missing state validation steps when processing the
SAE confirm message in hostapd/AP mode.

See
https://w1.fi/security/2019-3/sae-confirm-missing-state-validation.txt
for a detailed description of the bug.

# Impact:

All hostapd versions with SAE support (CONFIG_SAE=y in the build
configuration and SAE being enabled in the runtime configuration).


## Affected packages
 - **FreeBSD**
    - **Introduced:** 12.0
    - **Fixed:** 12.0_3
    - **Introduced:** 11.2
    - **Fixed:** 11.2_9
 - **wpa_supplicant**
    - **Fixed:** 2.8
 - **hostapd**
    - **Fixed:** 2.8

## Details
 - **published**: 2019-04-23T00:00:00Z
 - **modified**: 2019-04-23T00:00:00Z
 - **discovery**: 2019-04-10T00:00:00Z
 - **vid**: [98b71436-656d-11e9-8e67-206a8a720317](https://vuxml.freebsd.org/freebsd/98b71436-656d-11e9-8e67-206a8a720317.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2019-9496](https://cveawg.mitre.org/api/cve/CVE-2019-9496)
