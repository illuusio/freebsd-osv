# FreeBSD -- pts(4) write-after-free
# Problem Description:

The code which handles a close(2) of a descriptor created by
posix_openpt(2) fails to undo the configuration which causes SIGIO to be
raised. This bug can lead to a write-after-free of kernel memory.

# Impact:

The bug permits malicious code to trigger a write-after-free, which may
be used to gain root privileges or escape a jail.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.0
    - **Fixed:** 12.0_8
    - **Introduced:** 11.2
    - **Fixed:** 11.2_12
    - **Introduced:** 11.3
    - **Fixed:** 11.3_1

## Details
 - **published**: 2019-07-30T00:00:00Z
 - **modified**: 2019-07-30T00:00:00Z
 - **discovery**: 2019-07-24T00:00:00Z
 - **vid**: [5721ae65-b30a-11e9-a87f-a4badb2f4699](https://vuxml.freebsd.org/freebsd/5721ae65-b30a-11e9-a87f-a4badb2f4699.html)

## References
 - ADVISORY: [https://api.osv.dev/v1/vulns/CVE-2019-5606](https://api.osv.dev/v1/vulns/CVE-2019-5606)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-19:13.pts.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-19:13.pts.asc)
