# FreeBSD -- File description reference count leak
# Problem Description:

FreeBSD 12.0 attempts to handle the case where the receiving process
does not provide a sufficiently large buffer for an incoming control
message containing rights. In particular, to avoid leaking the
corresponding descriptors into the receiving process\' descriptor table,
the kernel handles the truncation case by closing descriptors referenced
by the discarded message.

The code which performs this operation failed to release a reference
obtained on the file corresponding to a received right. This bug can be
used to cause the reference counter to wrap around and free the file
structure.

# Impact:

A local user can exploit the bug to gain root privileges or escape from
a jail.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.0
    - **Fixed:** 12.0_3

## Details
 - **published**: 2019-02-11T00:00:00Z
 - **modified**: 2019-02-11T00:00:00Z
 - **discovery**: 2019-02-05T00:00:00Z
 - **vid**: [86c89abf-2d91-11e9-bf3e-a4badb2f4699](https://vuxml.freebsd.org/freebsd/86c89abf-2d91-11e9-bf3e-a4badb2f4699.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2019-5596](https://cveawg.mitre.org/api/cve/CVE-2019-5596)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-19:02.fd.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-19:02.fd.asc)
