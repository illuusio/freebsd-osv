# FreeBSD -- ICMP/ICMP6 packet filter bypass in pf
# Problem Description:

States in pf(4) let ICMP and ICMP6 packets pass if they have a packet in
their payload matching an existing condition. pf(4) does not check if
the outer ICMP or ICMP6 packet has the same destination IP as the source
IP of the inner protocol packet.

# Impact:

A maliciously crafted ICMP/ICMP6 packet could bypass the packet filter
rules and be passed to a host that would otherwise be unavailable.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.0
    - **Fixed:** 12.0_4
    - **Introduced:** 11.2
    - **Fixed:** 11.2_10

## Details
 - **published**: 2019-07-30T00:00:00Z
 - **modified**: 2019-07-30T00:00:00Z
 - **discovery**: 2019-05-14T00:00:00Z
 - **vid**: [59c5f255-b309-11e9-a87f-a4badb2f4699](https://vuxml.freebsd.org/freebsd/59c5f255-b309-11e9-a87f-a4badb2f4699.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2019-5598](https://cveawg.mitre.org/api/cve/CVE-2019-5598)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-19:06.pf.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-19:06.pf.asc)
