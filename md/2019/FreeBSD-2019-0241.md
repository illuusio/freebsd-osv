# FreeBSD -- Insufficient validation of guest-supplied data (e1000 device)
# Problem Description:

The e1000 network adapters permit a variety of modifications to an
Ethernet packet when it is being transmitted. These include the
insertion of IP and TCP checksums, insertion of an Ethernet VLAN header,
and TCP segmentation offload (\"TSO\"). The e1000 device model uses an
on-stack buffer to generate the modified packet header when simulating
these modifications on transmitted packets.

When TCP segmentation offload is requested for a transmitted packet, the
e1000 device model used a guest-provided value to determine the size of
the on-stack buffer without validation. The subsequent header generation
could overflow an incorrectly sized buffer or indirect a pointer
composed of stack garbage.

# Impact:

A misbehaving bhyve guest could overwrite memory in the bhyve process on
the host.


## Affected packages
 - **FreeBSD-kernel**
    - **Introduced:** 12.0
    - **Fixed:** 12.0_9
    - **Introduced:** 11.3
    - **Fixed:** 11.3_2
    - **Introduced:** 11.2
    - **Fixed:** 11.2_13

## Details
 - **published**: 2019-10-24T00:00:00Z
 - **modified**: 2019-10-24T00:00:00Z
 - **discovery**: 2019-08-06T00:00:00Z
 - **vid**: [499b22a3-f680-11e9-a87f-a4badb2f4699](https://vuxml.freebsd.org/freebsd/499b22a3-f680-11e9-a87f-a4badb2f4699.html)

## References
 - ADVISORY: [https://cveawg.mitre.org/api/cve/CVE-2019-5609](https://cveawg.mitre.org/api/cve/CVE-2019-5609)
 - ADVISORY: [https://www.freebsd.org/security/advisories/FreeBSD-SA-19:21.bhyve.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-19:21.bhyve.asc)
